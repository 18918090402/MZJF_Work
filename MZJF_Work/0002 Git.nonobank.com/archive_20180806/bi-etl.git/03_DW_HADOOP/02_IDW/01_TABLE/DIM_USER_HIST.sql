CREATE TABLE `idw.dim_user_hist`(
  `dw_create_by` string COMMENT '系统字段-创建者', 
  `dw_create_time` string COMMENT '系统字段-创建时间', 
  `dw_update_by` string COMMENT '系统字段-修改者', 
  `dw_update_time` string COMMENT '系统字段-修改时间', 
  `user_id` bigint COMMENT '用户ID', 
  `user_name` string COMMENT '用户名', 
  `real_name` string COMMENT '姓名', 
  `gender` int COMMENT '性别1.男2.女', 
  `mobile_num` string COMMENT '手机号', 
  `email` string COMMENT '电子邮箱', 
  `is_email` int COMMENT '邮箱认证：0:否，1:是', 
  `register_time` string COMMENT '注册时间', 
  `is_authentication` int COMMENT '身份认证：0:否，1:是', 
  `is_photo` int COMMENT '0:否，1:是', 
  `is_education_auth` int COMMENT '学历认证：0:否，1:是，2:拒绝', 
  `is_student_auth` int COMMENT '学籍认证：0:否，1:是', 
  `is_special` int COMMENT '是否特殊用户:0:否，1:是', 
  `is_cheat` int COMMENT '是否欺诈: 0:否，1:是', 
  `status` int COMMENT '0:无效用户，1:有效用户，2:锁定用户', 
  `status_desc` string COMMENT '0:无效用户，1:有效用户，2:锁定用户', 
  `pc_id` bigint COMMENT '所属公司（1，4，5，6）', 
  `pc_id_desc` string COMMENT '诺诺，名校贷，财神，麦芽，UNIFI，科来贷，其他', 
  `english_name` string COMMENT '英文名', 
  `birthday` string COMMENT '生日', 
  `age` int COMMENT '年龄', 
  `constellation` string COMMENT '星座', 
  `qq` string COMMENT 'QQ号码', 
  `current_mobile_no` string COMMENT '当前手机号', 
  `hj_province` string COMMENT '户籍省', 
  `hj_city` string COMMENT '户籍市', 
  `hj_address` string COMMENT '户籍地址', 
  `current_province` string COMMENT '当前所在省', 
  `current_city` string COMMENT '当前所在市', 
  `birth_province` string COMMENT '出生省份', 
  `contact_address` string COMMENT '联系地址', 
  `marriage_status` int COMMENT '婚姻状况(0:未知，1已婚，2未婚，3,已婚已育，4已婚未育，5未婚已育，6丧偶，7离婚)', 
  `marriage_status_desc` string COMMENT '婚姻状态描述', 
  `is_have_passport` int COMMENT '是否持有护照（0：未知，1：有，2无）', 
  `is_social_security` int COMMENT '是否有社保（0：未知，1：有，2无）', 
  `is_driving_license` int COMMENT '是否有驾照（0：未知，1：有，2无）', 
  `house_status` int COMMENT '现居住地状况(0：未知，1：自购房(无房贷)，2：自购房(有按揭)，3：自建房，4：亲属房产，5：租房，6：其他)', 
  `education` string COMMENT '学历', 
  `channel_id` bigint COMMENT '用户渠道来源ID', 
  `channel_name` string COMMENT '用户渠道来源名称', 
  `last_login_time` string COMMENT '最近登录时间', 
  `register_terminal` string COMMENT '注册使用的终端', 
  `user_rank` string COMMENT '会员等级 0:普通会员 1:VIP1 2:VIP2 3:VIP3', 
  `user_rank_desc` string COMMENT '会员等级 0:普通会员 1:VIP1 2:VIP2 3:VIP3', 
  `authentication_time` string COMMENT '认证时间', 
  `recommender` string COMMENT '推荐人', 
  `nono_first_recharge_time` string COMMENT '诺诺首次充值时间', 
  `nono_first_recharge_amt` decimal(38,10) COMMENT '诺诺首次充值金额', 
  `nono_first_recharge_bank` string COMMENT '诺诺首次充值银行', 
  `nono_first_recharge_type` string COMMENT '诺诺首次充值类型', 
  `nono_first_recharge_terminal` string COMMENT '诺诺首次充值终端', 
  `nono_last_recharge_time` string COMMENT '诺诺最近充值时间', 
  `nono_last_recharge_amt` decimal(38,10) COMMENT '诺诺最近充值金额', 
  `nono_last_recharge_bank` string COMMENT '诺诺最近充值银行', 
  `nono_last_recharge_type` string COMMENT '诺诺最近充值类型', 
  `nono_last_recharge_terminal` string COMMENT '诺诺最近充值使用的终端', 
  `first_bind_card_time` string COMMENT '首次绑卡时间', 
  `first_bind_card_account` string COMMENT '首次绑卡账户', 
  `first_bind_card_bank` string COMMENT '首次绑卡银行', 
  `bindcard_cnt` string COMMENT '绑卡次数', 
  `last_bind_card_time` string COMMENT '最近绑卡时间', 
  `last_bind_card_account` string COMMENT '最近绑卡账户', 
  `last_bind_card_bank` string COMMENT '最近绑卡银行', 
  `nono_first_invest_time` string COMMENT '诺诺首次投资时间', 
  `nono_first_invest_amt` decimal(38,10) COMMENT '诺诺首次投资金额', 
  `nono_first_invest_product_scope` string COMMENT '诺诺首次投资产品', 
  `nono_second_invest_time` string COMMENT '诺诺2次投资时间', 
  `nono_second_invest_amt` decimal(38,10) COMMENT '诺诺2次投资金额', 
  `nono_second_invest_product_scope` string COMMENT '诺诺2次投资产品', 
  `nono_third_invest_time` string COMMENT '诺诺3次投资时间', 
  `nono_third_invest_amt` decimal(38,10) COMMENT '诺诺3次投资金额', 
  `nono_third_invest_product_scope` string COMMENT '诺诺3次投资产品', 
  `nono_last_invest_time` string COMMENT '诺诺最近投资时间', 
  `nono_last_invest_amt` decimal(38,10) COMMENT '诺诺最近投资金额', 
  `nono_last_invest_product_scope` string COMMENT '诺诺最近投资产品', 
  `nono_last_cash_time` string COMMENT '诺诺最近兑付时间', 
  `nono_last_cash_amt` decimal(38,10) COMMENT '诺诺最近兑付金额', 
  `nono_last_cash_product_scope` string COMMENT '诺诺最近兑付产品', 
  `nono_aum` decimal(38,10) COMMENT '诺诺当前AUM', 
  `nono_max_aum` decimal(38,10) COMMENT '诺诺历史最大AUM', 
  `nono_max_aum_date` string COMMENT '诺诺历史最大AUM日期', 
  `nono_balance_amt` decimal(38,10) COMMENT '诺诺账户余额', 
  `user_type` int COMMENT '用户类型:0未知，1理财，2贷款，3白领，4微企业主，5学生，6企业主，7vip企业主 8 企业', 
  `hj_province_name` string COMMENT '户籍省名称', 
  `hj_city_name` string COMMENT '户籍市名称', 
  `current_province_name` string COMMENT '当前所在省名称', 
  `current_city_name` string COMMENT '当前所在市名称', 
  `birth_province_name` string COMMENT '出生省份名称', 
  `csyy_first_invest_time` string COMMENT '财神爷爷首次投资时间', 
  `csyy_first_invest_amt` decimal(38,10) COMMENT '财神爷爷首次投资金额', 
  `csyy_first_invest_product_code` string COMMENT '财神爷爷首次投资产品', 
  `csyy_second_invest_time` string COMMENT '财神爷爷2次投资时间', 
  `csyy_second_invest_amt` decimal(38,10) COMMENT '财神爷爷2次投资金额', 
  `csyy_second_invest_product_code` string COMMENT '财神爷爷2次投资产品', 
  `csyy_third_invest_time` string COMMENT '财神爷爷3次投资时间', 
  `csyy_third_invest_amt` decimal(38,10) COMMENT '财神爷爷3次投资金额', 
  `csyy_third_invest_product_code` string COMMENT '财神爷爷3次投资产品', 
  `csyy_last_invest_time` string COMMENT '财神爷爷最近投资时间', 
  `csyy_last_invest_amt` decimal(38,10) COMMENT '财神爷爷最近投资金额', 
  `csyy_last_invest_product_code` string COMMENT '财神爷爷最近投资产品', 
  `csyy_last_30_days_invest_cnt` int COMMENT '财神爷爷过去30天投资次数', 
  `csyy_invest_cnt` int COMMENT '财神爷爷投资次数', 
  `csyy_last_cash_time` string COMMENT '财神爷爷最近兑付时间', 
  `csyy_last_cash_amt` decimal(38,10) COMMENT '财神爷爷最近兑付金额', 
  `csyy_last_cash_product_code` string COMMENT '财神爷爷最近兑付产品', 
  `csyy_aum` decimal(38,10) COMMENT '财神爷爷当前AUM', 
  `csyy_max_aum` decimal(38,10) COMMENT '财神爷爷历史最大AUM', 
  `csyy_max_aum_date` string COMMENT '财神爷爷历史最大AUM日期', 
  `csyy_balance_amt` decimal(38,10) COMMENT '财神爷爷账户余额', 
  `csyy_last_cash_principal_amt` decimal(38,10) COMMENT '财神爷爷最近兑付本金', 
  `nono_last_cash_principal_amt` decimal(38,10) COMMENT '诺诺最近兑付本金', 
  `csyy_first_recharge_time` string COMMENT '财神爷爷首次充值时间', 
  `csyy_first_recharge_amt` decimal(38,10) COMMENT '财神爷爷首次充值金额', 
  `csyy_first_recharge_bank` string COMMENT '财神爷爷首次充值银行', 
  `csyy_first_recharge_type` string COMMENT '财神爷爷首次充值类型', 
  `csyy_last_recharge_time` string COMMENT '财神爷爷最近充值时间', 
  `csyy_last_recharge_amt` decimal(38,10) COMMENT '财神爷爷最近充值金额', 
  `csyy_last_recharge_bank` string COMMENT '财神爷爷最近充值银行', 
  `csyy_last_recharge_type` string COMMENT '财神爷爷最近充值类型', 
  `nono_is_loss_before_2017` int COMMENT '是否诺诺2017年之前流失用户', 
  `csyy_invite_user_id` bigint COMMENT '财神爷爷邀请用户ID', 
  `id_num` string COMMENT '身份证号', 
  `nono_last_30_days_invest_cnt` int COMMENT '诺诺过去30天投资次数', 
  `nono_invest_cnt` int COMMENT '诺诺投资次数', 
  `nono_prolocutor_invite_register_cnt` int COMMENT '镑客大使邀请注册成功次数', 
  `nono_last_30_days_login_cnt` int COMMENT '诺诺过去30天登录次数', 
  `nono_last_60_days_login_cnt` int COMMENT '诺诺过去60天登录次数', 
  `nono_last_30_days_view_column_cnt` int COMMENT '诺诺过去30天浏览栏目数', 
  `nono_last_30_days_view_product_cnt` int COMMENT '诺诺过去30天浏览产品数', 
  `nono_last_30_days_click_third_icon_cnt` int COMMENT '诺诺过去30天点击app第三个图标次数ge', 
  `busi_line` string COMMENT '所属业务线', 
  `edu_start_date` string COMMENT '入学时间', 
  `edu_graduate_date` string COMMENT '毕业时间', 
  `stu_auth_time` string COMMENT '学籍认证时间', 
  `edu_auth_time` string COMMENT '学历认证时间', 
  `bl_edu_auth_time` string COMMENT '白领学历认证时间', 
  `bl_card_auth_time` string COMMENT '白领身份认证时间', 
  `first_bo_success_time` string COMMENT '首借成功时间', 
  `max_overdue_days` int COMMENT '最长逾期天数', 
  `sesame_number` int COMMENT '芝麻信用分数', 
  `phone_online_time` string COMMENT '手机入网时间', 
  `is_gjj_submit` int COMMENT '是否完善公积金', 
  `gjj_submit_time` string COMMENT '完善公积金时间', 
  `is_sb_submit` int COMMENT '是否完成社保', 
  `sb_submit_time` string COMMENT '完善社保时间', 
  `tongdun_score` int COMMENT '同盾分', 
  `user_credit_rank` string COMMENT '评级', 
  `instructor_name` string COMMENT '辅导员姓名', 
  `instructor_mobile` string COMMENT '辅导员手机', 
  `instructor_mobile_state` string COMMENT '辅导员手机状态', 
  `instructor_mobile_address` string COMMENT '辅导员手机归属地', 
  `parent_name` string COMMENT '父母姓名', 
  `parent_mobile` string COMMENT '父母手机', 
  `parent_mobile_state` string COMMENT '父母手机状态', 
  `parent_mobile_address` string COMMENT '父母手机归属地', 
  `friend1_name` string COMMENT '好友1姓名', 
  `friend1_mobile` string COMMENT '好友1手机', 
  `friend1_mobile_state` string COMMENT '好友1手机状态', 
  `friend1_mobile_address` string COMMENT '好友1手机归属地', 
  `friend2_name` string COMMENT '好友2姓名', 
  `friend2_mobile` string COMMENT '好友2手机', 
  `friend2_mobile_state` string COMMENT '好友2手机状态', 
  `friend2_mobile_address` string COMMENT '好友2手机归属地', 
  `friend3_name` string COMMENT '好友3姓名', 
  `friend3_mobile` string COMMENT '好友3手机', 
  `friend3_mobile_state` string COMMENT '好友3手机状态', 
  `friend3_mobile_address` string COMMENT '好友3手机归属地', 
  `cou_address` string COMMENT '身份证归属地')
COMMENT '用户历史表'
PARTITIONED BY ( 
  `stat_date` string COMMENT '统计日期 年-月-日')
ROW FORMAT DELIMITED
  NULL DEFINED AS ''
STORED AS PARQUET 
TBLPROPERTIES ("parquet.compression"="SNAPPY");