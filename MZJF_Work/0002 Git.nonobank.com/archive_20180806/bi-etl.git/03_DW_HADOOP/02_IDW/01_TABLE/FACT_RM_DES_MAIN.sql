drop table if exists idw.FACT_RM_DES_MAIN;
create table if not exists idw.FACT_RM_DES_MAIN
(
   DW_CREATE_BY         string comment '系统字段-创建者',
   DW_CREATE_TIME       string comment '系统字段-创建时间',
   DW_UPDATE_BY         string comment '系统字段-修改者',
   DW_UPDATE_TIME       string comment '系统字段-修改时间',
   BP_ID                bigint comment '预发标ID',
   P_ID                 bigint comment '产品ID',
   CATEGORY_NAME_01     string comment '产品分类01',
   BIZ_CODE_01          string comment '业务线编码01',
   BIZ_NAME_01          string comment '业务线名称01',
   USER_ID              bigint comment '用户ID',
   USER_NAME            string comment '用户名',
   REAL_NAME            string comment '真实姓名',
   QUERY_NAME           string comment '查询的姓名',
   USER_AGE             int comment '用户年龄',
   USER_CENSUS_ADDRESS  string comment '户籍地址',
   CURRENT_ADDRESS      string comment '当前住址',
   HOME_ADDRESS         string comment '家庭住址',
   PROVINCE_CODE        int comment '省份代码',
   PROVINCE_NAME        string comment '省份名称',
   EMAIL                string comment '邮件',
   USER_GENDER          int comment '用户性别',
   USER_ID_NUMBER       string comment '用户身份证号',
   USER_MOBILE          string comment '用户手机号',
   USER_KIN_MOBILE      string comment '直接亲属手机号',
   SCHOOL_ACADEMY       string comment '学校',
   SCHOOL_COMPANY_ADDRESS string comment '单位地址',
   SCHOOL_COMPANY_NAME  string comment '单位名称',
   SCHOOL_COMPANY_PHONE string comment '单位电话',
   STUDENT_EDUCATION    string comment '学历',
   STUDENT_EDU_START_DATE int comment '入学时间',
   STUDENT_GRADE        int comment '用户年级',
   STUDENT_SCHOOL_TYPE  int comment '学校类别',
   STUDENT_TERM_PROCESS string comment '学期进度',
   USER_SCHOOL_PROVINCE string comment '学校省份',
   VOCATIONAL_SCHOOL_THREE int comment '专三',
   FRIEND_MOBILE        string comment '朋友手机号',
   FRIEND2_MOBILE       string comment '好友2手机号',
   FRIEND3_MOBILE       string comment '好友3手机号',
   FRIEND_PHONE_CALL_RESULT_STATUS string comment '朋友手机号拨打结果回调原始值',
   FRIEND_PHONE_CALL_RESULT_STATUS_DES string comment '朋友手机号拨打结果回调',
   PARENT_MOBILE        string comment '用户父母手机号',
   PARENT_MOBILE_IN_THE_CONTACT string comment '在联系人表的父母手机号',
   PARENT_NAME          string comment '父母姓名',
   PARENT_PHONE_CALL_RESULT_STATUS string comment '父母手机号拨打结果回调原始值',
   PARENT_PHONE_CALL_RESULT_STATUS_DES string comment '父母手机号拨打结果回调',
   TECH_MOBILE          string comment '辅导员手机号',
   TECH_PHONE_CALL_RESULT_STATUS string comment '辅导员手机号拨打结果回调原始值',
   TECH_PHONE_CALL_RESULT_STATUS_DES string comment '辅导员手机号拨打结果回调',
   LAST_LOAN_AMT        decimal(38,10) comment '上次贷款金额',
   LAST_LOAN_TIME       string comment '上次贷款时间',
   LAST_MOBILE          string comment '上次贷款手机号',
   LATEST_RTN_LOAN_DATE string comment '最近一次实际还款日期',
   LOAN_STATUS_NORMAL   int comment '贷款是否正常',
   LOAN_STATUS_OVERDUE  int comment '贷款是否逾期',
   MAX_OVERDUE_DAYS     int comment '最大逾期天数',
   OVERDUE_TERM         int comment '逾期期数',
   OVERDUE_7DAYS_4TIMES int comment '逾期天数>7天的次数大于4',
   OVERDUE_30DAYS_1TIMES int comment '逾期天数>30天的次数大于1',
   PREVIOUS_IS_REPAYED  int comment '是否存量已结清',
   REJECT_IN_30DAYS     int comment '近30天内被拒绝',
   RTN_TERM             int comment '已还期数',
   BO_ID                bigint comment '借款ID',
   AUDIT_AMT            decimal(38,10) comment '审批额度',
   TYPE                 string comment '借款类型 RLC:大额借 RSD:闪电借',
   TERM                 int comment '贷款期限',
   PRODUCT_ID           bigint comment '产品编号',
   LOAN_AMT             decimal(38,10) comment '贷款金额',
   LOAN_APPLY_DATE      string comment '贷款申请日期',
   CHANNEL_CODE         int comment '来源渠道:0:PC及其他 1:新版APP 2:马甲APP 3:微信',
   IS_JXHJ              int comment '是否一键再借',
   IS_STOCK_CAMPAIGN    int comment '是否存量战役一键再借',
   IS_NEW_USER          int comment '新增用户标志',
   IS_RETAINED_USER     int comment '是否存量用户',
   LBS_CITY             string comment 'LBS地址',
   LBS_CODE_NOT_PEER_NUM_TOP_THREE_3M int comment '主贷人提交视屏时的LBS地址所在城市未命中联系人Top3(近3个月通话次数降序)归属地中的任一城市',
   LBS_CODE_NOT_PEER_NUM_TOP_THREE_6M int comment '主贷人提交视屏时的LBS地址所在城市未命中联系人Top3(近6个月通话次数降序)归属地中的任一城市',
   ZHIMA_UUID           string comment '芝麻采集UUID',
   ZHIMA_SCORE          int comment '芝麻分',
   TONGDUN_UUID         string comment '同盾采集UUID',
   HIT_TONGDUN_REPEATE_LOAN_ONE_WEEKEND int comment '7天内申请人在多个平台申请借款',
   HIT_TONGDUN_REPEATE_LOAN_ONE_MONTH int comment '1个月内申请人在多个平台申请借款',
   HIT_TONGDUN_REPEATE_LOAN_THREE_MONTH int comment '3个月内申请人在多个平台申请借款',
   HIT_TONGDUN_REPEATE_LOAN_SIX_MONTH int comment '6个月内申请人在多个平台申请借款',
   TONGDUN_REPEATE_LOAN_ONE_WEEKEND_DIV_ONE_MONTH decimal(38,10) comment '同盾7天内多头/1个月内多头占比',
   ID_HIT_TONGDUN_COURT_BLACK_LIST int comment '身份证命中法院失信名单',
   ID_HIT_TONGDUN_COURT_EXECUTE_LIST int comment '身份证命中法院执行名单',
   ID_HIT_TONGDUN_CRIME_BLACK_LIST int comment '身份证命中犯罪通缉名单',
   ID_HIT_TONGDUN_LEGAL_PERSON_BLACK_LIST int comment '身份证命中公司法人失信名单',
   ID_HIT_TONGDUN_LOAN_BLACK_LIST int comment '身份证命中网贷黑名单',
   ID_HIT_TONGDUN_LOST_CONTACT_LIST int comment '身份证命中失联名单',
   ID_NAME_HIT_TONGDUN_FUZZY_COURT_BLACK_LIST int comment '身份证_姓名命中法院失信模糊名单',
   ID_NAME_HIT_TONGDUN_FUZZY_COURT_EXECUTE_LIST int comment '身份证_姓名命中法院执行模糊名单',
   ID_NAME_HIT_TONGDUN_FUZZY_LOAN_BLACK_LIST int comment '身份证_姓名命中网贷模糊黑名单',
   MOBILE_HIT_TONGDUN_LEGAL_PERSON_BLACK_LIST int comment '手机号命中公司法人失信名单',
   MOBILE_HIT_TONGDUN_LOAN_BLACK_INTERMEDIARY int comment '申请人手机号命中贷款黑中介',
   MOBILE_HIT_TONGDUN_LOAN_BLACK_LIST int comment '手机号命中网贷黑名单',
   MOBILE_HIT_TONGDUN_LOST_CONTACT_LIST int comment '手机号命中失联名单',
   CONTACT_MOBILE_HIT_TONGDUN_LOAN_BLACK_INTERMEDIARY int comment '手机号命中贷款黑中介',
   BORROW_TIME_SHORT_IN_DEVICE int comment '设备或账户两次借款时间间隔极短',
   MOVE_DISTANCE_EXCEPTION_IN_DEVICE int comment '设备或账户在短时间内移动距离异常拒绝',
   ONE_HOUR_MANY_ACCOUNT_IN_DEVICE int comment '1小时内设备使用过多账户进行借款',
   ONE_HOUR_MUCH_ACCOUNT_ALL int comment '1小时内设备上在全局进行借款的账户极多_排除本合作方',
   ONE_HOUR_MUCH_ACCOUNT_IN_DEVICE int comment '1小时内设备上进行借款的账户极多',
   ONE_DAY_MANY_ACCOUNT_IN_DEVICE int comment '1天内设备使用过多账户进行借款',
   ONE_DAY_MUCH_ACCOUNT_ALL int comment '1天内设备上在全局进行借款的账户极多_排除本合作方',
   ONE_DAY_MUCH_ACCOUNT_IN_DEVICE int comment '1天内设备上进行借款的账户极多',
   SEVEN_DAY_MUCH_ACCOUNT_ALL int comment '7天内设备上在全局进行借款的账户极多_排除本合作方',
   SEVEN_DAY_MUCH_ACCOUNT_IN_DEVICE int comment '7天内设备上进行借款的账户极多',
   TONGDUN_FINAL_SCORE  int comment '同盾风险分数',
   CREATE_TIME          string comment '活体识别时间',
   FACE_SIMILAR_PERCENT decimal(38,10) comment '活体识别分数',
   IDCARD_SIMILAR_PERCENT decimal(38,10) comment '身份证识别分数',
   USER_RISK_BILL       int comment '是否风险名单',
   ID_HIT_OUR_BLACK_LIST int comment '申请人的身份证号命中我方黑名单',
   IMMEDIATE_FAMILY_MOBILE_HIT_OUR_BLACK_LIST int comment '直系亲属手机号命中我方黑名单',
   MOBILE_HIT_OUR_BLACK_LIST int comment '申请人的手机号命中我方黑名单',
   SCORE_LEVEL          string comment '评级',
   SCORE_RESULT         int comment '评分',
   IS_NEED_TELEPHONE_AUDIT int comment '免电核最终结果',
   FINAL_DES            int comment '决策最终结果 0:拒绝 6:通过 7:转人工',
   ED_RULE_ID           string comment '拒绝规则码',
   ED_REASON_ID         string comment '拒绝原因码',
   RG_RULE_ID           string comment '转人工规则码',
   RG_REASON_ID         string comment '转人工原因码',
   PASS_RULE_ID         string comment '通过规则码',
   FINAL_DES_TIME       string comment '决策时间',
   FINAL_DES_REMARK     string comment '决策结果描述')
COMMENT '水滴系统运行事实表'
ROW FORMAT DELIMITED
  NULL DEFINED AS ''
STORED AS PARQUET 
TBLPROPERTIES ("parquet.compression"="SNAPPY");
