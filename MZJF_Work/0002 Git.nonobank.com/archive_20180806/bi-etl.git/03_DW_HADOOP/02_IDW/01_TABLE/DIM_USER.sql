
USE IDW;
DROP TABLE IF EXISTS IDW.DIM_USER;
-- 字段名和数据类型字段描述请参照维表
CREATE TABLE IF NOT EXISTS IDW.DIM_USER
(  
    DW_CREATE_BY         STRING COMMENT '系统字段-创建者',
    DW_CREATE_TIME       STRING COMMENT '系统字段-创建时间',
    DW_UPDATE_BY         STRING COMMENT '系统字段-修改者',
    DW_UPDATE_TIME       STRING COMMENT '系统字段-修改时间',
USER_ID    BIGINT    COMMENT  '用户ID'    ,
USER_NAME    STRING    COMMENT  '用户名'    ,
REAL_NAME    STRING    COMMENT  '姓名'    ,
GENDER    INT    COMMENT  '性别1.男2.女'    ,
MOBILE_NUM    STRING    COMMENT  '手机号'    ,
EMAIL    STRING    COMMENT  '电子邮箱'    ,
IS_EMAIL    INT    COMMENT  '邮箱认证：0:否，1:是'    ,
REGISTER_TIME    STRING    COMMENT  '注册时间'    ,
IS_AUTHENTICATION    INT    COMMENT  '身份认证：0:否，1:是'    ,
IS_PHOTO    INT    COMMENT  '0:否，1:是'    ,
IS_EDUCATION_AUTH    INT    COMMENT  '学历认证：0:否，1:是，2:拒绝'    ,
IS_STUDENT_AUTH    INT    COMMENT  '学籍认证：0:否，1:是'    ,
IS_SPECIAL    INT    COMMENT  '是否特殊用户:0:否，1:是'    ,
IS_CHEAT    INT    COMMENT  '是否欺诈: 0:否，1:是'    ,
STATUS    INT    COMMENT  '0:无效用户，1:有效用户，2:锁定用户'    ,
STATUS_DESC    STRING    COMMENT  '0:无效用户，1:有效用户，2:锁定用户'    ,
PC_ID    BIGINT    COMMENT  '所属公司（1，4，5，6）'    ,
PC_ID_DESC    STRING    COMMENT  '诺诺，名校贷，财神，麦芽，UNIFI，科来贷，其他'    ,
ENGLISH_NAME    STRING    COMMENT  '英文名'    ,
BIRTHDAY    STRING    COMMENT  '生日'    ,
AGE    INT    COMMENT  '年龄'    ,
CONSTELLATION    STRING    COMMENT  '星座'    ,
QQ    STRING    COMMENT  'QQ号码'    ,
CURRENT_MOBILE_NO    STRING    COMMENT  '当前手机号'    ,
HJ_PROVINCE    STRING    COMMENT  '户籍省'    ,
HJ_CITY    STRING    COMMENT  '户籍市'    ,
HJ_ADDREss    STRING    COMMENT  '户籍地址'    ,
CURRENT_PROVINCE    STRING    COMMENT  '当前所在省'    ,
CURRENT_CITY    STRING    COMMENT  '当前所在市'    ,
BIRTH_PROVINCE    STRING    COMMENT  '出生省份'    ,
CONTACT_ADDREss    STRING    COMMENT  '联系地址'    ,
MARRIAGE_STATUS    INT    COMMENT  '婚姻状况(0:未知，1已婚，2未婚，3,已婚已育，4已婚未育，5未婚已育，6丧偶，7离婚)'    ,
MARRIAGE_STATUS_DESC    STRING    COMMENT  '婚姻状态描述'    ,
IS_HAVE_PASSPORT    INT    COMMENT  '是否持有护照（0：未知，1：有，2无）'    ,
IS_SOCIAL_SECURITY    INT    COMMENT  '是否有社保（0：未知，1：有，2无）'    ,
IS_DRIVING_LICENSE    INT    COMMENT  '是否有驾照（0：未知，1：有，2无）'    ,
HOUSE_STATUS    INT    COMMENT  '现居住地状况(0：未知，1：自购房(无房贷)，2：自购房(有按揭)，3：自建房，4：亲属房产，5：租房，6：其他)'    ,
EDUCATION    STRING    COMMENT  '学历'    ,
SOURCE    BIGINT    COMMENT  '用户渠道来源'    ,
SOURCE_DESC    STRING    COMMENT  '用户渠道来源描述'    ,
LAST_LOGON_TIME    STRING    COMMENT  '最近登录时间'    ,
REGISTER_SOURCE    STRING    COMMENT  '注册来源终端'    ,
USER_RANK    STRING    COMMENT  '会员等级 0:普通会员 1:VIP1 2:VIP2 3:VIP3'    ,
USER_RANK_DESC    STRING    COMMENT  '会员等级 0:普通会员 1:VIP1 2:VIP2 3:VIP3'    ,
AUTHENTICATION_TIME    STRING    COMMENT  '认证时间'    ,
RECOMMENDER    STRING    COMMENT  '推荐人'    ,
FISRT_RECHARGE_TIME    STRING    COMMENT  '首次充值时间'    ,
FISRT_RECHARGE_AMOUNT    DECIMAL(38,10)    COMMENT  '首次充值金额'    ,
FISRT_RECHARGE_BANKCARD    STRING    COMMENT  '首次充值银行'    ,
FISRT_RECHARGE_TYPE    STRING    COMMENT  '首次充值类型'    ,
FISRT_RECHARGE_SOURCE    STRING    COMMENT  '首次充值渠道'    ,
LAST_RECHARGE_TIME    STRING    COMMENT  '最近充值时间'    ,
LAST_RECHARGE_AMOUNT    DECIMAL(38,10)    COMMENT  '最近充值金额'    ,
LAST_RECHARGE_BANKCARD    STRING    COMMENT  '最近充值银行'    ,
LAST_RECHARGE_TYPE    STRING    COMMENT  '最近充值类型'    ,
LAST_RECHARGE_SOURCE    STRING    COMMENT  '最近充值渠道'    ,
FIRST_BIND_CARD_TIME    STRING    COMMENT  '首次绑卡时间'    ,
FIRST_BIND_CARD_ACCOUNT    STRING    COMMENT  '首次绑卡账户'    ,
FIRST_BIND_CARD_BANK    STRING    COMMENT  '首次绑卡银行'    ,
BINDCARD_COUNT    STRING    COMMENT  '绑卡次数'    ,
LAST_BIND_CARD_TIME    STRING    COMMENT  '最近绑卡时间'    ,
LAST_BIND_CARD_ACCOUNT    STRING    COMMENT  '最近绑卡账户'    ,
LAST_BIND_CARD_BANK    STRING    COMMENT  '最近绑卡银行'    ,
FIRST_INVEST_TIME    STRING    COMMENT  '首次投资时间'    ,
FIRST_INVEST_AMOUNT    DECIMAL(38,10)    COMMENT  '首次投资金额'    ,
FIRST_INVEST_PRODUCT_SCOPE    STRING    COMMENT  '首次投资产品'    ,
SECOND_INVEST_TIME    STRING    COMMENT  '2次投资时间'    ,
SECOND_INVEST_AMOUNT    DECIMAL(38,10)    COMMENT  '2次投资金额'    ,
SECOND_INVEST_PRODUCT_SCOPE    STRING    COMMENT  '2次投资产品'    ,
THIRD_INVEST_TIME    STRING    COMMENT  '3次投资时间'    ,
THIRD_INVEST_AMOUNT    DECIMAL(38,10)    COMMENT  '3次投资金额'    ,
THIRD_INVEST_PRODUCT_SCOPE    STRING    COMMENT  '3次投资产品'    ,
LAST_INVEST_TIME    STRING    COMMENT  '最近投资时间'    ,
LAST_INVEST_AMOUNT    DECIMAL(38,10)    COMMENT  '最近投资金额'    ,
LAST_INVEST_PRODUCT_SCOPE    STRING    COMMENT  '最近投资产品'    ,
LAST_CASH_TIME    STRING    COMMENT  '最近兑付时间'    ,
LAST_CASH_AMOUNT    DECIMAL(38,10)    COMMENT  '最近兑付金额'    ,
LAST_CASH_PRODUCT_SCOPE    STRING    COMMENT  '最近兑付产品'    
) COMMENT '用户维表'
PARTITIONED BY(STAT_DATE STRING)
STORED AS PARQUET TBLPROPERTIES ("parquet.compression"="SNAPPY");
;
ALTER TABLE IDW.DIM_USER  ADD COLUMNS (AUM    DECIMAL(38,10)    COMMENT  'AUM'   );
ALTER TABLE IDW.DIM_USER  ADD COLUMNS (MAX_AUM    DECIMAL(38,10)    COMMENT  '用户最大AUM'    );
ALTER TABLE IDW.DIM_USER  ADD COLUMNS (MAX_AUM_DATE    STRING    COMMENT  '用户最大AUM日期'    );
ALTER TABLE IDW.DIM_USER  ADD COLUMNS (BALANCE_AMT    DECIMAL(38,10)    COMMENT  '用户余额'    );
ALTER TABLE IDW.DIM_USER  ADD COLUMNS (USER_TYPE    INT    COMMENT  '用户类型:0未知，1理财，2贷款，3白领，4微企业主，5学生，6企业主，7vip企业主 8 企业'    );

