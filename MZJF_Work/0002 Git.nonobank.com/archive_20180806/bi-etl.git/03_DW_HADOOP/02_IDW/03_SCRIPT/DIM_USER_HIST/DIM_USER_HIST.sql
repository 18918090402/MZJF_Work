set mapreduce.job.queuename=etl-dw;
set mapreduce.job.name=IDW_DIM_USER_HIST_01;

set hive.exec.parallel=true ;

set hive.exec.dynamic.partition=true;
set hive.exec.dynamic.partition.mode=nonstrict;
set hive.exec.max.dynamic.partitions.pernode=100000000;
set hive.exec.max.dynamic.partitions=100000000;
set hive.exec.max.created.files=100000000;

INSERT OVERWRITE TABLE IDW.DIM_USER_HIST partition
  (stat_date)
  SELECT 'SYS' AS DW_CREATE_BY,
         FROM_UNIXTIME(UNIX_TIMESTAMP(), 'yyyy-MM-dd HH:mm:ss') AS DW_CREATE_TIME,
         'SYS' AS DW_UPDATE_BY,
         FROM_UNIXTIME(UNIX_TIMESTAMP(), 'yyyy-MM-dd HH:mm:ss') AS DW_UPDATE_TIME,
         user_id,
         user_name,
         real_name,
         gender,
         mobile_num,
         email,
         is_email,
         register_time,
         is_authentication,
         is_photo,
         is_education_auth,
         is_student_auth,
         is_special,
         is_cheat,
         status,
         status_desc,
         pc_id,
         pc_id_desc,
         english_name,
         birthday,
         age,
         constellation,
         qq,
         current_mobile_no,
         hj_province,
         hj_city,
         hj_address,
         current_province,
         current_city,
         birth_province,
         contact_address,
         marriage_status,
         marriage_status_desc,
         is_have_passport,
         is_social_security,
         is_driving_license,
         house_status,
         education,
         channel_id,
         channel_name,
         last_login_time,
         register_terminal,
         user_rank,
         user_rank_desc,
         authentication_time,
         recommender,
         nono_first_recharge_time,
         nono_first_recharge_amt,
         nono_first_recharge_bank,
         nono_first_recharge_type,
         nono_first_recharge_terminal,
         nono_last_recharge_time,
         nono_last_recharge_amt,
         nono_last_recharge_bank,
         nono_last_recharge_type,
         nono_last_recharge_terminal,
         first_bind_card_time,
         first_bind_card_account,
         first_bind_card_bank,
         bindcard_cnt,
         last_bind_card_time,
         last_bind_card_account,
         last_bind_card_bank,
         nono_first_invest_time,
         nono_first_invest_amt,
         nono_first_invest_product_scope,
         nono_second_invest_time,
         nono_second_invest_amt,
         nono_second_invest_product_scope,
         nono_third_invest_time,
         nono_third_invest_amt,
         nono_third_invest_product_scope,
         nono_last_invest_time,
         nono_last_invest_amt,
         nono_last_invest_product_scope,
         nono_last_cash_time,
         nono_last_cash_amt,
         nono_last_cash_product_scope,
         nono_aum,
         nono_max_aum,
         nono_max_aum_date,
         nono_balance_amt,
         user_type,
         hj_province_name,
         hj_city_name,
         current_province_name,
         current_city_name,
         birth_province_name,
         csyy_first_invest_time,
         csyy_first_invest_amt,
         csyy_first_invest_product_code,
         csyy_second_invest_time,
         csyy_second_invest_amt,
         csyy_second_invest_product_code,
         csyy_third_invest_time,
         csyy_third_invest_amt,
         csyy_third_invest_product_code,
         csyy_last_invest_time,
         csyy_last_invest_amt,
         csyy_last_invest_product_code,
         csyy_last_30_days_invest_cnt,
         csyy_invest_cnt,
         csyy_last_cash_time,
         csyy_last_cash_amt,
         csyy_last_cash_product_code,
         csyy_aum,
         csyy_max_aum,
         csyy_max_aum_date,
         csyy_balance_amt,
         csyy_last_cash_principal_amt,
         nono_last_cash_principal_amt,
         csyy_first_recharge_time,
         csyy_first_recharge_amt,
         csyy_first_recharge_bank,
         csyy_first_recharge_type,
         csyy_last_recharge_time,
         csyy_last_recharge_amt,
         csyy_last_recharge_bank,
         csyy_last_recharge_type,
         nono_is_loss_before_2017,
         csyy_invite_user_id,
         id_num,
         nono_last_30_days_invest_cnt,
         nono_invest_cnt,
         nono_prolocutor_invite_register_cnt,
         nono_last_30_days_login_cnt,
         nono_last_60_days_login_cnt,
         nono_last_30_days_view_column_cnt,
         nono_last_30_days_view_product_cnt,
         nono_last_30_days_click_third_icon_cnt,
         busi_line,
         edu_start_date,
         edu_graduate_date,
         stu_auth_time,
         edu_auth_time,
         bl_edu_auth_time,
         bl_card_auth_time,
         first_bo_success_time,
         max_overdue_days,
         sesame_number,
         phone_online_time,
         is_gjj_submit,
         gjj_submit_time,
         is_sb_submit,
         sb_submit_time,
         tongdun_score,
         user_credit_rank,
         instructor_name,
         instructor_mobile,
         instructor_mobile_state,
         instructor_mobile_address,
         parent_name,
         parent_mobile,
         parent_mobile_state,
         parent_mobile_address,
         friend1_name,
         friend1_mobile,
         friend1_mobile_state,
         friend1_mobile_address,
         friend2_name,
         friend2_mobile,
         friend2_mobile_state,
         friend2_mobile_address,
         friend3_name,
         friend3_mobile,
         friend3_mobile_state,
         friend3_mobile_address,
         cou_address,
         mxd_education,
         ad_plan,
         ad_unit,
         channel_detail,
         nono_is_black_list,
         csyy_channel_id,
         csyy_channel_name,
         nono_7days_recharge_amt,
         nono_7days_withdraw_amt,
         nono_7days_eta_amt,
         csyy_7days_recharge_amt,
         csyy_7days_withdraw_amt,
         csyy_7days_eta_amt,
         first_bo_apply_time,
         nono_total_invest_amt,
         csyy_total_invest_amt,
         register_biz,
         finance_advisor,
         academy,
         major,
         is_graduate,
         campus_approach,
         campus_approach_desc,
         student_no,
         campus,
         family_income,
         family_income_desc,
         school_type,
         school_type_desc,
         school_province_id,
         school_province_name,
         school_city_id,
         school_city_name,
         job,
         current_job_time,
         total_job_time,
         company_name,
         company_type,
         company_business_type,
         company_tel,
         register_ip,
         is_black_gray,
         maiya_salary,
         maiya_company_name,
         maiya_work_position,
         maiya_work_position_name,
         maiya_family_user,
         maiya_family_user_mobile,
         nono_invest_preferred,
         is_dfd_admin_member,
         nono_last_cash_fp_id,
         address_home,
         nono_total_invest_amt_yearly,
         bl_graduate_time,
         mobile_address,
         mld_credit_apply_cnt,
         mld_bo_success_cnt,
         nono_first_invest_amt_yearly,
         nono_first_invest_expect,
         nono_second_invest_amt_yearly,
         nono_second_invest_expect,
         nono_third_invest_amt_yearly,
         nono_third_invest_expect,
         nono_in_invest_amt,
         nono_max_in_invest_amt,
         nono_max_in_invest_amt_date,
         nono_last_invest_amt_yearly,
         nono_last_invest_expect,
         nono_total_plan_invest_cnt,
         nono_total_plan_invest_amt,
         nono_total_plan_invest_amt_yearly,
         csyy_first_invest_amt_yearly,
         csyy_first_invest_expect,
         csyy_second_invest_amt_yearly,
         csyy_second_invest_expect,
         csyy_third_invest_amt_yearly,
         csyy_third_invest_expect,
         csyy_last_invest_amt_yearly,
         csyy_last_invest_expect,
         csyy_total_invest_amt_yearly,
         nono_last_90_days_withdraw_cnt,
         nono_last_90_days_withdraw_amt,
         nono_last_withdraw_time,
         nono_last_withdraw_amt,
         nono_user_lost_status,
         maiya_user_name,
         maiya_real_name,
         maiya_mobile_num,
         maiya_register_province_code,
         maiya_register_city_code,
         maiya_register_province_name,
         maiya_register_city_name,
         nono_balance_locking_amt,
         nono_balance_total_amt,
         base_amt_110,
         increase_amt_110,
         total_amt_110,
         used_amt_110,
         amt_111,
         know_approach_code,
         know_approach_name,
         unifi_register_country_code,
         unifi_register_country_name,
         hsb_account_no,
         hsb_status,
         hsb_balance,
         hsb_freeze_amount,
         hsb_mobile,
         hsb_bank_card,
         has_not_depository_overdue_debt,
         maiya_id_num,
         maiya_gender,
         maiya_education,
         maiya_email,
         maiya_user_source,
         maiya_work_type,
         maiya_is_qizha,
         maiya_mobile_address,
         mobile_address_province,
         first_ml_time,
         first_actual_bo_time,
         company_business_sort,
         company_address,
         spouse_name,
         spouse_idnum,
         spouse_mobile,
         spouse_company,
         monthly_salary,
         base_amount_type_110,
         stat_date
    from idw.dim_user;