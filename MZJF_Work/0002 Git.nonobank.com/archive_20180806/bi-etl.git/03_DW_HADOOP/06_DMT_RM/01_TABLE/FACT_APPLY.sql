DROP TABLE IF EXISTS DMT_RM.FACT_APPLY;
CREATE TABLE IF NOT EXISTS DMT_RM.FACT_APPLY
(
   APPLY_NO             bigint comment '申请号',
   APPLY_NAME           string comment '申请人姓名',
   IDENTITY_CARD_ID     string comment '身份证号',
   AGE                  int comment '年龄',
   SEX                  string comment '性别',
   HUJI_PROVINCE        string comment '户籍省份',
   HUJI_CITY            string comment '户籍城市',
   CURRENT_PROVINCE     string comment '当前省份',
   CURRENT_CITY         string comment '当前城市',
   SCHOOL_NAME          string comment '就读学校',
   SCHOOL_TYPE          string comment '学校类别',
   SCHOOL_CITY          string comment '学校城市',
   SCHOOL_PROVINCE      string comment '学校省份',
   MAJOR_NAME           int comment '专业',
   GRADE                string comment '年级',
   EDUCATION            string comment '学历',
   ENTER_SCHOOL_DATE    string comment '入学时间',
   GRADUATE_FLAG        int comment '是否已毕业',
   GRADUATE_DATE        string comment '预计毕业时间',
   PHONE_NO             string comment '手机号码',
   PHONE_INSTRUCTOR_NO  string comment '辅导员手机号',
   PHONE_PARENTS_NO     string comment '父母手机号',
   PHONE_CONTACT1_NO    string comment '联系人1手机号',
   PHONE_CONTACT2_NO    string comment '联系人2手机号',
   PHONE_CONTACT3_NO    string comment '联系人3手机号',
   QQ                   string comment 'QQ',
   EMAIL                string comment '邮箱地址',
   OCCUPATION           string comment '职业',
   WORKING_YEAR         int comment '工作年限',
   COMPANY_NAME         string comment '公司名称',
   COMPANY_TYPE         int comment '公司类型',
   PHONE_COMPANY_NO     string comment '公司电话号码',
   APPLY_DATE           string comment '申请时间',
   PRODUCT              string comment '申请产品',
   APPLY_AMT            decimal(38,10) comment '申请金额',
   APPLY_TERM           int comment '申请期限',
   SIGN_RESULT          string comment '签约结果',
   APPROVE_RESULT       string comment '审批结果',
   APPROVE_AMT          decimal(38,10) comment '审批金额',
   REFUSE_REASON        string comment '拒绝原因',
   CANCELL_REASON       string comment '取消原因',
   BACK_REASON          string comment '回退原因',
   CHANNEL              string comment '渠道',
   RESOURCE             string comment '来源',
   PURPOSE              string comment '借款标题',
   SCORE                string comment '评分',
   LEVEL                string comment '评级',
   VIDEO_FLAG           int comment '是否提交视频',
   PHONECALL_FLAG       string comment '电联状态',
   PHONECALL_PARENTS_FLAG string comment '父母电联状态',
   PHONECALL_GUIDER_FLAG string comment '辅导员电联状态',
   PHONECALL_CONTACT1_FLAG string comment '联系人1电联状态',
   PHONECALL_CONTACT2_FLAG string comment '联系人2电联状态',
   PHONECALL_CONTACT3_FLAG string comment '联系人3电联状态',
   REGISTER_IP          string comment '注册ip地址',
   STUDENT_CERTIFICATE1_FLAG int comment '是否学籍认证',
   STUDENT_CERTIFICATE2_FLAG int comment '是否学历认证',
   INSURANCE_SOCIETY_FLAG int comment '是否有社保',
   FAMILY_INCOME_AMT    int comment '家庭收入',
   FRAUD_FLAG           int comment '是否欺诈',
   FRAUD_TYPE           string comment '欺诈类型',
   MERCHANT_NAME        string comment '商户名称',
   COUNSELLOR_NAME      string comment '辅导员姓名',
   PARENT_NAME          string comment '父母姓名',
   CONTACT_NAME1        string comment '联系人1姓名',
   CONTACT_NAME2        string comment '联系人2姓名',
   CONTACT_NAME3        string comment '联系人3姓名',
   COUNSELLOR_PHONE     string comment '辅导员手机号归属地',
   PARENT_PHONE         string comment '父母手机号归属地',
   CONTACT_PHONE1       string comment '联系人1手机号归属地',
   CONTACT_PHONE2       string comment '联系人2手机号归属地',
   CONTACT_PHONE3       string comment '联系人3手机号归属地',
   AM_AUDIT_TIME        string comment '初审通过时间',
   BANK_CARD_NO         string comment '银行卡号',
   BANK_NAME            string comment '银行名',
   USER_ID              bigint comment '用户编号',
   AUTO_DECISION        string comment '决策最终结果',
   AUTO_DECISION_DATE   string comment '最终决策时间',
   ISNEWUSER            string comment '是否新老用户',
   RULE_ID              string comment '拒绝原因小类码',
   IS_TONGDUN           string comment '同盾网信息',
   IS_BLACK_GRAY        string comment '本地黑灰名单',
   USERRISKBILL         string comment '是否风险名单',
   ADDRESS_HOME         string comment '家庭住址',
   DW_CREATE_BY         string comment '系统字段-创建者',
   DW_CREATE_TIME       string comment '系统字段-创建时间',
   DW_UPDATE_BY         string comment '系统字段-修改者',
   DW_UPDATE_TIME       string comment '系统字段-修改时间',
   BL_GRADUATE_TIME     string comment '鹏元毕业时间',
   IS_GJJ_SUBMIT        string comment '是否有公积金',
   MOBILE_ADDRESS       string comment '本人手机号码归属地',
   PASS_RULE            string comment '自动通过规则',
   APPLY_CHANNEL        string comment '申请渠道',
   AUTO_DECISION_CODE   string comment '决策最终结果代码',
   PUBLISH_DURATION     int comment '发布时长',
   CONFIRM_DURATION     int comment '审核时长',
   LEND_DURATION        int comment '放款时长',
   IS_STOCK_CAMPAIGN    string comment '是否存量战役标志 1:是 0:不是',
   CONTENT              string comment '附件内容',
   IS_GJJ_AUTH          int comment '是否公积金认证',
   INCREASE_AMT_110     decimal(38,10) comment '大额借增信额度',
   TOTAL_AMT_110        decimal(38,10) comment '大额借总额度',
   AMT_111              decimal(38,10) comment '闪电借额度',
   KNOW_APPROACH_NAME   string comment '客户获知途径',
   ED_REASON_ID         string comment '拒绝原因码',
   RG_RULE_ID           string comment '转人工规则码',
   RG_REASON_ID         string comment '转人工原因码',
   UNIFI_REGISTER_COUNTRY_NAME string comment '注册所在国',
   IS_REPEAT_BORROW     int comment '是否复借',
   VIDEO_LBS_ADDRESS    string comment '生成正式标的LBS地址',
   CURRENT_ADDRESS      string comment '联系地址',
   COMPANY_ADDRESS      string comment '公司地址',
   BLD_OLD_LEVEL        string comment '白领贷老评级',
   P_KEY                int comment '产品代理键',
   IS_BORROWS_RAISE     int comment '是否一键再借',
   MONTHLY_SALARY       string comment '月薪',
   MONTHLY_DEBT         string comment '月负债',
   BASE_AMOUNT_TYPE_110 int comment '大额借基础额度认定类型')
COMMENT '用户表'
PARTITIONED BY (STAT_DATE int COMMENT '统计日期 年月日')
ROW FORMAT DELIMITED
  NULL DEFINED AS ''
STORED AS PARQUET 
TBLPROPERTIES ("parquet.compression"="SNAPPY");
