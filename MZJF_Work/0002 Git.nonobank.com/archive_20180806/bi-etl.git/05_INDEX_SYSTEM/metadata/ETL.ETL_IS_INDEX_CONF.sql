# ************************************************************
# Sequel Pro SQL dump
# Version 4541
#
# http://www.sequelpro.com/
# https://github.com/sequelpro/sequelpro
#
# Host: 172.16.2.148 (MySQL 5.7.17-0ubuntu0.16.04.1-log)
# Database: ETL
# Generation Time: 2017-10-25 01:45:11 +0000
# ************************************************************


/*!40101 SET @OLD_CHARACTER_SET_CLIENT=@@CHARACTER_SET_CLIENT */;
/*!40101 SET @OLD_CHARACTER_SET_RESULTS=@@CHARACTER_SET_RESULTS */;
/*!40101 SET @OLD_COLLATION_CONNECTION=@@COLLATION_CONNECTION */;
/*!40101 SET NAMES utf8 */;
/*!40014 SET @OLD_FOREIGN_KEY_CHECKS=@@FOREIGN_KEY_CHECKS, FOREIGN_KEY_CHECKS=0 */;
/*!40101 SET @OLD_SQL_MODE=@@SQL_MODE, SQL_MODE='NO_AUTO_VALUE_ON_ZERO' */;
/*!40111 SET @OLD_SQL_NOTES=@@SQL_NOTES, SQL_NOTES=0 */;


# Dump of table ETL_IS_INDEX_CONF
# ------------------------------------------------------------

DROP TABLE IF EXISTS `ETL_IS_INDEX_CONF`;

CREATE TABLE `ETL_IS_INDEX_CONF` (
  `INDEX_ID` int(11) NOT NULL AUTO_INCREMENT COMMENT 'PK',
  `INDEX_NAME` varchar(128) NOT NULL COMMENT '指标名称',
  `INDEX_GROUP` varchar(256) DEFAULT NULL COMMENT '指标所属的组',
  `INDEX_REPORT` varchar(64) DEFAULT 'NONO_KPI' COMMENT '指标所属的报表',
  `INDEX_FREQ` varchar(512) NOT NULL DEFAULT 'DAILY' COMMENT '指标计算频率',
  `SQL_DB` varchar(64) DEFAULT 'nono' COMMENT 'jdni的名称',
  `SQL_TEXT` text COMMENT '运算指标所对应的脚本',
  `SQL_PATTERN_ID` int(11) DEFAULT NULL COMMENT 'ETL_IS_SQL_PATTERN.PATTERN_ID',
  `DIM_1_NM` varchar(64) DEFAULT NULL COMMENT '维度1',
  `DIM_2_NM` varchar(64) DEFAULT NULL COMMENT '维度2',
  `DIM_3_NM` varchar(64) DEFAULT NULL COMMENT '维度3',
  `MEASURE_TYPE` varchar(64) DEFAULT NULL COMMENT '度量类别(人数/次数/金额)',
  `DIM_CNT` int(5) DEFAULT '0' COMMENT '维度数量',
  `IS_VALID` char(1) DEFAULT '1' COMMENT '指标是否计算:1-计算，0-不计算',
  `CREATE_TIME` datetime DEFAULT CURRENT_TIMESTAMP COMMENT '创建时间',
  `UPDATE_TIME` datetime DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT '更新时间',
  `CREATE_BY` varchar(64) DEFAULT 'SYS' COMMENT '创建人',
  `UPDATE_BY` varchar(64) DEFAULT 'SYS' COMMENT '更新人',
  `date_range` char(2) DEFAULT '0' COMMENT '时间范围:0-昨日,1-截止到昨日,2-今日,3-截止到今日',
  `date_column` varchar(128) DEFAULT 'dt' COMMENT '时间字段',
  `MEASURE_TYPE_DESC` varchar(256) DEFAULT NULL COMMENT '度量类别描述',
  PRIMARY KEY (`INDEX_ID`),
  UNIQUE KEY `INDEX_NAME` (`INDEX_NAME`,`INDEX_REPORT`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8 COMMENT='指标配置表';

LOCK TABLES `ETL_IS_INDEX_CONF` WRITE;
/*!40000 ALTER TABLE `ETL_IS_INDEX_CONF` DISABLE KEYS */;

INSERT INTO `ETL_IS_INDEX_CONF` (`INDEX_ID`, `INDEX_NAME`, `INDEX_GROUP`, `INDEX_REPORT`, `INDEX_FREQ`, `SQL_DB`, `SQL_TEXT`, `SQL_PATTERN_ID`, `DIM_1_NM`, `DIM_2_NM`, `DIM_3_NM`, `MEASURE_TYPE`, `DIM_CNT`, `IS_VALID`, `CREATE_TIME`, `UPDATE_TIME`, `CREATE_BY`, `UPDATE_BY`, `date_range`, `date_column`, `MEASURE_TYPE_DESC`)
VALUES
	(1,'累计注册人数','注册','NONO_KPI','30MIN','nono','select \r\n  t.dt,\r\n  t.user_id\r\nfrom ( ${V_SQL_PATTERN} ) t',8,NULL,NULL,NULL,NULL,0,'1','2016-10-24 11:41:39','2017-04-13 20:27:06','SYS','bofei','3','dt',NULL),
	(2,'累计投资人数','投资','NONO_KPI','30MIN','nono','select \r\n  t.dt as dt,\r\n  t.user_id as user_id\r\nfrom ( ${V_SQL_PATTERN} ) t',6,NULL,NULL,NULL,NULL,0,'1','2016-10-24 12:49:21','2017-04-13 20:27:06','SYS','bofei','3','dt',NULL),
	(3,'累计入金金额','入金','NONO_KPI','30MIN','nono','select \r\n  t.dt as dt,\r\n  t.inv_amt as inv_amt\r\nfrom ( ${V_SQL_PATTERN} ) t',6,NULL,NULL,NULL,NULL,0,'1','2016-10-24 12:49:49','2017-04-13 20:27:06','SYS','bofei','3','dt',NULL),
	(4,'诺诺在投金额','在投','NONO_KPI','30MIN','nono','select \r\n t.dt           as dt,\r\n t.hold_inv_amt as hold_inv_amt\r\nfrom ( ${V_SQL_PATTERN} ) t',4,NULL,NULL,NULL,NULL,0,'1','2016-10-25 17:16:03','2017-04-13 20:27:06','SYS','bofei','3','dt',NULL),
	(5,'诺诺在投人数','在投','NONO_KPI','30MIN','nono','select \r\n t.dt                as dt,\r\n t.hold_inv_usr_cnt  as hold_inv_usr_cnt\r\nfrom ( ${V_SQL_PATTERN} ) t',4,NULL,NULL,NULL,NULL,0,'1','2016-10-25 17:17:49','2017-04-13 20:27:06','SYS','bofei','3','dt',NULL),
	(6,'首投人数','投资','NONO_KPI','30MIN','nono','select \r\n  t.user_id as user_id,\r\n  min(t.dt) AS fs_inv_date\r\nfrom ( ${V_SQL_PATTERN} ) t\r\ngroup by t.user_id \r\n',6,NULL,NULL,NULL,NULL,0,'1','2016-10-25 17:23:52','2017-04-13 20:27:06','SYS','bofei','2','fs_inv_date',NULL),
	(7,'入金金额','入金','NONO_KPI','30MIN','nono','select \r\n  t.dt as dt,\r\n  t.inv_amt as inv_amt\r\nfrom ( ${V_SQL_PATTERN} ) t',6,NULL,NULL,NULL,NULL,0,'1','2016-10-24 13:56:25','2017-04-13 20:27:06','SYS','bofei','2','dt',NULL),
	(8,'还款金额','还款','NONO_KPI','30MIN','impala','SELECT \n dt,\n repay_amt \nFROM ( ${V_SQL_PATTERN} ) tt',43,NULL,NULL,NULL,NULL,0,'1','2016-10-24 13:56:47','2017-04-13 20:27:06','SYS','bofei','2','dt',NULL),
	(9,'兑付金额','兑付','NONO_KPI','30MIN','nono','SELECT\n\n  t.dt,\n\n  t.cash_amt\n\nFROM ( ${V_SQL_PATTERN} ) t',7,NULL,NULL,NULL,NULL,0,'1','2016-10-24 13:57:01','2017-04-13 20:27:06','SYS','bofei','2','dt',NULL),
	(10,'按产品名称统计投资人数','产品','NONO_KPI','DAILY','nono','select \r\n  T.dt,\r\n  T.user_id,\r\n  T.product_name\r\nfrom ( ${V_SQL_PATTERN} ) T',3,'product_name',NULL,NULL,NULL,1,'1','2016-10-24 11:43:31','2017-04-13 20:27:06','SYS','bofei','0','dt',NULL),
	(11,'按产品名称统计投资金额','产品','NONO_KPI','30MIN','nono','select \r\n  T.dt,\r\n  T.inv_amt,\r\n  T.product_name\r\nfrom ( ${V_SQL_PATTERN} ) T',3,'product_name',NULL,NULL,NULL,1,'1','2016-10-24 11:43:51','2017-04-13 20:27:06','SYS','bofei','2','dt',NULL),
	(12,'按产品名称统计累计投资金额','产品','NONO_KPI','30MIN','nono','select \r\n  T.dt,\r\n  T.inv_amt,\r\n  T.product_name\r\nfrom ( ${V_SQL_PATTERN} ) T',3,'product_name',NULL,NULL,NULL,1,'1','2016-10-24 11:50:25','2017-04-13 20:27:06','SYS','bofei','3','dt',NULL),
	(13,'按产品名称统计累计投资人数','产品','NONO_KPI','30MIN','nono','select \r\n  T.dt,\r\n  T.user_id,\r\n  T.product_name\r\nfrom ( ${V_SQL_PATTERN} ) T',3,'product_name',NULL,NULL,NULL,1,'1','2016-10-24 11:50:45','2017-04-13 20:27:06','SYS','bofei','3','dt',NULL),
	(14,'按券码名称统计投资金额','券码','NONO_KPI','30MIN','nono','select \r\n  T.dt,\r\n  T.inv_amt,\r\n  T.coupon_name\r\nfrom ( ${V_SQL_PATTERN} ) T',1,'coupon_name',NULL,NULL,NULL,1,'1','2016-10-24 16:22:13','2017-04-13 20:27:06','SYS','bofei','2','dt',NULL),
	(15,'按券码名称统计使用人数','券码','NONO_KPI','DAILY','nono','select \r\n t.dt,\r\n t.usr_cnt,\r\n t.coupon_name\r\nfrom ( ${V_SQL_PATTERN} ) t',1,'coupon_name',NULL,NULL,NULL,1,'1','2016-10-25 15:40:13','2017-04-13 20:27:06','SYS','bofei','0','dt',NULL),
	(16,'按券码名称统计使用张数','券码','NONO_KPI','DAILY','nono','select \r\n t.dt,\r\n t.coupon_cnt,\r\n t.coupon_name\r\nfrom ( ${V_SQL_PATTERN} ) t',1,'coupon_name',NULL,NULL,NULL,1,'1','2016-10-25 15:42:04','2017-04-13 20:27:06','SYS','bofei','0','dt',NULL),
	(17,'按券码名称统计使用面值','券码','NONO_KPI','DAILY','nono','select \r\n t.dt,\r\n t.cost_amt,\r\n t.coupon_name\r\nfrom ( ${V_SQL_PATTERN} ) t',1,'coupon_name',NULL,NULL,NULL,1,'1','2016-10-25 15:44:21','2017-04-13 20:27:06','SYS','bofei','0','dt',NULL),
	(18,'按券码名称统计累计投资金额','券码','NONO_KPI','30MIN','nono','select \r\n  T.dt,\r\n  T.inv_amt,\r\n  T.coupon_name\r\nfrom ( ${V_SQL_PATTERN} ) T',1,'coupon_name',NULL,NULL,NULL,1,'1','2016-10-26 15:45:43','2017-04-13 20:27:06','SYS','bofei','3','dt',NULL),
	(19,'按券码名称统计累计使用人数','券码','NONO_KPI','30MIN','nono','select \r\n t.dt,\r\n t.usr_cnt,\r\n t.coupon_name\r\nfrom ( ${V_SQL_PATTERN} ) t',1,'coupon_name',NULL,NULL,NULL,1,'1','2016-10-26 17:14:11','2017-04-13 20:27:06','SYS','bofei','3','dt',NULL),
	(20,'按券码名称统计累计使用张数','券码','NONO_KPI','30MIN','nono','select \r\n t.dt,\r\n t.coupon_cnt,\r\n t.coupon_name\r\nfrom ( ${V_SQL_PATTERN} ) t',1,'coupon_name',NULL,NULL,NULL,1,'1','2016-10-26 17:20:19','2017-04-13 20:27:06','SYS','bofei','3','dt',NULL),
	(21,'按券码名称统计累计使用面值','券码','NONO_KPI','30MIN','nono','select \r\n t.dt,\r\n t.cost_amt,\r\n t.coupon_name\r\nfrom ( ${V_SQL_PATTERN} ) t',1,'coupon_name',NULL,NULL,NULL,1,'1','2016-10-26 17:21:53','2017-04-13 20:27:06','SYS','bofei','3','dt',NULL),
	(22,'注册人数','注册','NONO_KPI','DAILY','nono','select \r\n  t.dt,\r\n  t.user_id\r\nfrom ( ${V_SQL_PATTERN} ) t',8,NULL,NULL,NULL,NULL,0,'1','2016-10-27 16:47:11','2017-04-13 20:27:06','SYS','bofei','0','dt',NULL),
	(23,'累计精选二投人数','投资','NONO_KPI','DAILY','nono','select \r\n  str_to_date(\'${V_STAT_DATE}\',\'%Y-%m-%d\')     as idx_date,\r\n   COUNT(t4.user_id)                           as idx_val\r\nfrom \r\n(\r\nSELECT\r\n  t3.user_id,\r\n  COUNT(*) AS inv_cnt\r\nFROM (\r\n SELECT \r\n  date(SERVICE_TIME) as dt,\r\n  USER_ID\r\n FROM db_nono.vip_form                                     \r\n WHERE SERVICE_STATUS=1\r\n and SERVICE_TIME < \'${V_END_DATE}\'\r\n) t3\r\nJOIN db_nono.user_info t4\r\nON t3.USER_ID = t4.ID\r\nWHERE t4.ID NOT IN(920272,1598,1600,1176674)\r\nAND t4.IS_SPECIAL<>1\r\nGROUP BY t3.user_id\r\n) t4\r\nWHERE t4.inv_cnt >= 2\r\ngroup by 1',NULL,NULL,NULL,NULL,NULL,0,'1','2016-10-27 16:54:58','2017-04-13 20:27:06','SYS','bofei','1','idx_date',NULL),
	(24,'精选兑付人数','兑付','NONO_KPI','DAILY','nono','SELECT\n  t3.dt as dt,\n  t3.user_id as user_id\nFROM (\n -- 优选\n SELECT\n    DATE(t1.cash_time) AS dt,\n    t1.amount AS val,\n    t1.user_id\n FROM db_nono.vip_account t1\n JOIN db_nono.finance_plan fp\n ON t1.FP_ID=fp.ID AND fp.TITLE NOT LIKE \'%新客%\'\n where  t1.is_cash = 1\n) t3\nJOIN db_nono.user_info t4\nON t3.USER_ID = t4.ID\nWHERE t4.ID NOT IN(920272,1598,1600,1176674)\nAND t4.IS_SPECIAL<>1',NULL,NULL,NULL,NULL,NULL,0,'1','2016-10-27 17:04:52','2017-04-13 20:27:06','SYS','bofei','0','dt',NULL),
	(25,'精选兑付后1天投资人数','投资','NONO_KPI','DAILY','nono','select\n  str_to_date(\'${V_STAT_DATE}\',\'%Y-%m-%d\')    as idx_date,\n  count(distinct t_cash.user_id)              as idx_val\nfrom\n(\nselect\n  t3.dt,\n  t3.user_id,\n  count(*) as cash_cnt\nFROM (\n     SELECT\n        DATE(t1.cash_time) AS dt,\n        t1.amount AS val,\n        t1.user_id\n     FROM db_nono.vip_account t1\n     JOIN db_nono.finance_plan fp\n     ON t1.FP_ID=fp.ID AND fp.TITLE NOT LIKE \'%新客%\'\n	 where t1.is_cash = 1\n    ) t3\n    JOIN db_nono.user_info t4\n    ON t3.USER_ID = t4.ID\n    WHERE t4.ID NOT IN(920272,1598,1600,1176674)\n    AND t4.IS_SPECIAL<>1\n    GROUP BY t3.dt,t3.user_id\n) t_cash\njoin (\n    select\n      t1.CUR_DT as dt,\n      t1.user_id,\n      count(*) as inv_cnt\n    from\n    (SELECT DATE(service_time) AS CUR_DT,user_id,amount_payed\n       FROM db_nono.vip_form\n       WHERE service_status=1\n       AND service_time >= \'${V_BEGIN_DATE}\'\n       AND service_time < date_add(str_to_date(\'${V_END_DATE}\',\'%Y-%m-%d\'),interval 7 day)\n    UNION ALL\n    SELECT DATE(pay_time) AS cur_dt,user_id,price_in\n        FROM db_nono.debt_buy_log\n        WHERE pay_time >=  \'${V_BEGIN_DATE}\'\n        AND pay_time < date_add(str_to_date(\'${V_END_DATE}\',\'%Y-%m-%d\'),interval 7 day)\n        AND p_type=3\n        AND STATUS=1\n        AND (va_id IS NULL OR va_id =0)\n    UNION ALL\n    SELECT DATE(ff_service_time) AS cur_dt,user_id,ff_amount_payed\n        FROM db_nono.fund_form\n        WHERE ff_service_status=1\n        AND ff_service_time >= \'${V_BEGIN_DATE}\'\n        AND ff_service_time < date_add(str_to_date(\'${V_END_DATE}\',\'%Y-%m-%d\'),interval 7 day)\n    ) t1\n    INNER JOIN db_nono.user_info t2 ON t1.user_id=t2.id\n    WHERE t2.ID NOT IN(920272,1598,1600,1176674)\n    AND t2.is_special<>1\n    group by t1.CUR_DT,t1.user_id\n) t_inv\non t_cash.user_id = t_inv.user_id and t_cash.dt <= t_inv.dt\nwhere  datediff(t_inv.dt,t_cash.dt) = 0\ngroup by 1',NULL,NULL,NULL,NULL,NULL,0,'1','2016-10-27 17:10:41','2017-04-13 20:27:06','SYS','bofei','0','idx_date',NULL),
	(26,'按产品类别统计投资金额','投资','PRD_DEPT_NONO_RPT','DAILY','nono','select \r\n  dt,\r\n  product_type,\r\n  inv_amt\r\nfrom ( ${V_SQL_PATTERN} ) t',9,'product_type',NULL,NULL,NULL,1,'1','2016-10-28 15:12:47','2017-03-15 18:05:28','SYS','liuhailiang','0','dt',NULL),
	(27,'按终端统计投资金额','投资','PRD_DEPT_NONO_RPT','DAILY','nono','select \r\n  dt,\r\n  terminal,\r\n  inv_amt\r\nfrom ( ${V_SQL_PATTERN} ) t',9,'terminal',NULL,NULL,NULL,1,'1','2016-10-28 15:20:36','2017-03-15 18:05:28','SYS','liuhailiang','0','dt',NULL),
	(30,'认证人数','认证','PRD_DEPT_NONO_RPT','DAILY','nono','SELECT \r\n  t.dt,\r\n  t.id_num\r\nFROM ( ${V_SQL_PATTERN} ) t  ',10,NULL,NULL,NULL,NULL,0,'1','2016-10-30 17:49:25','2017-03-15 18:05:28','SYS','liuhailiang','0','dt',NULL),
	(31,'绑卡人数','绑卡','PRD_DEPT_NONO_RPT','DAILY','nono','select\r\n  t.dt,\r\n  t.user_id\r\nfrom ( ${V_SQL_PATTERN} ) t',11,NULL,NULL,NULL,NULL,0,'1','2016-10-30 17:51:00','2017-03-15 18:05:28','SYS','liuhailiang','0','dt',NULL),
	(32,'充值记录','充值','PRD_DEPT_NONO_RPT','DAILY','nono','SELECT \r\n  t.dt,\r\n  t.user_id\r\nFROM ( ${V_SQL_PATTERN} ) t',12,NULL,NULL,NULL,NULL,0,'1','2016-10-30 17:55:30','2017-03-15 18:05:28','SYS','liuhailiang','0','dt',NULL),
	(33,'取现记录','取现','PRD_DEPT_NONO_RPT','DAILY','nono','select\r\n  t.dt,\r\n  t.user_id\r\nfrom ( ${V_SQL_PATTERN} ) t',13,NULL,NULL,NULL,NULL,0,'1','2016-10-30 17:58:59','2017-03-15 18:05:28','SYS','liuhailiang','0','dt',NULL),
	(35,'注册人数','注册','PRD_DEPT_NONO_RPT','DAILY','caishen_new','select \r\n  t.dt,\r\n  t.user_id\r\nfrom ( ${V_SQL_PATTERN} ) t',8,NULL,NULL,NULL,NULL,0,'1','2016-10-30 18:01:47','2017-08-21 15:10:46','SYS','liuhailiang','0','dt',NULL),
	(36,'首次投资人数','投资','PRD_DEPT_NONO_RPT','DAILY','impala','select \n min(invest_date) as  dt,\n user_id\nfrom rpt.v_nono_invest\ngroup by user_id ',9,NULL,NULL,NULL,NULL,0,'1','2016-10-30 18:03:59','2017-03-15 18:05:28','SYS','liuhailiang','0','dt',NULL),
	(37,'按产品类别统计投资人数','投资','PRD_DEPT_NONO_RPT','DAILY','nono','select \r\n t.dt,\r\n t.product_type,\r\n t.user_id\r\nfrom ( ${V_SQL_PATTERN}) t',9,'product_type',NULL,NULL,NULL,1,'1','2016-10-30 19:13:02','2017-03-15 18:05:28','SYS','liuhailiang','0','dt',NULL),
	(42,'按终端统计投资人数','投资','PRD_DEPT_NONO_RPT','DAILY','nono','select \r\n  t.dt,\r\n  t.terminal,\r\n  t.user_id\r\nfrom ( ${V_SQL_PATTERN} ) t',9,'terminal',NULL,NULL,NULL,1,'1','2016-10-30 19:18:23','2017-03-15 18:05:28','SYS','liuhailiang','0','dt',NULL),
	(43,'累计精选投资人数','投资','NONO_KPI','DAILY','nono','select \r\n   t3.dt,\r\n   t3.user_id\r\nFROM (\r\n SELECT \r\n  date(SERVICE_TIME) as dt,\r\n  USER_ID\r\n FROM db_nono.vip_form                                     \r\n WHERE SERVICE_STATUS=1\r\n) t3\r\nJOIN db_nono.user_info t4\r\nON t3.USER_ID = t4.ID\r\nWHERE t4.ID NOT IN(920272,1598,1600,1176674)\r\nAND t4.IS_SPECIAL<>1',NULL,NULL,NULL,NULL,NULL,0,'1','2016-10-31 15:36:24','2017-04-13 20:27:06','SYS','bofei','1','dt',NULL),
	(44,'财神_注册人数','财神','PRD_DEPT_CAISHEN_RPT','DAILY','caishen','select \r\n  t.dt,\r\n  t.user_code\r\nfrom ( ${V_SQL_PATTERN} ) t',15,NULL,NULL,NULL,NULL,0,'1','2016-11-01 15:44:59','2016-11-25 16:57:24','SYS','SYS','0','dt',NULL),
	(45,'财神_认证人数','财神','PRD_DEPT_CAISHEN_RPT','DAILY','caishen','select \r\n  t.dt,\r\n  t.user_code\r\nfrom ( ${V_SQL_PATTERN} ) t',16,NULL,NULL,NULL,NULL,0,'1','2016-11-01 16:42:21','2016-11-25 16:57:24','SYS','SYS','0','dt',NULL),
	(46,'财神_绑卡人数','财神','PRD_DEPT_CAISHEN_RPT','DAILY','caishen','select \r\n  t.dt,\r\n  t.user_code\r\nfrom ( ${V_SQL_PATTERN} ) t',17,NULL,NULL,NULL,NULL,0,'1','2016-11-01 16:45:03','2016-11-25 16:57:24','SYS','SYS','0','dt',NULL),
	(47,'财神_充值人数','财神','PRD_DEPT_CAISHEN_RPT','DAILY','caishen','select \r\n  t.dt,\r\n  t.user_code\r\nfrom ( ${V_SQL_PATTERN} ) t',18,NULL,NULL,NULL,NULL,0,'1','2016-11-01 16:46:52','2016-11-25 16:57:24','SYS','SYS','0','dt',NULL),
	(48,'财神_首次投资人数','财神','PRD_DEPT_CAISHEN_RPT','DAILY','impala','select \n min(invest_date) as  dt,\n user_code\nfrom rpt.v_cs_invest\ngroup by user_code',NULL,NULL,NULL,NULL,NULL,0,'1','2016-11-01 16:48:38','2017-03-16 13:11:52','SYS','liuhailiang','0','dt',NULL),
	(49,'财神_取现人数','财神','PRD_DEPT_CAISHEN_RPT','DAILY','caishen','select \r\n  t.dt,\r\n  t.user_code\r\nfrom ( ${V_SQL_PATTERN} ) t',20,NULL,NULL,NULL,NULL,0,'1','2016-11-01 16:50:05','2016-11-25 16:57:24','SYS','SYS','0','dt',NULL),
	(50,'财神_按产品名称统计投资人数','财神','PRD_DEPT_CAISHEN_RPT','DAILY','caishen','select \r\n  t.dt,\r\n  t.product_name,\r\n  t.user_code,\r\n  t.inv_amt\r\nfrom ( ${V_SQL_PATTERN} ) t',19,'product_name',NULL,NULL,NULL,1,'1','2016-11-01 16:53:50','2016-11-25 16:57:24','SYS','SYS','0','dt',NULL),
	(51,'财神_按产品名称统计投资金额','财神','PRD_DEPT_CAISHEN_RPT','DAILY','caishen','select \r\n  t.dt,\r\n  t.product_name,\r\n  t.user_code,\r\n  t.inv_amt\r\nfrom ( ${V_SQL_PATTERN} ) t',19,'product_name',NULL,NULL,NULL,1,'1','2016-11-01 16:56:19','2016-11-25 16:57:24','SYS','SYS','0','dt',NULL),
	(52,'名校贷_按产品名称统计借款人数','名校贷','PRD_DEPT_MXD_RPT','DAILY','nono','select \r\n t.dt,\r\n t.user_id,\r\n t.product_name,\r\n t.bo_amt\r\nfrom ( ${V_SQL_PATTERN} ) t\r\nwhere t.company = \'名校贷\' ',21,'product_name',NULL,NULL,NULL,1,'1','2016-11-04 18:32:46','2016-11-25 16:57:24','SYS','SYS','0','dt',NULL),
	(53,'名校贷_按产品名称统计借款金额','名校贷','PRD_DEPT_MXD_RPT','DAILY','nono','select \r\n t.dt,\r\n t.user_id,\r\n t.product_name,\r\n t.bo_amt\r\nfrom ( ${V_SQL_PATTERN} ) t\r\nwhere t.company = \'名校贷\' ',21,'product_name',NULL,NULL,NULL,1,'1','2016-11-04 18:33:23','2016-11-25 16:57:24','SYS','SYS','0','dt',NULL),
	(54,'大房东_按产品名称统计借款人数','大房东','PRD_DEPT_DFD_RPT','DAILY','impala','select \n  substr(t1.bo_finish_time,1,10) as dt,\n  t1.user_id,\n  t2.p_name as product_name,\n  t1.bo_finish_price bo_amt\nfrom idw.fact_borrows t1\nleft join idw.dim_asset_product t2\non t1.p_id = t2.p_id\nwhere busi_line in (\'大房东\')',NULL,'product_name',NULL,NULL,NULL,1,'1','2016-11-04 18:37:03','2017-05-08 13:48:17','SYS','liuhailiang','0','dt',NULL),
	(55,'大房东_按产品名称统计借款金额','大房东','PRD_DEPT_DFD_RPT','DAILY','impala','select \n  substr(t1.bo_finish_time,1,10) as dt,\n  t1.user_id,\n  t2.p_name as product_name,\n  t1.bo_finish_price bo_amt\nfrom idw.fact_borrows t1\nleft join idw.dim_asset_product t2\non t1.p_id = t2.p_id\nwhere busi_line in (\'大房东\')',NULL,'product_name',NULL,NULL,NULL,1,'1','2016-11-04 18:38:41','2017-05-08 13:50:08','SYS','liuhailiang','0','dt',NULL),
	(56,'麦芽分期_按产品名称统计借款人数','麦芽分期','PRD_DEPT_MYFQ_RPT','DAILY','nono','select \r\n t.dt,\r\n t.user_id,\r\n t.bo_amt,\r\n t.product_name\r\nfrom ( ${V_SQL_PATTERN} ) t\r\nwhere t.company = \'麦芽分期\'',21,'product_name',NULL,NULL,NULL,1,'1','2016-11-04 18:39:27','2016-11-25 16:57:24','SYS','SYS','0','dt',NULL),
	(57,'麦芽分期_按产品名称统计借款金额','麦芽分期','PRD_DEPT_MYFQ_RPT','DAILY','nono','select \r\n t.dt,\r\n t.user_id,\r\n t.bo_amt,\r\n t.product_name\r\nfrom ( ${V_SQL_PATTERN} ) t\r\nwhere t.company = \'麦芽分期\'',21,'product_name',NULL,NULL,NULL,1,'1','2016-11-04 18:39:37','2016-11-25 16:57:24','SYS','SYS','0','dt',NULL),
	(58,'UNIFI_按产品名称统计借款人数','UNIFI','PRD_DEPT_UNIFI_RPT','DAILY','nono','select \r\n t.dt,\r\n t.user_id,\r\n t.product_name,\r\n t.bo_amt\r\nfrom ( ${V_SQL_PATTERN} ) t\r\nwhere t.company = \'UNIFI\'',21,'product_name',NULL,NULL,NULL,1,'1','2016-11-04 18:41:59','2016-11-25 16:57:24','SYS','SYS','0','dt',NULL),
	(59,'UNIFI_按产品名称统计借款金额','UNIFI','PRD_DEPT_UNIFI_RPT','DAILY','nono','select \r\n t.dt,\r\n t.user_id,\r\n t.product_name,\r\n t.bo_amt\r\nfrom ( ${V_SQL_PATTERN} ) t\r\nwhere t.company = \'UNIFI\'',21,'product_name',NULL,NULL,NULL,1,'1','2016-11-04 18:44:01','2016-11-25 16:57:24','SYS','SYS','0','dt',NULL),
	(60,'名校贷_各流程阶段人数','名校贷','PRD_DEPT_MXD_RPT','DAILY','nono','select \r\n t.dt,\r\n t.user_id,\r\n t.action_type\r\nfrom ( ${V_SQL_PATTERN} ) t',37,'action_type',NULL,NULL,NULL,1,'1','2016-11-06 08:57:32','2016-11-25 16:57:24','SYS','SYS','0','dt',NULL),
	(61,'大房东_各流程阶段人数','大房东','PRD_DEPT_DFD_RPT','DAILY','impala','select \r\n t.dt,\r\n t.user_id,\r\n t.action_type\r\nfrom ( ${V_SQL_PATTERN} ) t',38,'action_type',NULL,NULL,NULL,1,'1','2016-11-06 11:11:46','2017-05-08 14:22:51','SYS','liuhailiang','0','dt',NULL),
	(62,'麦芽分期_各流程阶段人数','麦芽分期','PRD_DEPT_MYFQ_RPT','DAILY','caishen','select \r\n t.dt,\r\n t.user_id,\r\n t.action_type\r\nfrom ( ${V_SQL_PATTERN} ) t',40,'action_type',NULL,NULL,NULL,1,'1','2016-11-06 11:14:29','2016-11-25 16:57:24','SYS','SYS','0','dt',NULL),
	(63,'资产端_各条线借款人数','资产端','PRD_DEPT','DAILY','nono','select \r\n t.dt,\r\n t.user_id,\r\n t.product_name,\r\n t.bo_amt,\r\n t.company\r\nfrom ( ${V_SQL_PATTERN} ) t',21,'company',NULL,NULL,NULL,1,'1','2016-11-06 12:06:28','2016-11-25 16:57:24','SYS','SYS','0','dt',NULL),
	(64,'资产端_各条线还款人数','资产端','PRD_DEPT','DAILY','nono','select \r\n t.dt,\r\n t.user_id,\r\n t.product_name,\r\n t.rep_principal_amt,\r\n t.company\r\nfrom ( ${V_SQL_PATTERN} ) t',22,'company',NULL,NULL,NULL,1,'1','2016-11-06 12:10:23','2016-11-25 16:57:24','SYS','SYS','0','dt',NULL),
	(67,'UNIFI_各流程阶段人数','UNIFI','PRD_DEPT_UNIFI_RPT','DAILY','nono','select \r\n t.dt,\r\n t.user_id,\r\n t.action_type\r\nfrom ( ${V_SQL_PATTERN} ) t',39,'action_type',NULL,NULL,NULL,1,'1','2016-11-08 17:14:19','2016-11-25 16:57:24','SYS','SYS','0','dt',NULL),
	(68,'诺诺累计注册人数','','技术中心大屏_资产端','HOURLY','nono','SELECT \n   dt,\n   user_id\nFROM (${V_SQL_PATTERN}) t',8,NULL,NULL,NULL,NULL,0,'0','2016-11-28 15:12:21','2016-12-06 09:44:39','admin','liuhailiang','3','dt',NULL),
	(70,'财神累计注册人数','','技术中心大屏_资产端','HOURLY','caishen','select dt,user_code from (${V_SQL_PATTERN}) t',15,NULL,NULL,NULL,NULL,0,'0','2016-11-28 15:26:43','2016-12-06 09:44:39','admin','liuhailiang','3','dt',NULL),
	(71,'财神在线人数','','技术中心大屏_资产端','HOURLY','caishen','SELECT NOW()   AS dt,\n       user_code \nFROM nonobank_app.user_logon_info uli\nWHERE uli.logon_time >= DATE_ADD(NOW(),INTERVAL -10 MINUTE)',NULL,NULL,NULL,NULL,NULL,0,'0','2016-11-28 15:51:37','2016-12-06 09:44:39','admin','liuhailiang','4','dt',NULL),
	(72,'诺诺在线人数','','技术中心大屏_资产端','HOURLY','nono','SELECT NOW()  AS dt,\n       user_id\nFROM db_nono.user_action_log ual\nJOIN db_nono.user_info ui ON ui.id=ual.user_id\nWHERE ual.create_time>=DATE_ADD(NOW(),INTERVAL -10 MINUTE)\nAND action_type IN(1,2,3,4,5,10)\nAND ui.user_type IN(0,1)\n',NULL,NULL,NULL,NULL,NULL,0,'0','2016-11-28 15:56:49','2016-12-06 09:44:39','admin','liuhailiang','4','dt',NULL),
	(73,'诺诺累计投资情况','','技术中心大屏_资产端','HOURLY','nono','SELECT \n   dt,\n   user_id\nFROM (${V_SQL_PATTERN}) t',9,NULL,NULL,NULL,NULL,0,'0','2016-11-28 16:05:04','2016-12-06 09:44:39','admin','liuhailiang','3','dt',NULL),
	(74,'财神累计投资情况','','技术中心大屏_资产端','HOURLY','caishen','SELECT \n   dt,\n   user_code,\n   inv_amt\nFROM (${V_SQL_PATTERN}) t',19,NULL,NULL,NULL,NULL,0,'0','2016-11-28 16:07:54','2016-12-06 09:44:39','admin','liuhailiang','3','dt',NULL),
	(75,'诺诺分时交易数据','','技术中心大屏_资产端','HOURLY','nono','SELECT DATE(tt.service_time) AS dt,\n       HOUR(tt.service_time) AS d_hour,\n       tt.user_id      AS user_id,\n       tt.amount_payed AS inv_amt \nFROM\n(\n	SELECT vf.service_time,user_id,amount_payed\n	FROM db_nono.vip_form vf\n	WHERE vf.service_status=1\n	UNION ALL\n	SELECT pay_time,dbl.user_id,price_in payed\n	FROM db_nono.debt_buy_log dbl\n	WHERE dbl.p_type=3\n	AND IFNULL(dbl.va_id,0)=0\n	AND dbl.status = 1\n) tt\nWHERE tt.user_id  NOT IN(1598,1600,920272)',NULL,'d_hour',NULL,NULL,NULL,1,'0','2016-11-28 19:02:01','2016-12-06 09:44:39','liuhailiang','liuhailiang','2','dt',NULL),
	(76,'财神分时交易数据','','技术中心大屏_资产端','HOURLY','caishen','SELECT dt,\n       HOUR(dt)         AS d_hour,\n       user_code,\n       inv_amt\nFROM\n( ${V_SQL_PATTERN} ) t',19,'d_hour',NULL,NULL,NULL,1,'0','2016-11-28 19:12:59','2016-12-06 09:44:39','liuhailiang','liuhailiang','2','dt',NULL),
	(77,'诺诺分时取现数据','诺诺分时','技术中心大屏_资产端','HOURLY','nono','SELECT DATE(update_time) AS dt,\n       HOUR(update_time) AS d_hour,\n       user_id,\n       price AS with_amt\nFROM db_nono.withdraw_cash\nWHERE STATUS =4\nAND IFNULL(bo_id,0)=0\nAND user_id NOT IN (1598,1600,1598)',NULL,'d_hour',NULL,NULL,NULL,1,'0','2016-11-28 19:18:16','2016-12-06 09:44:39','liuhailiang','liuhailiang','2','dt',NULL),
	(78,'诺诺投资金额分布','金额分布','技术中心大屏_资产端','DAILY','nono','SELECT \n  dt,\n  CASE\n    WHEN inv_amt <=  10000\n    THEN \'小于1万\'\n    WHEN inv_amt <=  5*10000\n    THEN \'1-5万\'\n     WHEN inv_amt <= 10*10000\n    THEN \'5-10万\'\n    WHEN inv_amt <=  15*10000\n    THEN \'10-15万\'\n    WHEN inv_amt <=  25*10000\n    THEN \'15-25万\'\n    WHEN inv_amt <=  50*10000\n    THEN \'25-50万\'\n    WHEN inv_amt <=  100*10000\n    THEN \'50-100万\'\n    ELSE \'大于100万\'\n  END inv_amt_range,\n  user_id,\n  inv_amt\nFROM (\nSELECT \n   STR_TO_DATE(\'${V_END_DATE}\',\'%Y-%M-%D\') AS dt,\n   user_id,\n   SUM(inv_amt) AS inv_amt\nFROM ( ${V_SQL_PATTERN} ) ttt\nWHERE dt <= \'${V_END_DATE}\' \nGROUP BY user_id\n) tt ',9,'inv_amt_range',NULL,NULL,NULL,1,'0','2016-11-28 19:48:13','2016-12-06 09:44:39','liuhailiang','liuhailiang','1','dt',NULL),
	(92,'诺诺投资省份分布','省份分布','技术中心大屏_资产端','DAILY','nono','SELECT \n   dt,\n   province,\n   inv_amt,\n   user_id\nFROM (${V_SQL_PATTERN}) t',9,'province',NULL,NULL,NULL,1,'0','2016-11-29 15:11:54','2016-12-06 09:44:39','admin','liuhailiang','1','dt',NULL),
	(93,'诺诺投资年龄分布','年龄分布','技术中心大屏_资产端','DAILY','nono','SELECT \n   dt,\n   age,\n   inv_amt,\n   user_id\nFROM (${V_SQL_PATTERN}) t',9,'age',NULL,NULL,NULL,1,'0','2016-11-29 15:11:56','2016-12-06 09:44:39','admin','liuhailiang','1','dt',NULL),
	(94,'财神投资年龄分布','年龄分布','技术中心大屏_资产端','DAILY','caishen','SELECT \n   dt,\n   age,\n   inv_amt,\n   user_code\nFROM (${V_SQL_PATTERN}) t',19,'age',NULL,NULL,NULL,1,'0','2016-11-29 15:18:45','2016-12-06 09:44:39','liuhailiang','liuhailiang','1','dt',NULL),
	(95,'财神投资省份分布','省份分布','技术中心大屏_资产端','DAILY','caishen','SELECT \n   dt,\n   user_code,\n   age,\n   inv_amt,\n   province\nFROM (${V_SQL_PATTERN}) t',19,'province',NULL,NULL,NULL,1,'0','2016-11-29 15:18:46','2016-12-06 09:44:39','liuhailiang','liuhailiang','1','dt',NULL),
	(96,'lz_诺诺省份投资','lz_group','lz_test_report','DAILY','nono','SELECT \r\n   dt\r\nWHERE DUAL\n',NULL,NULL,NULL,NULL,NULL,1,'0','2016-11-30 17:45:13','2017-01-10 09:17:54','admin','liuhailiang','1','dt',NULL),
	(97,'资金流动性_月月升_余额','入金','资金流动性_月月升_余额_日净入金','HOURLY','nono','select curdate() as dt,hour(now()) as hh, invest_amt,d_invest_amt \nfrom (${V_SQL_PATTERN}) tx',45,'hh',NULL,NULL,NULL,1,'1','2016-12-01 11:27:59','2016-12-26 09:49:57','bofei','bofei','2','dt',NULL),
	(98,'资金流动性_开心财神_余额_净入金','投资','资金流动性_开心财神_余额_净入金','HOURLY','caishen','SELECT \'${V_STAT_DATE}\' AS DT,hour(now()) as hh, INVEST_AMT,D_INVEST_AMT FROM (${V_SQL_PATTERN} ) TX ',60,'hh',NULL,NULL,NULL,1,'1','2016-12-01 17:34:29','2016-12-26 09:51:01','bofei','bofei','2','DT',NULL),
	(99,'资金流动性_财神定期_余额_净入金','投资','资金流动性_财神定期_余额_净入金','HOURLY','caishen','select \'${V_STAT_DATE}\' as dt,hour(now()) as hh, invest_amt,d_invest_amt from (${V_SQL_PATTERN} ) tx',61,'hh',NULL,NULL,NULL,1,'1','2016-12-01 17:40:43','2016-12-26 09:50:49','bofei','bofei','2','dt',NULL),
	(100,'资金流动性_财神活期_余额_净入金','投资','资金流动性_财神活期_余额_净入金','HOURLY','caishen','select \'${V_STAT_DATE}\' as dt,hour(now()) as hh, invest_amt,d_invest_amt from (${V_SQL_PATTERN} ) tx',62,'hh',NULL,NULL,NULL,1,'1','2016-12-01 17:43:57','2016-12-26 09:50:16','bofei','bofei','2','dt',NULL),
	(101,'诺诺投资次数','投资','技术中心大屏','10MIN','nono','select \n	hour(dt) the_hour,\n	dt\nfrom \n	(${V_SQL_PATTERN}) as a',9,'the_hour',NULL,NULL,NULL,1,'0','2016-12-01 17:47:08','2016-12-21 13:36:03','zhangbingcan','bofei','2','dt',NULL),
	(102,'资金流动性_诺诺定期_日净入金','投资','资金流动性_诺诺定期_日净入金','HOURLY','nono','select curdate() as dt,hour(now()) as hh, invest_amt from (${V_SQL_PATTERN} ) tx',54,'hh',NULL,NULL,NULL,1,'1','2016-12-01 18:50:14','2016-12-26 09:48:18','bofei','bofei','2','dt',NULL),
	(103,'资金流动性_诺诺定期_余额','投资','资金流动性_诺诺定期_余额','HOURLY','nono','select curdate() as dt,hour(now()) as hh, balance_amt from (${V_SQL_PATTERN} \n) tx',57,'hh',NULL,NULL,NULL,1,'1','2016-12-01 18:53:46','2016-12-26 09:52:44','bofei','bofei','2','dt',NULL),
	(104,'资金流动性_诺诺散投_余额_净入金','投资','资金流动性_诺诺散投_余额_净入金','HOURLY','nono','select curdate() as dt,hour(now()) as hh, invest_amt,d_invest_amt from (${V_SQL_PATTERN} ) tx',58,'hh',NULL,NULL,NULL,1,'1','2016-12-01 18:57:45','2016-12-26 09:48:33','bofei','bofei','2','dt',NULL),
	(105,'资金流动性_诺诺债转_余额_净入金','投资','资金流动性_诺诺债转_余额_净入金','HOURLY','nono','select curdate() as dt,hour(now()) as hh, invest_amt,d_invest_amt from (${V_SQL_PATTERN} ) tx',59,'hh',NULL,NULL,NULL,1,'1','2016-12-01 19:01:09','2016-12-26 09:49:34','bofei','bofei','2','dt',NULL),
	(106,'资金流动性_投资人数_财神_诺诺','投资','资金流动性_投资人数_财神_诺诺','DAILY','impala','select to_date(now()) as dt,user_cnt from (${V_SQL_PATTERN} ) tx',63,NULL,NULL,NULL,NULL,0,'1','2016-12-01 19:58:11','2016-12-26 09:53:17','bofei','bofei','2','dt',NULL),
	(107,'资金流动性_资产端_当前余额','资产端','资金流动性_资产端_当前余额','HOURLY','nono','SELECT \'${V_STAT_DATE}\' as dt,\n    dim.pro_name, COALESCE(balance, 0) AS balance\nFROM\n    (SELECT 1 AS PRO_TYPE, \'名校贷\' AS PRO_NAME UNION ALL SELECT 2 AS PRO_TYPE, \'大房东\' AS PRO_NAME UNION ALL SELECT 3 AS PRO_TYPE, \'麦芽分期\' AS PRO_NAME UNION ALL SELECT 4 AS PRO_TYPE, \'UniFi\' AS PRO_NAME UNION ALL SELECT 5 AS PRO_TYPE, \'非标\' AS PRO_NAME UNION ALL SELECT 6 AS PRO_TYPE, \'融易贷\' AS PRO_NAME ) dim\n        LEFT JOIN\n    (SELECT \n        COALESCE(pro_type, 99) AS pro_type, br_price_b AS balance\n    FROM\n        (SELECT \n        (CASE\n                WHEN a.p_id IN (77 , 83, 87, 88) THEN 1\n                WHEN a.p_id = 92 THEN 5\n                WHEN a.p_id IN (94 , 97) THEN 4\n                WHEN a.p_id = 96 THEN 3\n                WHEN\n                    a.p_id = 86\n                        OR a.id IN (61892 , 61894, 74633, 76582, 76834)\n                THEN\n                    2\n                ELSE 6\n            END) AS PRO_TYPE,\n            SUM(bo.br_price_b) AS br_price_b\n    FROM\n        db_nono.borrows a\n    INNER JOIN db_nono.products b ON a.p_id = b.id\n    INNER JOIN db_nono.borrows_repayment bo ON a.id = bo.bo_id\n    WHERE\n        a.bo_is_success = 1\n            AND bo.br_repay_time IS NULL\n    GROUP BY pro_type) t) num ON dim.pro_type = num.pro_type\nORDER BY dim.pro_type',NULL,'PRO_NAME',NULL,NULL,NULL,1,'1','2016-12-02 11:29:16','2016-12-26 09:51:18','admin','bofei','2','dt',NULL),
	(108,'投资金额','投资','财神大屏','HOURLY','caishen','SELECT \n dt,\n inv_amt \nFROM ( ${V_SQL_PATTERN} ) tt',19,NULL,NULL,NULL,NULL,0,'1','2016-12-02 13:49:26','2016-12-08 10:17:23','zhangbingcan','bofei','2','dt',NULL),
	(109,'取现金额','取现','财神大屏','HOURLY','caishen','SELECT \n dt,\n with_amt \nFROM ( ${V_SQL_PATTERN} ) tt',20,NULL,NULL,NULL,NULL,0,'1','2016-12-02 13:54:38','2016-12-08 10:17:23','zhangbingcan','bofei','2','dt',NULL),
	(110,'资金流动性_资产端_净流出','资产端','资金流动性_资产端_净流出','HOURLY','nono','SELECT \n    \'${V_STAT_DATE}\' as dt,hour(now()) as hh,dim.pro_name as product, COALESCE(d_amount/10000, 0) AS d_invest_amt\nFROM\n    (SELECT 1 AS PRO_TYPE, \'名校贷\' AS PRO_NAME \n		UNION ALL \n    SELECT 2 AS PRO_TYPE, \'大房东\' AS PRO_NAME \n		UNION ALL \n    SELECT 3 AS PRO_TYPE, \'麦芽分期\' AS PRO_NAME \n		UNION ALL \n    SELECT 4 AS PRO_TYPE, \'UniFi\' AS PRO_NAME \n		UNION ALL \n    SELECT 5 AS PRO_TYPE, \'非标\' AS PRO_NAME \n		UNION ALL \n    SELECT 6 AS PRO_TYPE, \'融易贷\' AS PRO_NAME ) dim\n        LEFT JOIN\n    (SELECT \n        COALESCE(pro_type, 99) AS pro_type,\n            SUM(d_amount) AS d_amount\n    FROM\n        (SELECT \n        DATE(a.bo_audit_time) dt,\n            (CASE\n                WHEN a.p_id IN (77 , 83, 87, 88) THEN 1\n                WHEN a.p_id = 92 THEN 5\n                WHEN a.p_id IN (94 , 97) THEN 4\n                WHEN a.p_id = 96 THEN 3\n                WHEN\n                    a.p_id = 86\n                        OR a.id IN (61892 , 61894, 74633, 76582, 76834)\n                THEN\n                    2\n                ELSE 6\n            END) AS PRO_TYPE,\n            SUM(a.bo_finish_price) AS d_amount\n    FROM\n        db_nono.borrows a\n    LEFT JOIN db_nono.products b ON a.p_id = b.id\n    WHERE\n        a.bo_is_success = 1\n            AND a.bo_audit_time >= DATE_ADD(\'${V_STAT_DATE}\', INTERVAL 0 DAY)\n            AND a.bo_audit_time < NOW()\n    GROUP BY pro_type UNION ALL SELECT \n        DATE(b.br_repay_time) dt,\n            (CASE\n                WHEN a.p_id IN (77 , 83, 87, 88) THEN 1\n                WHEN a.p_id = 92 THEN 5\n                WHEN a.p_id IN (94 , 97) THEN 4\n                WHEN a.p_id = 96 THEN 3\n                WHEN\n                    a.p_id = 86\n                        OR a.id IN (61892 , 61894, 74633, 76582, 76834)\n                THEN\n                    2\n                ELSE 6\n            END) AS PRO_TYPE,\n            - SUM(b.br_price_b) AS d_amount\n    FROM\n        db_nono.borrows a\n    INNER JOIN db_nono.borrows_repayment b ON a.id = b.bo_id\n    WHERE\n        b.br_repay_time >= DATE_ADD(\'${V_STAT_DATE}\', INTERVAL 0 DAY)\n            AND b.br_repay_time < NOW()\n            AND a.bo_is_success = 1\n    GROUP BY pro_type) t\n    GROUP BY pro_type) num ON dim.pro_type = num.pro_type\nORDER BY dim.pro_type',NULL,'hh','product',NULL,NULL,2,'1','2016-12-02 15:25:42','2016-12-26 09:52:04','bofei','bofei','2','dt',NULL),
	(111,'新客转化_认证绑卡','财神','财神大屏','HOURLY','caishen','SELECT\n   DATE(u.created_Date) AS dt_reg,\n   \'${V_BEGIN_DATE}\' as dt,\n   1 as reg_user,\n   ud.is_certificate_authen as cer_user,\n   ud.is_bind_bankcard as bind_user\n FROM nonobank_app.user u\n join nonobank_app.user_detail ud\n on u.user_code = ud.user_code\n where u.created_Date >= \'${V_BEGIN_DATE}\' - interval 7 day',NULL,'dt_reg',NULL,NULL,NULL,1,'1','2016-12-02 15:28:27','2016-12-23 16:23:43','zhangbingcan','bofei','2','dt',NULL),
	(112,'资金流动性_平台帐户','平台','资金流动性_平台帐户','HOURLY','nono','select \'${V_STAT_DATE}\' as dt,hour(now()) as hh, risk_amt,adv_amt,plat_amt,d_risk_amt,d_adv_amt,d_plat_amt \nfrom\n(\nSELECT \nsum(CASE WHEN a.role_id IN (6,24) THEN  a.balance-a.locking else 0 end)/10000 as risk_amt,\nsum(case when a.role_id IN (23) THEN  a.balance-a.locking else 0 end)/10000 as adv_amt,\nsum(case when a.role_id IN (6,23,24) THEN  0 else a.balance-a.locking end)/10000 as plat_amt\nFROM db_nono.finance_account a\nJOIN db_nono.finance_role b ON b.id=a.role_id\nLEFT JOIN db_nono.platform_company c ON c.id=a.owner_id \nWHERE 1=1\nAND a.role_id IN(4,23,24,25,8,9,11,17,22,30,32,39,48,12,18,28,33,38,45,46,6,52,56,54,55)\nAND IFNULL(c.id,5) IN(5,18)\n) a,\n(\nselect \nsum(CASE WHEN l.role_id IN (6,24) THEN  income-expend else 0 end)/10000 as d_risk_amt,\nsum(case when l.role_id IN (23) THEN  income-expend else 0 end)/10000 as d_adv_amt,\nsum(case when l.role_id IN (6,23,24) THEN  0 else income-expend end)/10000 as d_plat_amt\nfrom  db_nono.finance_log   l\nwhere create_time>=\'${V_STAT_DATE}\' \nand l.role_id IN(4,23,24,25,8,9,11,17,22,30,32,39,48,12,18,28,33,38,45,46,6,52,56,54,55)\nAND IFNULL(l.owner_id,5) IN(5,18)\n) b',NULL,'hh',NULL,NULL,NULL,1,'1','2016-12-02 15:36:00','2016-12-26 09:51:42','bofei','bofei','2','dt',NULL),
	(113,'新客转化_投资率','财神','财神大屏','HOURLY','caishen',' SELECT\n  DATE(u.created_Date) AS dt_reg,\n  \'${V_BEGIN_DATE}\' as dt,\n  u.user_code as reg_user,\n  up.user_code as inv_user\nFROM nonobank_app.user u\nleft join nonobank_app.user_product up\non u.user_code = up.user_code\nand up.trans_code = 1\nand up.status = 1\nwhere u.created_Date >= \'${V_BEGIN_DATE}\' - interval 7 day',NULL,'dt_reg',NULL,NULL,NULL,1,'1','2016-12-02 15:59:07','2016-12-23 16:24:25','zhangbingcan','bofei','2','dt',NULL),
	(114,'今日投资','投资','财神大屏','HOURLY','caishen','SELECT \n dt,\n product_type,\n user_code,\n inv_amt \nFROM ( ${V_SQL_PATTERN} ) tt',19,'product_type',NULL,NULL,NULL,1,'1','2016-12-02 16:55:19','2016-12-14 19:15:12','zhangbingcan','bofei','2','dt',NULL),
	(115,'今日注册','注册','财神大屏','HOURLY','caishen','SELECT \n dt,\n user_code\nFROM ( ${V_SQL_PATTERN} ) tt',15,NULL,NULL,NULL,NULL,0,'1','2016-12-02 17:05:43','2016-12-08 10:17:23','zhangbingcan','bofei','2','dt',NULL),
	(116,'今日投资分时','投资','财神大屏','HOURLY','caishen','SELECT \n dt,\n hour(dt) as hr,\n inv_amt \nFROM ( ${V_SQL_PATTERN} ) tt',19,'hr',NULL,NULL,NULL,1,'1','2016-12-02 17:46:04','2016-12-08 10:17:23','zhangbingcan','bofei','2','dt',NULL),
	(117,'今日取现分时','取现','财神大屏','HOURLY','caishen','SELECT \n dt,\n hour(dt) as hr,\n with_amt \nFROM ( ${V_SQL_PATTERN} ) tt',20,'hr',NULL,NULL,NULL,1,'1','2016-12-02 17:49:07','2016-12-08 10:17:23','zhangbingcan','bofei','2','dt',NULL),
	(118,'资金流动性_诺诺当日投资人数','投资','资金流动性_诺诺当日投资人数','HOURLY','nono','select \'${V_STAT_DATE}\' as dt, count(distinct user_id) as cnt\nfrom db_nono.vip_form\nwhere service_status=1 and create_time>=\'${V_STAT_DATE}\'',NULL,NULL,NULL,NULL,NULL,0,'1','2016-12-02 18:19:41','2016-12-26 09:52:59','bofei','bofei','2','dt',NULL),
	(119,'资金流动性_财神当天投资人数','投资','资金流动性_财神当天投资人数','HOURLY','caishen','select \'${V_STAT_DATE}\' as dt, count(distinct user_code) as cnt\nfrom \nnonobank_app.user_product\nwhere \ncreated_date>=\'${V_STAT_DATE}\'\nand status=1',NULL,NULL,NULL,NULL,NULL,0,'1','2016-12-02 18:21:05','2016-12-26 09:52:26','bofei','bofei','2','dt',NULL),
	(120,'定期在投','财神','财神大屏','HOURLY','caishen','SELECT \n\'${V_BEGIN_DATE}\' as dt,\n dt_begin,\n user_code,\n inv_amt\nFROM ( ${V_SQL_PATTERN} ) tt',113,'',NULL,NULL,NULL,0,'1','2016-12-02 19:46:51','2017-01-06 11:08:27','zhangbingcan','bofei','2','DT',NULL),
	(121,'活期在投','财神','财神大屏','HOURLY','caishen','SELECT \n dt_begin,\n user_code,\n inv_amt_left\nFROM ( ${V_SQL_PATTERN} ) tt\nwhere inv_amt_left > 0',66,NULL,NULL,NULL,NULL,0,'1','2016-12-02 20:00:42','2016-12-08 10:17:23','zhangbingcan','bofei','2','dt_begin',NULL),
	(122,'定期空仓人数','财神','财神大屏','HOURLY','caishen','select \n\'${V_BEGIN_DATE}\' as dt,\nfinish.user_code\nfrom \n(\nSELECT  distinct \n        op.user_code\nFROM nonobank_app.user_product op\nJOIN nonobank_app.product_info pii\nON pii.product_code = op.product_code\nWHERE pii.product_name not in  (\"财神招牌宝\",\"财神优选宝\",\"新优选宝\")\nAND op.trans_code = 1\nAND op.status = 1\nAND op.user_code != 999999999\nand date(op.invest_end_date)  = \'${V_BEGIN_DATE}\' - interval 1 day\n) as finish \nleft join (\nSELECT  distinct \n        op.user_code\nFROM nonobank_app.user_product op\nJOIN nonobank_app.product_info pii\nON pii.product_code = op.product_code\nWHERE pii.product_name not in  (\"财神招牌宝\",\"财神优选宝\",\"新优选宝\")\nAND op.trans_code = 1\nAND op.status = 1\nAND op.user_code != 999999999\nand date(op.invest_begin_date)  >= \'${V_BEGIN_DATE}\'\n) as b\non finish.user_code = b.user_code\nwhere b.user_code is null',NULL,NULL,NULL,NULL,NULL,0,'1','2016-12-02 20:21:06','2016-12-23 16:26:15','zhangbingcan','bofei','2','dt',NULL),
	(123,'到期兑付','财神','财神大屏','HOURLY','caishen','SELECT \n DATE(dt_end) as dt_end,\n \'${V_BEGIN_DATE}\' as dt,\n product_name,\n inv_amt\nFROM ( ${V_SQL_PATTERN} ) tt\nwhere DATE(dt_end)>=\'${V_BEGIN_DATE}\'\nAND DATE(DT_END) < DATE_ADD(\'${V_BEGIN_DATE}\',INTERVAL 20 DAY)',65,'dt_end','product_name',NULL,NULL,2,'1','2016-12-02 20:25:16','2016-12-30 10:52:46','zhangbingcan','bofei','2','dt',NULL),
	(124,'诺诺提现次数','投资','技术中心大屏','10MIN','nono','select hour(dt) as the_hour,dt from (${V_SQL_PATTERN}) as a',13,'the_hour',NULL,NULL,NULL,1,'0','2016-12-05 18:30:19','2016-12-21 13:36:03','bofei','bofei','2','dt',NULL),
	(125,'诺诺充值次数','投资','技术中心大屏','10MIN','nono','select \n	hour(dt) the_hour,\n	dt\nfrom \n	(${V_SQL_PATTERN}) as a',67,'the_hour',NULL,NULL,NULL,1,'0','2016-12-05 18:34:56','2016-12-21 13:36:03','bofei','bofei','2','dt',NULL),
	(126,'财神投资次数','投资','技术中心大屏','10MIN','caishen','select \n	hour(dt) the_hour,\n	dt\nfrom \n	(${V_SQL_PATTERN}) as a',19,'the_hour',NULL,NULL,NULL,1,'0','2016-12-05 18:39:35','2016-12-21 13:36:03','bofei','bofei','2','dt',NULL),
	(127,'财神提现次数','投资','技术中心大屏','10MIN','caishen','select \n	hour(dt) the_hour,\n	dt\nfrom \n	(${V_SQL_PATTERN}) as a',20,'the_hour',NULL,NULL,NULL,1,'0','2016-12-05 18:41:02','2016-12-21 13:36:03','bofei','bofei','2','dt',NULL),
	(128,'财神充值次数','投资','技术中心大屏','10MIN','caishen','select \n	hour(dt) the_hour,\n	dt\nfrom \n	(${V_SQL_PATTERN}) as a',18,'the_hour',NULL,NULL,NULL,1,'0','2016-12-05 18:42:44','2016-12-21 13:36:03','bofei','bofei','2','dt',NULL),
	(129,'借款次数','资产端','技术中心大屏','10MIN','nono','select \n	hour(create_time) the_hour,\n	create_time as dt\nfrom \n	(${V_SQL_PATTERN}) as a',89,'the_hour',NULL,NULL,NULL,1,'0','2016-12-05 19:31:01','2016-12-21 13:36:03','bofei','bofei','2','dt',NULL),
	(130,'诺诺注册人数','注册','技术中心大屏','10MIN','nono','select \n	hour(dt) the_hour,\n	dt\nfrom \n	(${V_SQL_PATTERN}) as a',8,'the_hour',NULL,NULL,NULL,1,'0','2016-12-06 19:11:22','2016-12-21 13:36:03','bofei','bofei','2','dt',NULL),
	(133,'财神注册人数','注册','技术中心大屏','10MIN','caishen','select \n	hour(dt) the_hour,\n	dt\nfrom \n	(${V_SQL_PATTERN}) as a',15,'the_hour',NULL,NULL,NULL,1,'0','2016-12-06 19:12:30','2016-12-21 13:36:03','bofei','bofei','2','dt',NULL),
	(134,'诺诺登录人数','登录','技术中心大屏','10MIN','nono','select \n	hour(dt) the_hour,\n	dt,\n	user_id\nfrom \n	(${V_SQL_PATTERN}) as a',14,'the_hour',NULL,NULL,NULL,1,'0','2016-12-06 19:16:01','2016-12-21 13:36:03','bofei','bofei','2','dt',NULL),
	(135,'财神登录人数','登录','技术中心大屏','10MIN','caishen','select \n	hour(dt) the_hour,\n	dt,\n	user_code\nfrom \n	(${V_SQL_PATTERN}) as a',68,'the_hour',NULL,NULL,NULL,1,'0','2016-12-06 19:17:16','2016-12-21 13:36:03','bofei','bofei','2','dt',NULL),
	(136,'债权到期与取现金额','取现','财神大屏','HOURLY','caishen','SELECT \ncreate_date as dt,\n amount as inv_amt \nFROM ( ${V_SQL_PATTERN} ) tt',90,NULL,NULL,NULL,NULL,0,'1','2016-12-08 15:46:36','2016-12-08 15:57:20','bofei','bofei','2','dt',NULL),
	(137,'今日分时债权到期与提现','取现','财神大屏','HOURLY','caishen','SELECT \n create_date as dt,\n hour(create_date ) as hh,\n amount as inv_amt \nFROM ( ${V_SQL_PATTERN} ) tt\nwhere kind<>2',90,'hh',NULL,NULL,NULL,1,'1','2016-12-08 15:52:14','2016-12-09 18:12:52','bofei','bofei','2','dt',NULL),
	(138,'财神_日净入金','财神','财神大屏','HOURLY','caishen','SELECT \n dt,product_type,\n inv_amt \nFROM ( ${V_SQL_PATTERN} ) tt',92,'product_type',NULL,NULL,NULL,1,'1','2016-12-08 17:12:18','2016-12-08 17:17:12','bofei','bofei','2','dt',NULL),
	(139,'首投人数','投资','财神大屏','HOURLY','caishen','SELECT \n mdt as dt,user_code\nFROM ( ${V_SQL_PATTERN} ) tt',93,NULL,NULL,NULL,NULL,0,'1','2016-12-08 17:59:16','2016-12-08 17:59:16','bofei','bofei','2','dt',NULL),
	(140,'累记投资人数','投资','财神大屏','HOURLY','caishen','select \'${V_BEGIN_DATE}\' as dt, user_code,\n        abs(inv_amt) as abs_amt,\n        inv_amt as amt \n        from \n        (${V_SQL_PATTERN}) tt',92,NULL,NULL,NULL,NULL,0,'1','2016-12-08 18:13:17','2016-12-23 16:26:55','bofei','bofei','3','dt',NULL),
	(141,'交易人数','交易','财神大屏','HOURLY','caishen','SELECT \n dt,\n product_type,\n user_code,\n inv_amt \nFROM ( ${V_SQL_PATTERN} ) tt\nwhere type_cd in (2,3)',92,NULL,NULL,NULL,NULL,0,'1','2016-12-14 19:19:08','2016-12-15 09:47:02','bofei','bofei','2','dt',NULL),
	(142,'流失用户_渠道_性别_年龄','流失用户','诺诺_用户生命周期','DAILY','hive','SELECT \n stat_date as dt,\n channel,\n province,gender,age_range \nFROM ( ${V_SQL_PATTERN} ) tt\nwhere \nstat_date=\'${V_STAT_DATE}\'\nand datediff(\'${V_STAT_DATE}\',last_invest_time)=90\nand (aum+balance_amt)<=50',98,'channel','gender','age_range',NULL,3,'1','2016-12-16 13:20:33','2017-01-10 09:46:35','bofei','bofei','0','dt',NULL),
	(143,'流失用户_区域','流失用户','诺诺_用户生命周期','DAILY','hive','select \n\'${V_STAT_DATE}\' as dt, province,\nsum(cnt) as cnt\nfrom (\nselect \n(case when row_number()over(order by cnt desc ) <=5 then province else \'其它\' end ) as province\n,cnt\nfrom (\nselect \nprovince\n,count(1) as cnt \nfrom ( ${V_SQL_PATTERN} ) ta\nwhere \nstat_date=\'${V_STAT_DATE}\'\nand datediff(\'${V_STAT_DATE}\',last_invest_time)=90\nand (aum+balance_amt)<=50\ngroup by province) t) t2\ngroup by province',98,'province',NULL,NULL,NULL,1,'1','2016-12-16 14:44:46','2017-01-10 09:46:35','bofei','bofei','0','dt',NULL),
	(144,'流失用户_累计金额_次数','投资','诺诺_用户生命周期','DAILY','hive','select \n\'${V_STAT_DATE}\' as dt,\'1\' as t3,\ncase when invest_amt<=50000 then \'<5w\'\n    when invest_amt>50000 and invest_amt<=200000 then \'5w-20w\'\n	when invest_amt>200000 and invest_amt<=500000 then \'20w-50w\'\n	when invest_amt>500000 and invest_amt<=1000000 then \'50w-100w\'\n	else \'100w+\' end as invest_amt_range,\ncase when cnt<=20 then \'<20\'\n    when cnt>20 and cnt<=30 then \'20-30\'\n    when cnt>30 and cnt<=40 then \'30-40\'\n    when cnt>40 and cnt<=50 then \'40-50\'\n    when cnt>50 and cnt<=100 then \'50-100\'\n	when cnt>100 and cnt<=500 then \'100-500\'\n	else \'500+\' end as invest_cnt_range\nfrom (\nSELECT \n du.user_id,\n COALESCE(inv.invest_amt,0) as invest_amt,\n COALESCE(inv.cnt,0) as cnt\nFROM  (${V_SQL_PATTERN}) du \nLEFT OUTER JOIN \n(SELECT user_id, sum(invest_amt) as invest_amt,count(1) as cnt FROM idw.fact_nono_invest_order\nwhere invest_time<\'${V_END_DATE}\'\n GROUP BY user_id) inv \nON du.user_id = inv.user_id\nwhere \nstat_date=\'${V_STAT_DATE}\'\nand datediff(\'${V_STAT_DATE}\',last_invest_time)=90\nand (aum+balance_amt)<=50\n) tt',98,'invest_amt_range','invest_cnt_range','t3',NULL,3,'1','2016-12-16 15:35:15','2017-01-22 16:54:44','bofei','bofei','0','dt',NULL),
	(145,'流失用户_最后投资产品_累计留存时长','投资','诺诺_用户生命周期','DAILY','hive','select \n\'${V_STAT_DATE}\' as dt,\ninv.product_type,\ntt.user_id,\ndatediff(invest_time,register_time) as df,\ncase when datediff(invest_time,register_time)<=1 then \'1\'\n    when datediff(invest_time,register_time)>1 and datediff(invest_time,register_time)<=50 then \'2-50\'\n	when datediff(invest_time,register_time)>50 and datediff(invest_time,register_time)<=500 then \'50-500\'\n	else \'500+\' end as df_range\nfrom \n(${V_SQL_PATTERN}) tt \nleft join \n(SELECT user_id,CASE \nWHEN fio.invest_type_code = 1 THEN \'诺诺盈\' WHEN fio.invest_type_code = 2 THEN \'债转\' WHEN fio.invest_type_code = 4 THEN \'e诺千金\' \nWHEN fio.invest_type_code = 5 THEN \'活期\' ELSE dfp.category_name_02 END product_type,fio.invest_time,\nrow_number()over(partition by fio.user_id order by fio.invest_time desc) as n\nFROM idw.fact_nono_invest_order fio\nLEFT OUTER JOIN idw.dim_nono_product dfp ON fio.fp_key = dfp.fp_key\nwhere fio.invest_time<\'${V_END_DATE}\') inv \n on tt.user_id = inv.user_id\n and inv.n=1\nwhere   \nstat_date=\'${V_STAT_DATE}\'\nand datediff(\'${V_STAT_DATE}\',last_invest_time)=90\nand (aum+balance_amt)<=50',98,'product_type','df_range','',NULL,2,'1','2016-12-16 17:47:32','2017-01-10 09:46:35','bofei','bofei','0','dt',NULL),
	(146,'测试HIVE','注册','TESTING','DAILY','impala','SELECT now() AS DT,\'1\' AS T2 FROM default.dual',NULL,'t2',NULL,NULL,NULL,1,'1','2016-12-16 18:13:35','2016-12-16 18:39:38','bofei','bofei','2','dt',NULL),
	(149,'流失用户_累计留存时间','流失用户','诺诺_用户生命周期','DAILY','hive','select \nuser_id,\'${V_STAT_DATE}\' as dt,\'1\' as t2,\'1\' as t3,\ndatediff(invest_time,register_time) as df,\ncase when datediff(invest_time,register_time)<=1 then \'1\'\n    when datediff(invest_time,register_time)>1 and datediff(invest_time,register_time)<=50 then \'2-50\'\n	when datediff(invest_time,register_time)>50 and datediff(invest_time,register_time)<=500 then \'50-500\'\n	else \'500+\' end as df_range\nFROM ( ${V_SQL_PATTERN} ) tt\nwhere is_last_invest=1',95,'df_range','t2','t3',NULL,3,'0','2016-12-16 19:21:02','2016-12-22 15:34:44','bofei','admin','0','dt',NULL),
	(150,'诺诺投资次数f','投资','技术中心大屏f','10MIN','nono','select \n	hour(dt) the_hour,floor(extract(minute from dt)/10)*10+10 as the_mins,\n	dt\nfrom \n	(${V_SQL_PATTERN}) as a',9,'the_hour','the_mins',NULL,NULL,2,'1','2016-12-19 15:56:53','2016-12-22 18:45:52','bofei','admin','2','dt',NULL),
	(151,'诺诺提现次数f','投资','技术中心大屏f','10MIN','nono','select hour(dt) as the_hour,floor(extract(minute from dt)/10)*10+10 as the_mins,dt from (${V_SQL_PATTERN}) as a',13,'the_hour','the_mins',NULL,NULL,2,'1','2016-12-19 15:56:53','2016-12-22 18:45:52','bofei','admin','2','dt',NULL),
	(152,'诺诺充值次数f','投资','技术中心大屏f','10MIN','nono','select \n	hour(dt) the_hour,floor(extract(minute from dt)/10)*10+10 as the_mins,\n	dt\nfrom \n	(${V_SQL_PATTERN}) as a',67,'the_hour','the_mins',NULL,NULL,2,'1','2016-12-19 15:56:53','2016-12-22 18:45:52','bofei','admin','2','dt',NULL),
	(153,'财神投资次数f','投资','技术中心大屏f','10MIN','caishen','select \n	hour(dt) the_hour,floor(extract(minute from dt)/10)*10+10 as the_mins,\n	dt\nfrom \n	(${V_SQL_PATTERN}) as a',19,'the_hour','the_mins',NULL,NULL,2,'1','2016-12-19 15:56:53','2016-12-22 18:45:52','bofei','admin','2','dt',NULL),
	(154,'财神提现次数f','投资','技术中心大屏f','10MIN','caishen','select \n	hour(dt) the_hour,floor(extract(minute from dt)/10)*10+10 as the_mins,\n	dt\nfrom \n	(${V_SQL_PATTERN}) as a',20,'the_hour','the_mins',NULL,NULL,2,'1','2016-12-19 15:56:53','2016-12-22 18:45:52','bofei','admin','2','dt',NULL),
	(155,'财神充值次数f','投资','技术中心大屏f','10MIN','caishen','select \n	hour(dt) the_hour,floor(extract(minute from dt)/10)*10+10 as the_mins,\n	dt\nfrom \n	(${V_SQL_PATTERN}) as a',18,'the_hour','the_mins',NULL,NULL,2,'1','2016-12-19 15:56:53','2016-12-22 18:45:52','bofei','admin','2','dt',NULL),
	(156,'借款次数f','资产端','技术中心大屏f','10MIN','nono','select \n	hour(create_time) the_hour,floor(extract(minute from create_time)/10)*10+10 as the_mins,\n	create_time as dt\nfrom \n	(${V_SQL_PATTERN}) as a',89,'the_hour','the_mins',NULL,NULL,2,'1','2016-12-19 15:56:53','2016-12-22 18:45:52','bofei','admin','2','dt',NULL),
	(157,'诺诺注册人数f','注册','技术中心大屏f','10MIN','nono','select \n	hour(dt) the_hour,floor(extract(minute from dt)/10)*10+10 as the_mins,\n	dt\nfrom \n	(${V_SQL_PATTERN}) as a',116,'the_hour','the_mins',NULL,NULL,2,'1','2016-12-19 15:56:53','2017-01-09 18:38:18','bofei','bofei','2','dt',NULL),
	(158,'财神注册人数f','注册','技术中心大屏f','10MIN','caishen','select \n	hour(dt) the_hour,floor(extract(minute from dt)/10)*10+10 as the_mins,\n	dt\nfrom \n	(${V_SQL_PATTERN}) as a',15,'the_hour','the_mins',NULL,NULL,2,'0','2016-12-19 15:56:53','2017-01-09 18:37:34','bofei','bofei','2','dt',NULL),
	(159,'诺诺登录人数f','登录','技术中心大屏f','10MIN','nono','select \n	hour(dt) the_hour,floor(extract(minute from dt)/10)*10+10 as the_mins,\n	dt,\n	user_id\nfrom \n	(${V_SQL_PATTERN}) as a',14,'the_hour','the_mins',NULL,NULL,2,'0','2016-12-19 15:56:53','2017-10-24 09:13:51','bofei','bofei','2','dt',NULL),
	(160,'财神登录人数f','登录','技术中心大屏f','10MIN','caishen','select \n	hour(dt) the_hour,floor(extract(minute from dt)/10)*10+10 as the_mins,\n	dt,\n	user_code\nfrom \n	(${V_SQL_PATTERN}) as a',68,'the_hour','the_mins',NULL,NULL,2,'1','2016-12-19 15:56:53','2016-12-22 18:45:52','bofei','admin','2','dt',NULL),
	(165,'交易记录f','交易','技术中心大屏f','10MIN','nono','select \n	hour(dt) the_hour,floor(extract(minute from dt)/10)*10+10 as the_mins,\n	dt\nfrom \n	(${V_SQL_PATTERN}) as a',96,'the_hour','the_mins',NULL,NULL,2,'1','2016-12-20 11:08:03','2017-01-05 19:09:10','admin',NULL,'2','dt',NULL),
	(166,'AUM_渠道人数分布','AUM','诺诺_用户生命周期','DAILY','impala','SELECT \n STAT_DATE as dt,\n user_id,stat_date,channel,\nprovince,gender,age_range,aum,aum_range,\nexpect_range,product_type\nFROM ( ${V_SQL_PATTERN} ) tt',97,'channel',NULL,NULL,NULL,1,'1','2016-12-20 18:43:52','2017-01-10 09:46:35','admin','bofei','0','dt',NULL),
	(167,'AUM_地域人数分布','AUM','诺诺_用户生命周期','DAILY','impala','select dt,\n(case when row_number()over(partition by dt order by cnt desc ) <=5 then province else \'其它\' end ) as province,\ncnt \nfrom (\nSELECT \n STAT_DATE as dt,\nprovince,\ncount(distinct user_id) as cnt,\nsum(aum) as aum\nFROM ( ${V_SQL_PATTERN} ) tt\nwhere stat_date=\'${V_BEGIN_DATE}\'\nGROUP BY STAT_DATE,province) t',97,'province',NULL,NULL,NULL,1,'1','2016-12-20 18:52:55','2017-01-10 09:46:35','admin','bofei','0','dt',NULL),
	(168,'AUM_性别人数分布','AUM','诺诺_用户生命周期','DAILY','impala','SELECT \n STAT_DATE as dt,\n user_id,stat_date,channel,\nprovince,gender,age_range,aum,aum_range,\nexpect_range,product_type\nFROM ( ${V_SQL_PATTERN} ) tt',97,'gender',NULL,NULL,NULL,1,'1','2016-12-20 18:52:55','2017-01-10 09:46:35','admin','bofei','0','dt',NULL),
	(169,'AUM_年龄人数分布','AUM','诺诺_用户生命周期','DAILY','impala','SELECT \n STAT_DATE as dt,\n user_id,stat_date,channel,\nprovince,gender,age_range,aum,aum_range,\nexpect_range,product_type\nFROM ( ${V_SQL_PATTERN} ) tt',97,'age_range',NULL,NULL,NULL,1,'1','2016-12-20 18:52:55','2017-01-10 09:46:35','admin','bofei','0','dt',NULL),
	(174,'AUM_在投金额人数分布','AUM','诺诺_用户生命周期','DAILY','impala','select dt,aum,\n	user_id,\n	case\n    when aum <= 1000\n    then \'1-1000\'\n    when AUM <= 5000\n    then \'1001-5000\'\n    when AUM <= 10000\n    then \'5001-10000\'\n    when AUM <= 50000\n    then \'10001-50000\'\n    else \'50000+\'\n  end aum_range\n  from (\n	SELECT \n STAT_DATE as dt,\n user_id,sum(aum) as aum\nFROM ( ${V_SQL_PATTERN} ) tt\ngroup by stat_date,user_id) ta\n',97,'aum_range',NULL,NULL,NULL,1,'1','2016-12-20 18:59:05','2016-12-27 14:19:53','admin','bofei','0','dt',NULL),
	(175,'AUM_产品人数分布','AUM','诺诺_用户生命周期','DAILY','impala','SELECT \n STAT_DATE as dt,\n user_id,stat_date,channel,\nprovince,gender,age_range,aum,aum_range,\nexpect_range,product_type\nFROM ( ${V_SQL_PATTERN} ) tt',97,'product_type',NULL,NULL,NULL,1,'1','2016-12-20 19:02:19','2017-01-10 09:46:35','admin','bofei','0','dt',NULL),
	(176,'AUM_期限人数分布','AUM','诺诺_用户生命周期','DAILY','impala','SELECT \n STAT_DATE as dt,\n user_id,stat_date,channel,\nprovince,gender,age_range,aum,aum_range,\nexpect_range,product_type\nFROM ( ${V_SQL_PATTERN} ) tt',97,'expect_range',NULL,NULL,NULL,1,'1','2016-12-20 19:02:19','2017-01-10 09:46:35','admin','bofei','0','dt',NULL),
	(178,'留存_老客本月在投','在投','诺诺_用户生命周期','DAILY','hive','select \naum.aum as amt\n,usr.user_id\n,dat.month_short_desc m\n,dat.week_of_year2\n,\'${V_BEGIN_DATE}\' dt\nfrom rpt.v_dim_date dat \njoin rpt.v_nono_aum aum on aum.stat_date = dat.day_short_desc \njoin rpt.v_nono_user usr on aum.user_id = usr.user_id\nwhere usr.is_new_user = 0\nand day(day_short_desc) = 15',NULL,'m',NULL,NULL,NULL,1,'0','2016-12-21 11:14:18','2017-01-10 09:46:35',NULL,'bofei','0','dt',NULL),
	(181,'留存_老客去年在投','在投','诺诺_用户生命周期','DAILY','hive','select \naum.aum as amt\n,usr.user_id\n,dat.month_short_desc m\n,dat.week_of_year2\n,\'${V_BEGIN_DATE}\' dt\nfrom v_dim_date dat \njoin v_nono_aum aum on aum.stat_date = dat.day_short_desc \njoin v_nono_user usr on aum.user_id = usr.user_id\nwhere usr.is_new_user = 0\nand day_short_desc = \'2016-12-09\'',NULL,'m',NULL,NULL,NULL,1,'0','2016-12-21 14:20:51','2017-01-10 09:46:35',NULL,'bofei','0','dt',NULL),
	(182,'首投_产品分布','首投','诺诺_用户生命周期','DAILY','hive','select \n  invest_date as dt,\n  product_type,\n  province,\n  invest_amt_range,\n  age_range,\n  expect_range,\n  channel,\n  gender,\n  use_coupon_flag,\n  user_id\nfrom rpt.v_nono_invest \nwhere is_fst_invest = 1',NULL,'product_type',NULL,NULL,NULL,1,'0','2016-12-21 14:54:12','2016-12-22 10:25:01','liuhailiang','bofei','0','dt',NULL),
	(183,'首投_地域分布','首投','诺诺_用户生命周期','DAILY','hive','select \n  invest_date as dt,\n  product_type,\n  province,\n  invest_amt_range,\n  age_range,\n  expect_range,\n  channel,\n  gender,\n  use_coupon_flag,\n  user_id\nfrom rpt.v_nono_invest \nwhere is_fst_invest = 1',NULL,'province',NULL,NULL,NULL,1,'0','2016-12-21 14:54:12','2016-12-22 10:25:01','liuhailiang','bofei','0','dt',NULL),
	(184,'首投_金额分布','首投','诺诺_用户生命周期','DAILY','hive','select \n  invest_date as dt,\n  product_type,\n  province,\n  invest_amt_range,\n  age_range,\n  expect_range,\n  channel,\n  gender,\n  use_coupon_flag,\n  user_id\nfrom rpt.v_nono_invest \nwhere is_fst_invest = 1',NULL,'invest_amt_range',NULL,NULL,NULL,1,'0','2016-12-21 14:54:12','2016-12-22 16:55:07','liuhailiang',NULL,'0','dt',NULL),
	(185,'首投_年龄分布','首投','诺诺_用户生命周期','DAILY','hive','select \n  invest_date as dt,\n  product_type,\n  province,\n  invest_amt_range,\n  age_range,\n  expect_range,\n  channel,\n  gender,\n  use_coupon_flag,\n  user_id\nfrom rpt.v_nono_invest \nwhere is_fst_invest = 1',NULL,'age_range',NULL,NULL,NULL,1,'0','2016-12-21 14:54:12','2016-12-22 10:25:01','liuhailiang','bofei','0','dt',NULL),
	(186,'首投_期限分布','首投','诺诺_用户生命周期','DAILY','hive','select \n  invest_date as dt,\n  product_type,\n  province,\n  invest_amt_range,\n  age_range,\n  expect_range,\n  channel,\n  gender,\n  use_coupon_flag,\n  user_id\nfrom rpt.v_nono_invest \nwhere is_fst_invest = 1',NULL,'expect_range',NULL,NULL,NULL,1,'0','2016-12-21 14:57:48','2016-12-22 10:25:01','liuhailiang','bofei','0','dt',NULL),
	(187,'首投_渠道分布','首投','诺诺_用户生命周期','DAILY','hive','select \n  invest_date as dt,\n  product_type,\n  province,\n  invest_amt_range,\n  age_range,\n  expect_range,\n  channel,\n  gender,\n  use_coupon_flag,\n  user_id\nfrom rpt.v_nono_invest \nwhere is_fst_invest = 1',NULL,'channel',NULL,NULL,NULL,1,'0','2016-12-21 14:57:48','2016-12-22 10:25:01','liuhailiang','bofei','0','dt',NULL),
	(188,'首投_性别分布','首投','诺诺_用户生命周期','DAILY','hive','select \n  invest_date as dt,\n  product_type,\n  province,\n  invest_amt_range,\n  age_range,\n  expect_range,\n  channel,\n  gender,\n  use_coupon_flag,\n  user_id\nfrom rpt.v_nono_invest \nwhere is_fst_invest = 1',NULL,'gender',NULL,NULL,NULL,1,'0','2016-12-21 14:57:48','2016-12-22 10:25:01','liuhailiang','bofei','0','dt',NULL),
	(189,'首投_用券分布','首投','诺诺_用户生命周期','DAILY','hive','select \n  invest_date as dt,\n  product_type,\n  province,\n  invest_amt_range,\n  age_range,\n  expect_range,\n  channel,\n  gender,\n  use_coupon_flag,\n  user_id\nfrom rpt.v_nono_invest \nwhere is_fst_invest = 1',NULL,'use_coupon_flag',NULL,NULL,NULL,1,'0','2016-12-21 14:57:48','2016-12-22 10:25:01','liuhailiang','bofei','0','dt',NULL),
	(193,'复投_产品分布','复投','诺诺_用户生命周期','DAILY','hive','select \n  invest_date as dt,\n  product_type,\n  province,\n  invest_amt_range,\n  age_range,\n  expect_range,\n  channel,\n  gender,\n  use_coupon_flag,\n  user_id\nfrom rpt.v_nono_invest \nwhere is_sec_invest = 1',NULL,'product_type',NULL,NULL,NULL,1,'0','2016-12-21 15:07:27','2016-12-22 10:25:01','SYS','bofei','0','dt',NULL),
	(194,'复投_地域分布','复投','诺诺_用户生命周期','DAILY','hive','select \n  invest_date as dt,\n  product_type,\n  province,\n  invest_amt_range,\n  age_range,\n  expect_range,\n  channel,\n  gender,\n  use_coupon_flag,\n  user_id\nfrom rpt.v_nono_invest \nwhere is_sec_invest = 1',NULL,'province',NULL,NULL,NULL,1,'0','2016-12-21 15:07:27','2016-12-22 10:25:01','SYS','bofei','0','dt',NULL),
	(195,'复投_金额分布','复投','诺诺_用户生命周期','DAILY','hive','select \n  invest_date as dt,\n  product_type,\n  province,\n  invest_amt_range,\n  age_range,\n  expect_range,\n  channel,\n  gender,\n  use_coupon_flag,\n  user_id\nfrom rpt.v_nono_invest \nwhere is_sec_invest = 1',NULL,'invest_amt_range',NULL,NULL,NULL,1,'0','2016-12-21 15:07:27','2016-12-22 10:25:01','SYS','bofei','0','dt',NULL),
	(196,'复投_年龄分布','复投','诺诺_用户生命周期','DAILY','hive','select \n  invest_date as dt,\n  product_type,\n  province,\n  invest_amt_range,\n  age_range,\n  expect_range,\n  channel,\n  gender,\n  use_coupon_flag,\n  user_id\nfrom rpt.v_nono_invest \nwhere is_sec_invest = 1',NULL,'age_range',NULL,NULL,NULL,1,'0','2016-12-21 15:07:27','2016-12-22 10:25:01','SYS','bofei','0','dt',NULL),
	(197,'复投_期限分布','复投','诺诺_用户生命周期','DAILY','hive','select \n  invest_date as dt,\n  product_type,\n  province,\n  invest_amt_range,\n  age_range,\n  expect_range,\n  channel,\n  gender,\n  use_coupon_flag,\n  user_id\nfrom rpt.v_nono_invest \nwhere is_sec_invest = 1',NULL,'expect_range',NULL,NULL,NULL,1,'0','2016-12-21 15:07:27','2016-12-22 10:25:01','SYS','bofei','0','dt',NULL),
	(198,'复投_渠道分布','复投','诺诺_用户生命周期','DAILY','hive','select \n  invest_date as dt,\n  product_type,\n  province,\n  invest_amt_range,\n  age_range,\n  expect_range,\n  channel,\n  gender,\n  use_coupon_flag,\n  user_id\nfrom rpt.v_nono_invest \nwhere is_sec_invest = 1',NULL,'channel',NULL,NULL,NULL,1,'0','2016-12-21 15:07:27','2016-12-22 10:25:01','SYS','bofei','0','dt',NULL),
	(199,'复投_性别分布','复投','诺诺_用户生命周期','DAILY','hive','select \n  invest_date as dt,\n  product_type,\n  province,\n  invest_amt_range,\n  age_range,\n  expect_range,\n  channel,\n  gender,\n  use_coupon_flag,\n  user_id\nfrom rpt.v_nono_invest \nwhere is_sec_invest = 1',NULL,'gender',NULL,NULL,NULL,1,'0','2016-12-21 15:07:27','2016-12-22 10:25:01','SYS','bofei','0','dt',NULL),
	(200,'复投_用券分布','复投','诺诺_用户生命周期','DAILY','hive','select \n  invest_date as dt,\n  product_type,\n  province,\n  invest_amt_range,\n  age_range,\n  expect_range,\n  channel,\n  gender,\n  use_coupon_flag,\n  user_id\nfrom rpt.v_nono_invest \nwhere is_sec_invest = 1',NULL,'use_coupon_flag',NULL,NULL,NULL,1,'0','2016-12-21 15:07:27','2016-12-22 10:25:01','SYS','bofei','0','dt',NULL),
	(208,'首投_转化率','首投','诺诺_用户生命周期','DAILY','hive','select\n  \'${V_STAT_DATE}\' as dt,\n  t1.register_date,\n  t1.user_id,\n  t2.d0,\n  t2.d3,\n  t2.d7,\n  t2.d30,\n  t2.dx\nfrom rpt.v_nono_user t1\nleft join (\n  select\n   user_id,\n   case\n     when register_interval = 0\n     then 1\n     else 0\n   end d0,\n   case\n     when register_interval <= 3\n     then 1\n     else 0\n   end d3,\n   case\n     when register_interval <= 7\n     then 1\n     else 0\n   end d7,\n   case\n     when register_interval <= 30\n     then 1\n     else 0\n   end d30,\n   case\n     when register_interval > 30\n     then 1\n     else 0\n   end dx\nfrom rpt.v_nono_invest\nwhere is_fst_invest = 1\n) t2\non t1.user_id = t2.user_id\nwhere t1.register_date >= date_sub(\'${V_END_DATE}\',30)\nand t1.register_date < \'${V_END_DATE}\'',NULL,'register_date',NULL,NULL,NULL,1,'0','2016-12-21 16:47:42','2016-12-22 10:25:01','liuhailiang','bofei','0','dt',NULL),
	(209,'复投_转化率','复投 ','诺诺_用户生命周期','DAILY','hive','select\n  \'${V_STAT_DATE}\'                as dt,\n  substr(t1.first_invest_time,1,10) as fst_invest_date,\n  t1.user_id,\n  t2.d0,\n  t2.d3,\n  t2.d7,\n  t2.d30,\n  t2.dx\nfrom rpt.v_nono_user t1\nleft join (\n  select\n   user_id,\n   case\n     when fst_invest_interval = 0\n     then 1\n     else 0\n   end d0,\n   case\n     when fst_invest_interval <= 3\n     then 1\n     else 0\n   end d3,\n   case\n     when fst_invest_interval <= 7\n     then 1\n     else 0\n   end d7,\n   case\n     when fst_invest_interval <= 30\n     then 1\n     else 0\n   end d30,\n   case\n     when fst_invest_interval > 30\n     then 1\n     else 0\n   end dx\nfrom rpt.v_nono_invest\nwhere is_sec_invest = 1\n) t2\non t1.user_id = t2.user_id\nwhere t1.first_invest_time is not null\nand t1.first_invest_time >= date_sub(\'${V_END_DATE}\',30)\nand t1.first_invest_time < \'${V_END_DATE}\'',NULL,'fst_invest_date',NULL,NULL,NULL,1,'0','2016-12-21 17:14:32','2016-12-22 10:25:01','liuhailiang','bofei','0','dt',NULL),
	(210,'概览_年度累计首投人数','概览','诺诺_用户生命周期','DAILY','hive','select \n  invest_date as dt, \n  user_id\nfrom rpt.v_nono_invest\nwhere is_fst_invest = 1\nand invest_date >= concat(year(date_sub(current_date(),1)),\'-01-01\')',NULL,NULL,NULL,NULL,NULL,0,'1','2016-12-21 19:05:08','2017-01-10 09:46:35','liuhailiang','bofei','1','dt',NULL),
	(211,'首投_产品分布_impala','首投_impala','诺诺_用户生命周期','DAILY','impala','select \n  invest_date as dt,\n  product_type,\n  province,\n  invest_amt_range,\n  age_range,\n  expect_range,\n  channel,\n  gender,\n  use_coupon_flag,\n  user_id\nfrom rpt.v_nono_invest \nwhere is_fst_invest = 1',NULL,'product_type',NULL,NULL,NULL,1,'1','2016-12-22 10:19:47','2017-01-10 09:46:35','SYS','bofei','0','dt',NULL),
	(212,'首投_地域分布_impala','首投_impala','诺诺_用户生命周期','DAILY','impala','select \n  invest_date as dt,\n  product_type,\n  province,\n  invest_amt_range,\n  age_range,\n  expect_range,\n  channel,\n  gender,\n  use_coupon_flag,\n  user_id\nfrom rpt.v_nono_invest \nwhere is_fst_invest = 1',NULL,'province',NULL,NULL,NULL,1,'1','2016-12-22 10:19:47','2017-01-10 09:46:35','SYS','bofei','0','dt',NULL),
	(213,'首投_金额分布_impala','首投_impala','诺诺_用户生命周期','DAILY','impala','select \n  invest_date as dt,\n  product_type,\n  province,\n  invest_amt_range,\n  age_range,\n  expect_range,\n  channel,\n  gender,\n  use_coupon_flag,\n  user_id\nfrom rpt.v_nono_invest \nwhere is_fst_invest = 1',NULL,'invest_amt_range',NULL,NULL,NULL,1,'1','2016-12-22 10:19:47','2017-01-10 09:46:35','SYS','bofei','0','dt',NULL),
	(214,'首投_年龄分布_impala','首投_impala','诺诺_用户生命周期','DAILY','impala','select \n  invest_date as dt,\n  product_type,\n  province,\n  invest_amt_range,\n  age_range,\n  expect_range,\n  channel,\n  gender,\n  use_coupon_flag,\n  user_id\nfrom rpt.v_nono_invest \nwhere is_fst_invest = 1',NULL,'age_range',NULL,NULL,NULL,1,'1','2016-12-22 10:19:47','2017-01-10 09:46:35','SYS','bofei','0','dt',NULL),
	(215,'首投_期限分布_impala','首投_impala','诺诺_用户生命周期','DAILY','impala','select \n  invest_date as dt,\n  product_type,\n  province,\n  invest_amt_range,\n  age_range,\n  expect_range,\n  channel,\n  gender,\n  use_coupon_flag,\n  user_id\nfrom rpt.v_nono_invest \nwhere is_fst_invest = 1',NULL,'expect_range',NULL,NULL,NULL,1,'1','2016-12-22 10:19:47','2017-01-10 09:46:35','SYS','bofei','0','dt',NULL),
	(216,'首投_渠道分布_impala','首投_impala','诺诺_用户生命周期','DAILY','impala','select \n  invest_date as dt,\n  product_type,\n  province,\n  invest_amt_range,\n  age_range,\n  expect_range,\n  channel,\n  gender,\n  use_coupon_flag,\n  user_id\nfrom rpt.v_nono_invest \nwhere is_fst_invest = 1',NULL,'channel',NULL,NULL,NULL,1,'1','2016-12-22 10:19:47','2017-01-10 09:46:35','SYS','bofei','0','dt',NULL),
	(217,'首投_性别分布_impala','首投_impala','诺诺_用户生命周期','DAILY','impala','select \n  invest_date as dt,\n  product_type,\n  province,\n  invest_amt_range,\n  age_range,\n  expect_range,\n  channel,\n  gender,\n  use_coupon_flag,\n  user_id\nfrom rpt.v_nono_invest \nwhere is_fst_invest = 1',NULL,'gender',NULL,NULL,NULL,1,'1','2016-12-22 10:19:47','2017-01-10 09:46:35','SYS','bofei','0','dt',NULL),
	(218,'首投_用券分布_impala','首投_impala','诺诺_用户生命周期','DAILY','impala','select \n  invest_date as dt,\n  product_type,\n  province,\n  invest_amt_range,\n  age_range,\n  expect_range,\n  channel,\n  gender,\n  use_coupon_flag,\n  user_id\nfrom rpt.v_nono_invest \nwhere is_fst_invest = 1',NULL,'use_coupon_flag',NULL,NULL,NULL,1,'1','2016-12-22 10:19:47','2017-01-10 09:46:35','SYS','bofei','0','dt',NULL),
	(219,'复投_产品分布_impala','复投_impala','诺诺_用户生命周期','DAILY','impala','select \n  invest_date as dt,\n  product_type,\n  province,\n  invest_amt_range,\n  age_range,\n  expect_range,\n  channel,\n  gender,\n  use_coupon_flag,\n  user_id\nfrom rpt.v_nono_invest \nwhere is_sec_invest = 1',NULL,'product_type',NULL,NULL,NULL,1,'1','2016-12-22 10:19:47','2017-01-10 09:46:35','SYS','bofei','0','dt',NULL),
	(220,'复投_地域分布_impala','复投_impala','诺诺_用户生命周期','DAILY','impala','select \n  invest_date as dt,\n  product_type,\n  province,\n  invest_amt_range,\n  age_range,\n  expect_range,\n  channel,\n  gender,\n  use_coupon_flag,\n  user_id\nfrom rpt.v_nono_invest \nwhere is_sec_invest = 1',NULL,'province',NULL,NULL,NULL,1,'1','2016-12-22 10:19:47','2017-01-10 09:46:35','SYS','bofei','0','dt',NULL),
	(221,'复投_金额分布_impala','复投_impala','诺诺_用户生命周期','DAILY','impala','select \n  invest_date as dt,\n  product_type,\n  province,\n  invest_amt_range,\n  age_range,\n  expect_range,\n  channel,\n  gender,\n  use_coupon_flag,\n  user_id\nfrom rpt.v_nono_invest \nwhere is_sec_invest = 1',NULL,'invest_amt_range',NULL,NULL,NULL,1,'1','2016-12-22 10:19:47','2017-01-10 09:46:35','SYS','bofei','0','dt',NULL),
	(222,'复投_年龄分布_impala','复投_impala','诺诺_用户生命周期','DAILY','impala','select \n  invest_date as dt,\n  product_type,\n  province,\n  invest_amt_range,\n  age_range,\n  expect_range,\n  channel,\n  gender,\n  use_coupon_flag,\n  user_id\nfrom rpt.v_nono_invest \nwhere is_sec_invest = 1',NULL,'age_range',NULL,NULL,NULL,1,'1','2016-12-22 10:19:47','2017-01-10 09:46:35','SYS','bofei','0','dt',NULL),
	(223,'复投_期限分布_impala','复投_impala','诺诺_用户生命周期','DAILY','impala','select \n  invest_date as dt,\n  product_type,\n  province,\n  invest_amt_range,\n  age_range,\n  expect_range,\n  channel,\n  gender,\n  use_coupon_flag,\n  user_id\nfrom rpt.v_nono_invest \nwhere is_sec_invest = 1',NULL,'expect_range',NULL,NULL,NULL,1,'1','2016-12-22 10:19:47','2017-01-10 09:46:35','SYS','bofei','0','dt',NULL),
	(224,'复投_渠道分布_impala','复投_impala','诺诺_用户生命周期','DAILY','impala','select \n  invest_date as dt,\n  product_type,\n  province,\n  invest_amt_range,\n  age_range,\n  expect_range,\n  channel,\n  gender,\n  use_coupon_flag,\n  user_id\nfrom rpt.v_nono_invest \nwhere is_sec_invest = 1',NULL,'channel',NULL,NULL,NULL,1,'1','2016-12-22 10:19:47','2017-01-10 09:46:35','SYS','bofei','0','dt',NULL),
	(225,'复投_性别分布_impala','复投_impala','诺诺_用户生命周期','DAILY','impala','select \n  invest_date as dt,\n  product_type,\n  province,\n  invest_amt_range,\n  age_range,\n  expect_range,\n  channel,\n  gender,\n  use_coupon_flag,\n  user_id\nfrom rpt.v_nono_invest \nwhere is_sec_invest = 1',NULL,'gender',NULL,NULL,NULL,1,'1','2016-12-22 10:19:47','2017-01-10 09:46:35','SYS','bofei','0','dt',NULL),
	(226,'复投_用券分布_impala','复投_impala','诺诺_用户生命周期','DAILY','impala','select \n  invest_date as dt,\n  product_type,\n  province,\n  invest_amt_range,\n  age_range,\n  expect_range,\n  channel,\n  gender,\n  use_coupon_flag,\n  user_id\nfrom rpt.v_nono_invest \nwhere is_sec_invest = 1',NULL,'use_coupon_flag',NULL,NULL,NULL,1,'1','2016-12-22 10:19:47','2017-01-10 09:46:35','SYS','bofei','0','dt',NULL),
	(227,'首投_转化率_impala','首投_impala','诺诺_用户生命周期','DAILY','impala','select\n  \'${V_STAT_DATE}\' as dt,\n  t1.register_date,\n  t1.user_id,\n  t2.d0,\n  t2.d3,\n  t2.d7,\n  t2.d30,\n  t2.dx\nfrom rpt.v_nono_user t1\nleft join (\n  select\n   user_id,\n   case\n     when register_interval = 0\n     then 1\n     else 0\n   end d0,\n   case\n     when register_interval <= 3\n     then 1\n     else 0\n   end d3,\n   case\n     when register_interval <= 7\n     then 1\n     else 0\n   end d7,\n   case\n     when register_interval <= 30\n     then 1\n     else 0\n   end d30,\n   case\n     when register_interval > 30\n     then 1\n     else 0\n   end dx\nfrom rpt.v_nono_invest\nwhere is_fst_invest = 1\n) t2\non t1.user_id = t2.user_id\nwhere t1.register_date >= date_sub(\'${V_END_DATE}\',30)\nand t1.register_date < \'${V_END_DATE}\'',NULL,'register_date',NULL,NULL,NULL,1,'1','2016-12-22 10:19:47','2017-01-10 09:46:35','SYS','bofei','0','dt',NULL),
	(228,'复投_转化率_impala','复投_impala','诺诺_用户生命周期','DAILY','impala','select\n  \'${V_STAT_DATE}\'                as dt,\n  substr(t1.first_invest_time,1,10) as fst_invest_date,\n  t1.user_id,\n  t2.d0,\n  t2.d3,\n  t2.d7,\n  t2.d30,\n  t2.dx\nfrom rpt.v_nono_user t1\nleft join (\n  select\n   user_id,\n   case\n     when fst_invest_interval = 0\n     then 1\n     else 0\n   end d0,\n   case\n     when fst_invest_interval <= 3\n     then 1\n     else 0\n   end d3,\n   case\n     when fst_invest_interval <= 7\n     then 1\n     else 0\n   end d7,\n   case\n     when fst_invest_interval <= 30\n     then 1\n     else 0\n   end d30,\n   case\n     when fst_invest_interval > 30\n     then 1\n     else 0\n   end dx\nfrom rpt.v_nono_invest\nwhere is_sec_invest = 1\n) t2\non t1.user_id = t2.user_id\nwhere t1.first_invest_time is not null\nand t1.first_invest_time >= date_sub(\'${V_END_DATE}\',30)\nand t1.first_invest_time < \'${V_END_DATE}\'',NULL,'fst_invest_date',NULL,NULL,NULL,1,'1','2016-12-22 10:19:47','2017-01-10 09:46:35','SYS','bofei','0','dt',NULL),
	(246,'诺诺PVf','PV','技术中心大屏f','30MIN','impala','select \nrun_time as dt,\nsubstr(run_time,12,2) as the_hour\nfrom ( ${V_SQL_PATTERN} ) ta\nwhere run_time <=now()',99,'the_hour',NULL,NULL,NULL,1,'1','2016-12-22 18:29:41','2016-12-26 18:51:43','admin','bofei','2','dt',NULL),
	(247,'定期在投_净入金','交易','财神大屏_S','HOURLY','caishen','select \'${V_STAT_DATE}\' as dt,hour(now()) as hh, invest_amt,d_invest_amt,in_invest_amt,out_invest_amt from (${V_SQL_PATTERN} ) tx',61,NULL,NULL,NULL,NULL,0,'1','2016-12-29 10:57:12','2016-12-29 14:17:31','bofei','bofei','2','dt',NULL),
	(248,'活期在投_净入金','交易','财神大屏_S','HOURLY','caishen','select \'${V_STAT_DATE}\' as dt,hour(now()) as hh, invest_amt,d_invest_amt,in_invest_amt,out_invest_amt from (${V_SQL_PATTERN} ) tx',62,NULL,NULL,NULL,NULL,0,'1','2016-12-29 10:59:34','2016-12-29 14:12:27','bofei','bofei','2','dt',NULL),
	(249,'开心财神在投_净入金','交易','财神大屏_S','HOURLY','caishen','SELECT \'${V_STAT_DATE}\' AS DT,hour(now()) as hh, INVEST_AMT,D_INVEST_AMT,in_invest_amt,out_invest_amt FROM (${V_SQL_PATTERN} ) TX ',60,NULL,NULL,NULL,NULL,0,'1','2016-12-29 11:10:58','2016-12-29 14:12:27','bofei','bofei','2','dt',NULL),
	(250,'财神交易_人数','交易','财神大屏_S','HOURLY','caishen','SELECT \'${V_STAT_DATE}\' AS DT,hour(now()) as hh, user_code FROM (${V_SQL_PATTERN} ) TX ',100,NULL,NULL,NULL,NULL,0,'1','2016-12-29 11:52:30','2016-12-30 11:29:55','bofei','bofei','2',' dt',NULL),
	(251,'帐户余额','财神','财神大屏_S','HOURLY','caishen','SELECT \'${V_STAT_DATE}\' AS DT,amount FROM (${V_SQL_PATTERN} ) TX ',101,NULL,NULL,NULL,NULL,0,'1','2016-12-29 16:38:47','2016-12-29 16:38:47','bofei','bofei','2','dt',NULL),
	(252,'定期_投资金额','交易','财神大屏_S','HOURLY','caishen','SELECT \n DT_BEGIN as dt,\n product_name,\n inv_amt\nFROM ( ${V_SQL_PATTERN} ) tt\nwhere  \'${V_END_DATE}\'>=DT_BEGIN\nAND \'${V_BEGIN_DATE}\'<DT_END',65,'product_name',NULL,NULL,NULL,1,'1','2016-12-29 17:36:38','2016-12-29 18:38:25','bofei','bofei','2','dt',NULL),
	(255,'活期提现','交易','财神大屏_S','HOURLY','caishen','SELECT \n create_date as dt,\n product_name,\n withdraw_amount\nFROM ( ${V_SQL_PATTERN} ) tt',102,NULL,NULL,NULL,NULL,0,'1','2016-12-29 19:30:48','2016-12-29 19:30:48','bofei','bofei','2','dt',NULL),
	(256,'活转定','交易','财神大屏_S','HOURLY','caishen','SELECT \n created_date as dt,\n product_name,\n invest_amount\nFROM ( ${V_SQL_PATTERN} ) tt',103,NULL,NULL,NULL,NULL,0,'1','2016-12-29 19:30:48','2016-12-29 19:30:48','bofei','bofei','2','dt',NULL),
	(257,'授信人数','白领','白领版日报','DAILY','impala','select to_date(log_time) as dt, \'进行授信\' as op_type from  ods.log_app_text where platform_id in (16,17) and page_name=\'credit_assessment\'\nand title =\'confirm\'\nunion all\nselect to_date(log_time) as dt, \'进件\' as op_type from  ods.log_app_text where platform_id in (16,17) and page_name=\'borrow_inf\'\nand title =\'confirm\'\nunion all\nselect to_date(log_time) as dt, \'当期进行授信\' as op_type from ods.log_app_text where platform_id in (16,17) and page_name=\'credit_assessment\'\nand title =\'confirm\'\nand to_date(log_time)=\'${V_STAT_DATE}\'\nand user_id in\n(select id from ods.t_user_info_hist where to_date(register_time)=\'${V_STAT_DATE}\')',NULL,'op_type',NULL,NULL,NULL,1,'1','2016-12-30 10:42:47','2017-02-16 16:46:20','bofei','wangzukun','0','dt',NULL),
	(258,'首投_复投_金额','首投','财神大屏_S','HOURLY','caishen','SELECT \n dt,\n rank,\n inv_amt\nFROM ( ${V_SQL_PATTERN} ) tt',104,'rank',NULL,NULL,NULL,1,'1','2016-12-30 14:16:01','2016-12-30 14:16:01','bofei','bofei','2','dt',NULL),
	(259,'定期_分时_投资金额','交易','财神大屏_S','HOURLY','caishen','SELECT \n DT_BEGIN as dt,\n hour(dt_begin) as hh,\n product_name,\n inv_amt\nFROM ( ${V_SQL_PATTERN} ) tt\nwhere  \'${V_END_DATE}\'>=DT_BEGIN\nAND \'${V_BEGIN_DATE}\'<DT_END',65,'hh','product_name',NULL,NULL,2,'1','2016-12-30 16:49:22','2016-12-30 16:49:22','bofei','bofei','2','dt',NULL),
	(260,'分时_活期提现','交易','财神大屏_S','HOURLY','caishen','SELECT \n create_date as dt,\n hour(create_date) as hh,\n product_name,\n withdraw_amount as invest_amt\nFROM ( ${V_SQL_PATTERN} ) tt',102,'hh',NULL,NULL,NULL,1,'1','2016-12-30 17:39:17','2016-12-30 17:39:17','bofei','bofei','2','dt',NULL),
	(261,'分时_活转定','交易','财神大屏_S','HOURLY','caishen','SELECT \n created_date as dt,\n hour(created_date) as hh,\n product_name,\n invest_amount as invest_amt\nFROM ( ${V_SQL_PATTERN} ) tt',103,'hh',NULL,NULL,NULL,1,'1','2016-12-30 17:39:17','2016-12-30 17:40:11','bofei','bofei','2','dt',NULL),
	(262,'卡券_人数_金额_抵扣券','交易','财神大屏_S','HOURLY','caishen','SELECT \n dt,\n user_code,welfare_type,\n invest_amount\nFROM ( ${V_SQL_PATTERN} ) tt',105,'welfare_type',NULL,NULL,NULL,1,'0','2017-01-03 17:28:52','2017-01-04 16:10:42','bofei','bofei','2','dt',NULL),
	(263,'卡券_人数_金额_特权本金','交易','财神大屏_S','HOURLY','caishen','SELECT \n dt,\n user_code,welfare_type,\n invest_amount\nFROM ( ${V_SQL_PATTERN} ) tt',106,'welfare_type',NULL,NULL,NULL,1,'0','2017-01-04 11:54:41','2017-01-04 16:10:42','bofei','bofei','2','dt',NULL),
	(264,'卡券_人数_金额_加息券','交易','财神大屏_S','HOURLY','caishen','SELECT \n dt,\n user_code,welfare_type,\n invest_amount\nFROM ( ${V_SQL_PATTERN} ) tt',107,'welfare_type',NULL,NULL,NULL,1,'0','2017-01-04 15:07:12','2017-01-04 16:10:42','bofei','bofei','2','dt',NULL),
	(265,'卡券','交易','财神大屏_S','HOURLY','caishen','SELECT \n dt,\n COALESCE(welfare_type,\'总计\') as welfare_type,\n count(distinct user_code) as user_cnt\n sum(invest_amount) as invest_amount\nFROM ( ${V_SQL_PATTERN} ) tt\ngroup by with rollup dt,welfare_type',108,'welfare_type',NULL,NULL,NULL,1,'0','2017-01-04 15:37:09','2017-01-04 16:10:42','bofei','bofei','2','dt',NULL),
	(268,'卡券_人数_金额','交易','财神大屏_S','HOURLY','caishen','SELECT \n \'${V_BEGIN_DATE}\' as dt,\n COALESCE(welfare_type,\'总计\') as welfare_type,\n count(distinct user_code) as user_cnt,\n sum(invest_amount) as invest_amount\nFROM ( ${V_SQL_PATTERN} ) tt\ngroup by welfare_type with rollup',108,'welfare_type',NULL,NULL,NULL,1,'1','2017-01-04 15:45:47','2017-01-04 15:52:19','bofei','bofei','2','dt',NULL),
	(269,'开心财神_提现','交易','财神大屏_S','HOURLY','caishen',' SELECT \n user_code,amount,create_date as dt\nFROM ( ${V_SQL_PATTERN} ) tt',111,NULL,NULL,NULL,NULL,0,'1','2017-01-04 17:53:25','2017-01-04 18:02:20','bofei','bofei','2','dt',NULL),
	(270,'分时_开心财神_提现','交易','财神大屏_S','HOURLY','caishen','SELECT \n create_date as dt,\n hour(create_date) as hh,\n amount as invest_amt\nFROM ( ${V_SQL_PATTERN} ) tt',111,'hh',NULL,NULL,NULL,1,'1','2017-01-04 18:39:17','2017-01-04 18:39:17','bofei','bofei','2','dt',NULL),
	(271,'非校园用户有效授信','查询日志','hd_lsk_bld_daily','DAILY','impala','SELECT to_date(log_time) AS dd, \nIFNULL(c.am_name,\"unknown\") channel,IFNULL(b.ad_plan,\"null\") plan,IFNULL(b.ad_unit,\"null\") unit,IFNULL(b.channel_detail,\"null\") detail\nFROM ods.log_app_text lat\nLEFT JOIN odsopr.user_approach_info b ON lat.user_id=b.user_id\nLEFT JOIN odsopr.admin c ON c.id=b.channel_id\nWHERE platform_id IN (16,17) AND page_name=\'credit_assessment\'\nAND title =\'confirm\'\nAND NOT EXISTS(SELECT * FROM odsopr.borrows bo2 WHERE bo_is_success=1 AND p_id IN (77,87,88) \n                                                     AND bo2.user_id=lat.user_id \n                                                     AND bo2.bo_audit_time<log_time)  ',NULL,NULL,NULL,NULL,NULL,0,'1','2017-01-09 14:57:59','2017-02-17 11:05:43',NULL,'hudie','0','dd',NULL),
	(272,'非校园用户进件数','查询日志','hd_lsk_bld_daily','DAILY','impala','SELECT to_date(log_time) AS dd,\nIFNULL(c.am_name,\"unknown\") channel,IFNULL(b.ad_plan,\"null\") plan,IFNULL(b.ad_unit,\"null\") unit,IFNULL(b.channel_detail,\"null\") detail\nFROM ods.log_app_text lat \nLEFT JOIN odsopr.user_approach_info b ON lat.user_id=b.user_id\nLEFT JOIN odsopr.admin c ON c.id=b.channel_id\nWHERE platform_id IN (16,17)  AND page_name=\'borrow_inf\'\nAND title =\'confirm\'\nAND NOT EXISTS(SELECT * FROM odsopr.borrows bo2 WHERE bo_is_success=1 AND p_id IN (77,87,88) \n                                                     AND bo2.user_id=lat.user_id \n                                                     AND bo2.bo_audit_time<log_time)',NULL,NULL,NULL,NULL,NULL,0,'1','2017-01-09 15:28:58','2017-02-17 11:06:14',NULL,'hudie','0','dd',NULL),
	(273,'学历不符人数','查询日志','hd_lsk_bld_daily','DAILY','impala','SELECT to_date(log_time) AS dd, \nIFNULL(c.am_name,\"unknown\") channel,IFNULL(b.ad_plan,\"null\") plan,IFNULL(b.ad_unit,\"null\") unit,IFNULL(b.channel_detail,\"null\") detail,\nlat.user_id\nFROM ods.log_app_text lat\nLEFT JOIN odsopr.user_approach_info b ON lat.user_id=b.user_id\nLEFT JOIN odsopr.admin c ON c.id=b.channel_id\nWHERE platform_id IN (16,17)  AND page_name IN (\'qualification_wait\', \'qualification_fail\' )\n\nAND NOT EXISTS(SELECT * FROM odsopr.borrows bo2 WHERE bo_is_success=1 AND p_id IN (77,87,88) \n                                                     AND bo2.user_id=lat.user_id \n                                                     AND bo2.bo_audit_time<log_time)',NULL,NULL,NULL,NULL,NULL,0,'1','2017-01-09 15:39:46','2017-02-17 11:05:05',NULL,'hudie','0','dd',NULL),
	(276,'人际关系提交率（去重）','查询日志','hd_lsk_bld_daily','DAILY','impala','SELECT to_date(log_time) AS dd, \nIFNULL(c.am_name,\"unknown\") channel,IFNULL(b.ad_plan,\"null\") plan,IFNULL(b.ad_unit,\"null\") unit,IFNULL(b.channel_detail,\"null\") detail,\nlat.user_id\nFROM ods.log_app_text lat\nLEFT JOIN odsopr.user_approach_info b ON lat.user_id=b.user_id\nLEFT JOIN odsopr.admin c ON c.id=b.channel_id\nWHERE platform_id IN (16,17)  AND page_name=\'inf_contacts\'AND page_module=\'contacts\' AND title =\'confirm\'\nAND NOT EXISTS(SELECT * FROM odsopr.borrows bo2 WHERE bo_is_success=1 AND p_id IN (77,87,88) \n                                                     AND bo2.user_id=lat.user_id \n                                                     AND bo2.bo_audit_time<log_time)\n\n',NULL,NULL,NULL,NULL,NULL,0,'1','2017-01-09 15:56:30','2017-02-17 11:04:32',NULL,'hudie','0','dd',NULL),
	(277,'联系地址提交率（去重）','查询日志','hd_lsk_bld_daily','DAILY','impala','SELECT to_date(log_time) AS dd, \nIFNULL(c.am_name,\"unknown\") channel,IFNULL(b.ad_plan,\"null\") plan,IFNULL(b.ad_unit,\"null\") unit,IFNULL(b.channel_detail,\"null\") detail,\nlat.user_id\nFROM ods.log_app_text lat\nLEFT JOIN odsopr.user_approach_info b ON lat.user_id=b.user_id\nLEFT JOIN odsopr.admin c ON c.id=b.channel_id\nWHERE   platform_id IN (16,17)  AND page_name=\'inf_address\'AND page_module=\'address\' AND title =\'confirm\'\nAND NOT EXISTS(SELECT * FROM odsopr.borrows bo2 WHERE bo_is_success=1 AND p_id IN (77,87,88) \n                                                     AND bo2.user_id=lat.user_id \n                                                     AND bo2.bo_audit_time<to_date(log_time))\n',NULL,NULL,NULL,NULL,NULL,0,'1','2017-01-09 15:57:57','2017-02-17 11:04:04',NULL,'hudie','0','dd',NULL),
	(278,'就职单位提交率（去重）','查询日志','hd_lsk_bld_daily','DAILY','impala','SELECT to_date(log_time) AS dd, \nIFNULL(c.am_name,\"unknown\") channel,IFNULL(b.ad_plan,\"null\") plan,IFNULL(b.ad_unit,\"null\") unit,IFNULL(b.channel_detail,\"null\") detail,\nlat.user_id\nFROM ods.log_app_text lat\nLEFT JOIN odsopr.user_approach_info b ON lat.user_id=b.user_id\nLEFT JOIN odsopr.admin c ON c.id=b.channel_id\nWHERE platform_id IN (16,17)  AND page_name=\'inf_company\'AND page_module=\'company\' AND title =\'confirm\'\nAND NOT EXISTS(SELECT * FROM odsopr.borrows bo2 WHERE bo_is_success=1 AND p_id IN (77,87,88) \n                                                     AND bo2.user_id=lat.user_id \n                                                     AND bo2.bo_audit_time<log_time)\n',NULL,NULL,NULL,NULL,NULL,0,'1','2017-01-09 15:58:58','2017-02-17 11:03:28',NULL,'hudie','0','dd',NULL),
	(279,'工作证明提交率（去重）','查询日志','hd_lsk_bld_daily','DAILY','impala','SELECT to_date(log_time) AS dd, \nIFNULL(c.am_name,\"unknown\") channel,IFNULL(b.ad_plan,\"null\") plan,IFNULL(b.ad_unit,\"null\") unit,IFNULL(b.channel_detail,\"null\") detail,\nlat.user_id\nFROM ods.log_app_text lat\nLEFT JOIN odsopr.user_approach_info b ON lat.user_id=b.user_id\nLEFT JOIN odsopr.admin c ON c.id=b.channel_id\nWHERE platform_id IN (16,17)  AND page_name IN (\'inf_social_security\',\'inf_provident_fund\') AND page_module IN (\'social_security\',\'provident_fund\') AND  title =\'confirm\'\nAND NOT EXISTS(SELECT * FROM odsopr.borrows bo2 WHERE bo_is_success=1 AND p_id IN (77,87,88) \n                                                     AND bo2.user_id=lat.user_id \n                                                     AND bo2.bo_audit_time<log_time)\n',NULL,NULL,NULL,NULL,NULL,0,'1','2017-01-09 16:02:21','2017-02-17 11:02:51',NULL,'hudie','0','dd',NULL),
	(280,'身份证提交率（去重）','查询日志','hd_lsk_bld_daily','DAILY','impala','SELECT to_date(log_time) AS dd, \nIFNULL(c.am_name,\"unknown\") channel,IFNULL(b.ad_plan,\"null\") plan,IFNULL(b.ad_unit,\"null\") unit,IFNULL(b.channel_detail,\"null\") detail,\nlat.user_id\nFROM ods.log_app_text lat\nLEFT JOIN odsopr.user_approach_info b ON lat.user_id=b.user_id\nLEFT JOIN odsopr.admin c ON c.id=b.channel_id\nWHERE  platform_id IN (16,17)  AND page_name=\'inf_idcard\'AND page_module=\'idcard\' AND title =\'confirm\'\nAND NOT EXISTS(SELECT * FROM odsopr.borrows bo2 WHERE bo_is_success=1 AND p_id IN (77,87,88) \n                                                     AND bo2.user_id=lat.user_id \n                                                     AND bo2.bo_audit_time<log_time)\n\n\n',NULL,NULL,NULL,NULL,NULL,0,'1','2017-01-09 16:03:50','2017-02-17 11:02:21',NULL,'hudie','0','dd',NULL),
	(281,'收款银行卡提交率（去重）','查询日志','hd_lsk_bld_daily','DAILY','impala','SELECT to_date(log_time) AS dd, \nIFNULL(c.am_name,\"unknown\") channel,IFNULL(b.ad_plan,\"null\") plan,IFNULL(b.ad_unit,\"null\") unit,IFNULL(b.channel_detail,\"null\") detail,\nlat.user_id\nFROM ods.log_app_text lat\nLEFT JOIN odsopr.user_approach_info b ON lat.user_id=b.user_id\nLEFT JOIN odsopr.admin c ON c.id=b.channel_id\nWHERE platform_id IN (16,17)  AND page_name=\'inf_bankcard\'AND page_module=\'bankcard\' AND title =\'confirm\'\nAND NOT EXISTS(SELECT * FROM odsopr.borrows bo2 WHERE bo_is_success=1 AND p_id IN (77,87,88) \n                                                     AND bo2.user_id=lat.user_id \n                                                     AND bo2.bo_audit_time<log_time)                                                                                                    \n ',NULL,NULL,NULL,NULL,NULL,0,'1','2017-01-09 16:05:01','2017-02-17 11:01:36',NULL,'hudie','0','dd',NULL),
	(282,'视频签约数提交率（去重）','查询日志','hd_lsk_bld_daily','DAILY','impala','SELECT to_date(log_time) AS dd, \nIFNULL(c.am_name,\"unknown\") channel,IFNULL(b.ad_plan,\"null\") plan,IFNULL(b.ad_unit,\"null\") unit,IFNULL(b.channel_detail,\"null\") detail,\nlat.user_id\nFROM ods.log_app_text lat\nLEFT JOIN odsopr.user_approach_info b ON lat.user_id=b.user_id\nLEFT JOIN odsopr.admin c ON c.id=b.channel_id\nWHERE platform_id IN (16,17)  AND page_name=\'inf_sign\'AND page_module=\'sign\' AND title =\'upload\'\nAND NOT EXISTS(SELECT * FROM odsopr.borrows bo2 WHERE bo_is_success=1 AND p_id IN (77,87,88) \n                                                     AND bo2.user_id=lat.user_id \n                                                     AND bo2.bo_audit_time<log_time)\n                                                     \n                                                     ',NULL,NULL,NULL,NULL,NULL,0,'1','2017-01-09 16:06:22','2017-02-17 11:00:32',NULL,'hudie','0','dd',NULL),
	(283,'公积金提交率','查询日志','hd_lsk_bld_daily','DAILY','impala','SELECT to_date(log_time) AS dd, \nIFNULL(c.am_name,\"unknown\") channel,IFNULL(b.ad_plan,\"null\") plan,IFNULL(b.ad_unit,\"null\") unit,IFNULL(b.channel_detail,\"null\") detail,\nlat.user_id\nFROM ods.log_app_text lat\nLEFT JOIN odsopr.user_approach_info b ON lat.user_id=b.user_id\nLEFT JOIN odsopr.admin c ON c.id=b.channel_id\nWHERE  platform_id IN (16,17)  AND page_name =\'inf_social_security\' AND page_module=\'provident_fund\' AND  title =\'confirm\'\nAND NOT EXISTS(SELECT * FROM odsopr.borrows bo2 WHERE bo_is_success=1 AND p_id IN (77,87,88) \n                                                     AND bo2.user_id=lat.user_id \n                                                     AND bo2.bo_audit_time<log_time)                                       \n                                                     ',NULL,NULL,NULL,NULL,NULL,0,'1','2017-01-09 17:00:22','2017-02-17 10:59:39',NULL,'hudie','0','dd',NULL),
	(284,'社保提交率','查询日志','hd_lsk_bld_daily','DAILY','impala','SELECT to_date(log_time) AS dd, \nIFNULL(c.am_name,\"unknown\") channel,IFNULL(b.ad_plan,\"null\") plan,IFNULL(b.ad_unit,\"null\") unit,IFNULL(b.channel_detail,\"null\") detail,\nlat.user_id\nFROM ods.log_app_text lat\nLEFT JOIN odsopr.user_approach_info b ON lat.user_id=b.user_id\nLEFT JOIN odsopr.admin c ON c.id=b.channel_id \nWHERE  platform_id IN (16,17)\nAND page_name = \'inf_social_security\'\nAND page_module =\'social_security\'  \nAND  title =\'confirm\'\nAND NOT EXISTS(SELECT * FROM odsopr.borrows bo2 WHERE bo_is_success=1 AND p_id IN (77,87,88) \n                                                     AND bo2.user_id=lat.user_id \n                                                     AND bo2.bo_audit_time<log_time)',NULL,NULL,NULL,NULL,NULL,0,'1','2017-01-09 17:01:40','2017-02-17 10:56:25',NULL,'hudie','0','dd',NULL),
	(285,'授信人数','白领','白领版周报','DAILY','impala','SELECT \'${V_STAT_DATE}\' AS dt,\'进行授信\' AS op_type,user_id\nFROM ods.log_app_text WHERE platform_id IN (16,17) AND page_name=\'credit_assessment\'\nAND title =\'confirm\'\nAND to_date(log_time) \nBETWEEN DATE_SUB(to_date(FROM_UNIXTIME(UNIX_TIMESTAMP(), \'yyyy-MM-dd HH:mm:ss\')),7 ) AND DATE_SUB(to_date(FROM_UNIXTIME(UNIX_TIMESTAMP(), \'yyyy-MM-dd HH:mm:ss\')),1 )\nUNION ALL\nSELECT \'${V_STAT_DATE}\' AS dt,\'进件\' AS op_type ,user_id\nFROM   ods.log_app_text \nWHERE platform_id IN (16,17) AND page_name=\'borrow_inf\'\nAND title =\'confirm\'\nAND to_date(log_time) BETWEEN DATE_SUB(to_date(FROM_UNIXTIME(UNIX_TIMESTAMP(), \'yyyy-MM-dd HH:mm:ss\')),7 ) AND DATE_SUB(to_date(FROM_UNIXTIME(UNIX_TIMESTAMP(), \'yyyy-MM-dd HH:mm:ss\')),1 )\nUNION ALL\nSELECT \'${V_STAT_DATE}\' AS dt,\'当期进行授信\' AS op_type,user_id\nFROM   ods.log_app_text \nWHERE platform_id IN (16,17) AND page_name=\'credit_assessment\'\nAND title =\'confirm\'\nAND to_date(log_time) BETWEEN DATE_SUB(to_date(FROM_UNIXTIME(UNIX_TIMESTAMP(), \'yyyy-MM-dd HH:mm:ss\')),7 ) AND DATE_SUB(to_date(FROM_UNIXTIME(UNIX_TIMESTAMP(), \'yyyy-MM-dd HH:mm:ss\')),1 )\nAND user_id IN (SELECT id FROM odsopr.user_info WHERE to_date(register_time) BETWEEN DATE_SUB(to_date(FROM_UNIXTIME(UNIX_TIMESTAMP(), \'yyyy-MM-dd HH:mm:ss\')),7 ) AND DATE_SUB(to_date(FROM_UNIXTIME(UNIX_TIMESTAMP(), \'yyyy-MM-dd HH:mm:ss\')),1 ))\nUNION ALL\nSELECT \'${V_STAT_DATE}\' AS dt, \'当期进件\' AS op_type ,user_id\nFROM   ods.log_app_text WHERE platform_id IN (16,17) \nAND page_name=\'borrow_inf\'\nAND title =\'confirm\'\nAND to_date(log_time) BETWEEN DATE_SUB(to_date(FROM_UNIXTIME(UNIX_TIMESTAMP(), \'yyyy-MM-dd HH:mm:ss\')),7 ) AND DATE_SUB(to_date(FROM_UNIXTIME(UNIX_TIMESTAMP(), \'yyyy-MM-dd HH:mm:ss\')),1 )\nAND user_id IN (SELECT id FROM odsopr.user_info WHERE to_date(register_time) BETWEEN DATE_SUB(to_date(FROM_UNIXTIME(UNIX_TIMESTAMP(), \'yyyy-MM-dd HH:mm:ss\')),7 ) AND DATE_SUB(to_date(FROM_UNIXTIME(UNIX_TIMESTAMP(), \'yyyy-MM-dd HH:mm:ss\')),1 ))\nUNION ALL\nSELECT \'${V_STAT_DATE}\' AS dt,\'提交授信\' AS op_type ,user_id\nFROM  ods.log_app_text \nWHERE platform_id IN (16,17) AND page_name=\'credit_assessment\'\nAND to_date(log_time) BETWEEN DATE_SUB(to_date(FROM_UNIXTIME(UNIX_TIMESTAMP(), \'yyyy-MM-dd HH:mm:ss\')),7 ) AND DATE_SUB(to_date(FROM_UNIXTIME(UNIX_TIMESTAMP(), \'yyyy-MM-dd HH:mm:ss\')),1 )\n\n',NULL,'op_type',NULL,NULL,NULL,1,'1','2017-01-11 15:43:25','2017-02-16 16:09:29','wangzukun','wangzukun','0','dt',NULL),
	(286,'资金流动性_特殊帐户_余额_净入金','投资','资金流动性_特殊帐户_余额_净入金','HOURLY','nono','select curdate() as dt,hour(now()) as hh, invest_amt,d_invest_amt from (${V_SQL_PATTERN} \n) tx',118,'hh',NULL,NULL,NULL,1,'1','2017-01-18 14:19:32','2017-02-15 16:07:19','admin','bofei','2','dt',NULL),
	(287,'AUM_渠道人数分布','AUM','财神_用户生命周期','DAILY','hive','SELECT \n STAT_DATE as dt,\n user_id,stat_date,channel,\nprovince,gender,age_range,aum,aum_range,\nexpect_range,product_type\nFROM ( ${V_SQL_PATTERN} ) tt',119,'channel',NULL,NULL,NULL,1,'1','2017-01-20 10:46:58','2017-01-20 15:20:15','bofei','bofei','0','dt',NULL),
	(288,'AUM_地域人数分布','AUM','财神_用户生命周期','DAILY','hive','select dt,\n(case when row_number()over(partition by dt order by cnt desc ) <=5 then province else \'其它\' end ) as province,\ncnt \nfrom (\nSELECT \n STAT_DATE as dt,\nprovince,\ncount(distinct user_id) as cnt,\nsum(aum) as aum\nFROM ( ${V_SQL_PATTERN} ) tt\nwhere stat_date=\'${V_BEGIN_DATE}\'\nGROUP BY STAT_DATE,province) t',119,'province',NULL,NULL,NULL,1,'1','2017-01-20 10:48:03','2017-01-20 15:20:15','bofei','bofei','0','dt',NULL),
	(289,'AUM_性别人数分布','AUM','财神_用户生命周期','DAILY','hive','SELECT \n STAT_DATE as dt,\n user_id,stat_date,channel,\nprovince,gender,age_range,aum,aum_range,\nexpect_range,product_type\nFROM ( ${V_SQL_PATTERN} ) tt',119,'gender',NULL,NULL,NULL,1,'1','2017-01-20 10:48:53','2017-01-20 15:20:15','bofei','bofei','0','dt',NULL),
	(290,'AUM_年龄人数分布','AUM','财神_用户生命周期','DAILY','hive','SELECT \n STAT_DATE as dt,\n user_id,stat_date,channel,\nprovince,gender,age_range,aum,aum_range,\nexpect_range,product_type\nFROM ( ${V_SQL_PATTERN} ) tt',119,'age_range',NULL,NULL,NULL,1,'1','2017-01-20 10:50:29','2017-01-20 15:20:15','bofei','bofei','0','dt',NULL),
	(291,'AUM_在投金额人数分布','AUM','财神_用户生命周期','DAILY','hive','\nSELECT \n STAT_DATE as dt,\n user_id,aum_range\nFROM ( ${V_SQL_PATTERN} ) tt',122,'aum_range',NULL,NULL,NULL,1,'1','2017-01-20 10:55:17','2017-01-20 18:08:51','bofei','bofei','0','dt',NULL),
	(292,'AUM_产品人数分布','AUM','财神_用户生命周期','DAILY','hive','SELECT \n STAT_DATE as dt,\n user_id,stat_date,channel,\nprovince,gender,age_range,aum,aum_range,\nexpect_range,product_type\nFROM ( ${V_SQL_PATTERN} ) tt',119,'product_type',NULL,NULL,NULL,1,'1','2017-01-20 10:56:23','2017-01-20 15:20:15','bofei','bofei','0','dt',NULL),
	(293,'AUM_期限人数分布','AUM','财神_用户生命周期','DAILY','hive','SELECT \n STAT_DATE as dt,\n user_id,stat_date,channel,\nprovince,gender,age_range,aum,aum_range,\nexpect_range,product_type\nFROM ( ${V_SQL_PATTERN} ) tt',119,'expect_range',NULL,NULL,NULL,1,'1','2017-01-20 10:57:09','2017-01-20 15:20:15','bofei','bofei','0','dt',NULL),
	(294,'获客_渠道分布','注册','财神_用户生命周期','DAILY','impala','select\n    channel,\n    dt,\n    user_id\nfrom \n( ${V_SQL_PATTERN} ) tt',120,'channel',NULL,NULL,NULL,1,'1','2017-01-20 13:34:27','2017-01-23 15:33:41',NULL,'zhangbingcan','0','dt',NULL),
	(295,'获客_人均在投','在投','财神_用户生命周期','DAILY','impala','select \n    u.channel_category channel,\n    u.stat_date dt,\n    u.csyy_AUM as aum,\n    u.user_id\nfrom rpt.v_cs_user_stat as u\nwhere u.register_date >= date_add(u.stat_date,-30)',NULL,'channel',NULL,NULL,NULL,1,'1','2017-01-20 15:34:06','2017-01-23 15:33:32',NULL,'zhangbingcan','0','dt',NULL),
	(296,'获客_首投金额分布','投资','财神_用户生命周期','DAILY','impala','select \n    u.channel,\n   substring(u.first_invest_time,1,10) dt,\n   u.first_invest_amount,\n    u.user_id\nfrom rpt.v_cs_user as u',NULL,'channel',NULL,NULL,NULL,1,'1','2017-01-20 16:09:07','2017-01-23 15:33:25',NULL,'zhangbingcan','0','dt',NULL),
	(297,'获客_人均投资','投资','财神_用户生命周期','DAILY','impala','select \ninvest_date dt,\nchannel, \ninvest_amt,\nuser_id\nfrom rpt.v_cs_invest',NULL,'channel',NULL,NULL,NULL,1,'1','2017-01-20 16:26:12','2017-01-23 15:33:09',NULL,'zhangbingcan','0','dt',NULL),
	(298,'获客_性别分布','注册','财神_用户生命周期','DAILY','impala','select\n    gender,\n    dt,\n    user_id\nfrom \n( ${V_SQL_PATTERN} ) tt where channel = \'用户推荐\'',120,'gender',NULL,NULL,NULL,1,'1','2017-01-20 16:33:19','2017-01-23 15:32:58',NULL,'zhangbingcan','0','dt',NULL),
	(299,'获客_年龄分布','注册','财神_用户生命周期','DAILY','impala','select\n    age_range,\n    dt,\n    user_id\nfrom \n( ${V_SQL_PATTERN} ) tt where channel = \'用户推荐\'',120,'age_range',NULL,NULL,NULL,1,'1','2017-01-20 16:41:50','2017-01-23 15:32:50',NULL,'zhangbingcan','0','dt',NULL),
	(300,'获客_地域分布','注册','财神_用户生命周期','DAILY','impala','select\n    province,\n    dt,\n    user_id\nfrom \n( ${V_SQL_PATTERN} ) tt where channel = \'用户推荐\'',120,'province',NULL,NULL,NULL,1,'1','2017-01-20 16:43:47','2017-01-23 15:32:42',NULL,'zhangbingcan','0','dt',NULL),
	(301,'获客_渠道成本','首投','财神_用户生命周期','DAILY','impala','select\n  cost_date dt,\n  channel_type,\n  cost_amt,\n  user_id\nfrom rpt.v_cs_cost',NULL,'channel_type',NULL,NULL,NULL,1,'1','2017-01-20 19:14:15','2017-01-23 15:33:16',NULL,'zhangbingcan','0','dt',NULL),
	(302,'流失用户_渠道_性别_年龄','流失用户','财神_用户生命周期','DAILY','hive','SELECT \n stat_date as dt,\n channel,\n province,gender,age_range \nFROM ( ${V_SQL_PATTERN} ) tt\nwhere \nstat_date=\'${V_STAT_DATE}\'\nand datediff(\'${V_STAT_DATE}\',last_invest_time)=90\nand (aum+balance_amt)<=50',123,'channel','gender','age_range',NULL,3,'1','2017-01-22 11:47:06','2017-01-22 11:47:06','bofei','bofei','0','dt',NULL),
	(303,'流失用户_区域','流失用户','财神_用户生命周期','DAILY','hive','select \n\'${V_STAT_DATE}\' as dt, province,\nsum(cnt) as cnt\nfrom (\nselect \n(case when row_number()over(order by cnt desc ) <=5 then province else \'其它\' end ) as province\n,cnt\nfrom (\nselect \nprovince\n,count(1) as cnt \nfrom ( ${V_SQL_PATTERN} ) ta\nwhere \nstat_date=\'${V_STAT_DATE}\'\nand datediff(\'${V_STAT_DATE}\',last_invest_time)=90\nand (aum+balance_amt)<=50\ngroup by province) t) t2\ngroup by province',123,'province',NULL,NULL,NULL,1,'1','2017-01-22 13:23:34','2017-01-22 13:23:34','bofei','bofei','0','dt',NULL),
	(304,'流失用户_累计金额_次数','流失用户','财神_用户生命周期','DAILY','hive','select \n\'${V_STAT_DATE}\' as dt,\'1\' as t3,\ncase when invest_amt<=50000 then \'<5w\'\n    when invest_amt>50000 and invest_amt<=200000 then \'5w-20w\'\n	when invest_amt>200000 and invest_amt<=500000 then \'20w-50w\'\n	when invest_amt>500000 and invest_amt<=1000000 then \'50w-100w\'\n	else \'100w+\' end as invest_amt_range,\ncase when cnt<=20 then \'<20\'\n    when cnt>20 and cnt<=30 then \'20-30\'\n    when cnt>30 and cnt<=40 then \'30-40\'\n    when cnt>40 and cnt<=50 then \'40-50\'\n    when cnt>50 and cnt<=100 then \'50-100\'\n	when cnt>100 and cnt<=500 then \'100-500\'\n	else \'500+\' end as invest_cnt_range\nfrom (\nSELECT \n du.user_id,\n COALESCE(inv.invest_amt,0) as invest_amt,\n COALESCE(inv.cnt,0) as cnt\nFROM  (${V_SQL_PATTERN}) du \nLEFT OUTER JOIN \n(SELECT user_id, sum(invest_amt) as invest_amt,count(1) as cnt FROM idw.fact_csyy_invest_order\nwhere invest_time<\'${V_END_DATE}\'\n GROUP BY user_id) inv \nON du.user_id = inv.user_id\nwhere \nstat_date=\'${V_STAT_DATE}\'\nand datediff(\'${V_STAT_DATE}\',last_invest_time)=90\nand (aum+balance_amt)<=50\n) tt',123,'invest_amt_range','invest_cnt_range','t3',NULL,3,'1','2017-01-22 13:26:28','2017-01-22 15:07:44','bofei','bofei','1','dt',NULL),
	(305,'流失用户_最后投资产品_累计留存时长','流失用户','财神_用户生命周期','DAILY','hive','select \n\'${V_STAT_DATE}\' as dt,\ninv.product_type,\ntt.user_id,\ndatediff(invest_time,register_time) as df,\ncase when datediff(invest_time,register_time)<=1 then \'1\'\n    when datediff(invest_time,register_time)>1 and datediff(invest_time,register_time)<=50 then \'2-50\'\n	when datediff(invest_time,register_time)>50 and datediff(invest_time,register_time)<=500 then \'50-500\'\n	else \'500+\' end as df_range\nfrom \n(${V_SQL_PATTERN}) tt \nleft join \n(SELECT user_id,\ncase when fio.product_code = \'NN0018\' then \'开心财神\' \nwhen fio.invest_type_code = 1 then \'定期\'\nwhen fio.invest_type_code = 2 then \'活期\'\nelse \'<未知>\'\nend as product_type,\nfio.invest_time,\nrow_number()over(partition by fio.user_id order by fio.invest_time desc) as n\nFROM idw.fact_csyy_invest_order fio\nLEFT OUTER JOIN idw.dim_csyy_product dfp ON fio.PRODUCT_KEY = dfp.PRODUCT_KEY\nwhere fio.invest_time<\'${V_END_DATE}\') inv \n on tt.user_id = inv.user_id\n and inv.n=1\nwhere   \nstat_date=\'${V_STAT_DATE}\'\nand datediff(\'${V_STAT_DATE}\',last_invest_time)=90\nand (aum+balance_amt)<=50',123,'product_type','df_range',NULL,NULL,2,'1','2017-01-22 13:27:50','2017-01-22 14:46:24','bofei','bofei','0','dt',NULL),
	(306,'活动数量指标','活动','2017诺诺新年活动监控','10MIN','mkt','\nselect \ncast(floor(DATE_FORMAT( create_time,\'%H%i\')/10) as unsigned) * 10 hm, \ncreate_time dt,\nuser_id,\n1 as event_count, \ncase when type = 1 then 1 else 0 end as play_count,\ncase event \nwhen 1 then \'登录\'\nwhen 2 then \'分享\'\nwhen 3 then \'投资\'\nwhen 4 then \'邀请\'\nend as event\nfrom mkt_active.mkt_raffle_times_log ',NULL,'event','hm',NULL,NULL,2,'0','2017-01-22 13:35:40','2017-02-14 10:45:53','zhangbingcan','zhangbingcan','2','dt',NULL),
	(307,'活动人数指标','活动','2017诺诺新年活动监控','10MIN','mkt','select  \ncreate_time dt,\nuser_id,\n1 as event_count, \ncase event \nwhen 1 then \'登录\'\nwhen 2 then \'分享\'\nwhen 3 then \'投资\'\nwhen 4 then \'邀请\'\nend as event\nfrom mkt_active.mkt_raffle_times_log \nwhere type = 1',NULL,'',NULL,NULL,NULL,0,'0','2017-01-22 14:01:26','2017-02-14 10:45:53','zhangbingcan','zhangbingcan','2','dt',NULL),
	(308,'首投_产品分布','首投','财神_用户生命周期','DAILY','impala','select \n  invest_date as dt,\n  product_type,\n  province,\n  invest_amt_range,\n  age_range,\n  expect_range,\n  channel,\n  gender,\n  use_coupon_flag,\n  user_id\nfrom rpt.v_cs_invest \nwhere is_fst_invest = 1',NULL,'product_type',NULL,NULL,NULL,1,'1','2017-01-22 15:47:27','2017-01-23 13:13:07','SYS','SYS','0','dt',NULL),
	(309,'首投_地域分布','首投','财神_用户生命周期','DAILY','impala','select \n  invest_date as dt,\n  product_type,\n  province,\n  invest_amt_range,\n  age_range,\n  expect_range,\n  channel,\n  gender,\n  use_coupon_flag,\n  user_id\nfrom rpt.v_cs_invest \nwhere is_fst_invest = 1',NULL,'province',NULL,NULL,NULL,1,'1','2017-01-22 15:47:27','2017-01-23 13:13:07','SYS','SYS','0','dt',NULL),
	(310,'首投_金额分布','首投','财神_用户生命周期','DAILY','impala','select \n  invest_date as dt,\n  product_type,\n  province,\n  invest_amt_range,\n  age_range,\n  expect_range,\n  channel,\n  gender,\n  use_coupon_flag,\n  user_id\nfrom rpt.v_cs_invest \nwhere is_fst_invest = 1',NULL,'invest_amt_range',NULL,NULL,NULL,1,'1','2017-01-22 15:47:27','2017-01-23 13:13:07','SYS','SYS','0','dt',NULL),
	(311,'首投_年龄分布','首投','财神_用户生命周期','DAILY','impala','select \n  invest_date as dt,\n  product_type,\n  province,\n  invest_amt_range,\n  age_range,\n  expect_range,\n  channel,\n  gender,\n  use_coupon_flag,\n  user_id\nfrom rpt.v_cs_invest \nwhere is_fst_invest = 1',NULL,'age_range',NULL,NULL,NULL,1,'1','2017-01-22 15:47:27','2017-01-23 13:13:07','SYS','SYS','0','dt',NULL),
	(312,'首投_期限分布','首投','财神_用户生命周期','DAILY','impala','select \n  invest_date as dt,\n  product_type,\n  province,\n  invest_amt_range,\n  age_range,\n  expect_range,\n  channel,\n  gender,\n  use_coupon_flag,\n  user_id\nfrom rpt.v_cs_invest \nwhere is_fst_invest = 1',NULL,'expect_range',NULL,NULL,NULL,1,'1','2017-01-22 15:47:27','2017-01-23 13:13:07','SYS','SYS','0','dt',NULL),
	(313,'首投_渠道分布','首投','财神_用户生命周期','DAILY','impala','select \n  invest_date as dt,\n  product_type,\n  province,\n  invest_amt_range,\n  age_range,\n  expect_range,\n  channel,\n  gender,\n  use_coupon_flag,\n  user_id\nfrom rpt.v_cs_invest \nwhere is_fst_invest = 1',NULL,'channel',NULL,NULL,NULL,1,'1','2017-01-22 15:47:27','2017-01-23 13:13:07','SYS','SYS','0','dt',NULL),
	(314,'首投_性别分布','首投','财神_用户生命周期','DAILY','impala','select \n  invest_date as dt,\n  product_type,\n  province,\n  invest_amt_range,\n  age_range,\n  expect_range,\n  channel,\n  gender,\n  use_coupon_flag,\n  user_id\nfrom rpt.v_cs_invest \nwhere is_fst_invest = 1',NULL,'gender',NULL,NULL,NULL,1,'1','2017-01-22 15:47:27','2017-01-23 13:13:07','SYS','SYS','0','dt',NULL),
	(315,'首投_用券分布','首投','财神_用户生命周期','DAILY','impala','select \n  invest_date as dt,\n  product_type,\n  province,\n  invest_amt_range,\n  age_range,\n  expect_range,\n  channel,\n  gender,\n  use_coupon_flag,\n  user_id\nfrom rpt.v_cs_invest \nwhere is_fst_invest = 1',NULL,'use_coupon_flag',NULL,NULL,NULL,1,'1','2017-01-22 15:47:27','2017-01-23 13:13:07','SYS','SYS','0','dt',NULL),
	(316,'复投_产品分布','复投','财神_用户生命周期','DAILY','impala','select \n  invest_date as dt,\n  product_type,\n  province,\n  invest_amt_range,\n  age_range,\n  expect_range,\n  channel,\n  gender,\n  use_coupon_flag,\n  user_id\nfrom rpt.v_cs_invest \nwhere is_sec_invest = 1',NULL,'product_type',NULL,NULL,NULL,1,'1','2017-01-22 15:47:27','2017-01-23 13:13:07','SYS','SYS','0','dt',NULL),
	(317,'复投_地域分布','复投','财神_用户生命周期','DAILY','impala','select \n  invest_date as dt,\n  product_type,\n  province,\n  invest_amt_range,\n  age_range,\n  expect_range,\n  channel,\n  gender,\n  use_coupon_flag,\n  user_id\nfrom rpt.v_cs_invest \nwhere is_sec_invest = 1',NULL,'province',NULL,NULL,NULL,1,'1','2017-01-22 15:47:27','2017-01-23 13:13:07','SYS','SYS','0','dt',NULL),
	(318,'复投_金额分布','复投','财神_用户生命周期','DAILY','impala','select \n  invest_date as dt,\n  product_type,\n  province,\n  invest_amt_range,\n  age_range,\n  expect_range,\n  channel,\n  gender,\n  use_coupon_flag,\n  user_id\nfrom rpt.v_cs_invest \nwhere is_sec_invest = 1',NULL,'invest_amt_range',NULL,NULL,NULL,1,'1','2017-01-22 15:47:27','2017-01-23 13:13:07','SYS','SYS','0','dt',NULL),
	(319,'复投_年龄分布','复投','财神_用户生命周期','DAILY','impala','select \n  invest_date as dt,\n  product_type,\n  province,\n  invest_amt_range,\n  age_range,\n  expect_range,\n  channel,\n  gender,\n  use_coupon_flag,\n  user_id\nfrom rpt.v_cs_invest \nwhere is_sec_invest = 1',NULL,'age_range',NULL,NULL,NULL,1,'1','2017-01-22 15:47:27','2017-01-23 13:13:07','SYS','SYS','0','dt',NULL),
	(320,'复投_期限分布','复投','财神_用户生命周期','DAILY','impala','select \n  invest_date as dt,\n  product_type,\n  province,\n  invest_amt_range,\n  age_range,\n  expect_range,\n  channel,\n  gender,\n  use_coupon_flag,\n  user_id\nfrom rpt.v_cs_invest \nwhere is_sec_invest = 1',NULL,'expect_range',NULL,NULL,NULL,1,'1','2017-01-22 15:47:27','2017-01-23 13:13:07','SYS','SYS','0','dt',NULL),
	(321,'复投_渠道分布','复投','财神_用户生命周期','DAILY','impala','select \n  invest_date as dt,\n  product_type,\n  province,\n  invest_amt_range,\n  age_range,\n  expect_range,\n  channel,\n  gender,\n  use_coupon_flag,\n  user_id\nfrom rpt.v_cs_invest \nwhere is_sec_invest = 1',NULL,'channel',NULL,NULL,NULL,1,'1','2017-01-22 15:47:27','2017-01-23 13:13:07','SYS','SYS','0','dt',NULL),
	(322,'复投_性别分布','复投','财神_用户生命周期','DAILY','impala','select \n  invest_date as dt,\n  product_type,\n  province,\n  invest_amt_range,\n  age_range,\n  expect_range,\n  channel,\n  gender,\n  use_coupon_flag,\n  user_id\nfrom rpt.v_cs_invest \nwhere is_sec_invest = 1',NULL,'gender',NULL,NULL,NULL,1,'1','2017-01-22 15:47:27','2017-01-23 13:13:07','SYS','SYS','0','dt',NULL),
	(323,'复投_用券分布','复投','财神_用户生命周期','DAILY','impala','select \n  invest_date as dt,\n  product_type,\n  province,\n  invest_amt_range,\n  age_range,\n  expect_range,\n  channel,\n  gender,\n  use_coupon_flag,\n  user_id\nfrom rpt.v_cs_invest \nwhere is_sec_invest = 1',NULL,'use_coupon_flag',NULL,NULL,NULL,1,'1','2017-01-22 15:47:27','2017-01-23 13:13:07','SYS','SYS','0','dt',NULL),
	(324,'首投_转化率','首投','财神_用户生命周期','DAILY','impala','select\n  \'${V_STAT_DATE}\' as dt,\n  t1.register_date,\n  t1.user_id,\n  t2.d0,\n  t2.d3,\n  t2.d7,\n  t2.d30,\n  t2.dx\nfrom rpt.v_cs_user t1\nleft join (\n  select\n   user_id,\n   case\n     when register_interval = 0\n     then 1\n     else 0\n   end d0,\n   case\n     when register_interval <= 3\n     then 1\n     else 0\n   end d3,\n   case\n     when register_interval <= 7\n     then 1\n     else 0\n   end d7,\n   case\n     when register_interval <= 30\n     then 1\n     else 0\n   end d30,\n   case\n     when register_interval > 30\n     then 1\n     else 0\n   end dx\nfrom rpt.v_cs_invest\nwhere is_fst_invest = 1\n) t2\non t1.user_id = t2.user_id\nwhere t1.register_date >= date_sub(\'${V_END_DATE}\',30)\nand t1.register_date < \'${V_END_DATE}\'',NULL,'register_date',NULL,NULL,NULL,1,'1','2017-01-22 15:47:27','2017-01-23 13:13:07','SYS','SYS','0','dt',NULL),
	(325,'复投_转化率','复投','财神_用户生命周期','DAILY','impala','select\n  \'${V_STAT_DATE}\'                as dt,\n  substr(t1.first_invest_time,1,10) as fst_invest_date,\n  t1.user_id,\n  t2.d0,\n  t2.d3,\n  t2.d7,\n  t2.d30,\n  t2.dx\nfrom rpt.v_cs_user t1\nleft join (\n  select\n   user_id,\n   case\n     when fst_invest_interval = 0\n     then 1\n     else 0\n   end d0,\n   case\n     when fst_invest_interval <= 3\n     then 1\n     else 0\n   end d3,\n   case\n     when fst_invest_interval <= 7\n     then 1\n     else 0\n   end d7,\n   case\n     when fst_invest_interval <= 30\n     then 1\n     else 0\n   end d30,\n   case\n     when fst_invest_interval > 30\n     then 1\n     else 0\n   end dx\nfrom rpt.v_cs_invest\nwhere is_sec_invest = 1\n) t2\non t1.user_id = t2.user_id\nwhere t1.first_invest_time is not null\nand t1.first_invest_time >= date_sub(\'${V_END_DATE}\',30)\nand t1.first_invest_time < \'${V_END_DATE}\'',NULL,'fst_invest_date',NULL,NULL,NULL,1,'1','2017-01-22 15:47:27','2017-01-23 13:13:07','SYS','SYS','0','dt',NULL),
	(339,'活动异常名单','活动','2017诺诺新年活动监控','10MIN','mkt','select  \nuser_id,\ncurdate() as dt,\ncount(1) as play_count\nfrom mkt_active.mkt_raffle_times_log \nwhere type = 1\nand create_time>=\'2017-01-22\'\ngroup by user_id\nhaving count(1)>50',NULL,'user_id',NULL,NULL,NULL,1,'0','2017-01-22 16:13:53','2017-02-14 10:45:53','zhangbingcan','zhangbingcan','2','dt',NULL),
	(344,'概览_投资总数','概览','财神_用户生命周期','DAILY','hive',' select\n   \'${V_STAT_DATE}\' as dt,\n   user_id,\n   count(*) as inv_cnt\n from rpt.v_cs_invest\n where invest_time <= \'${V_END_DATE}\'\n group by user_id',NULL,NULL,NULL,NULL,NULL,0,'1','2017-01-22 16:45:28','2017-01-22 16:58:19','liuhailiang','liuhailiang','1','dt',NULL),
	(345,'概览_投资次数分布','概览','财神_用户生命周期','DAILY','hive','select \n  \'${V_STAT_DATE}\' as dt,\n  user_id,\n  case\n    when inv_cnt = 1\n    then \'首投用户\'\n    when inv_cnt = 2\n    then \'复投用户\'\n    else \'3次及以上\'\n  end inv_cnt_range\nfrom (\nselect\n  user_id,\n  count(*) as inv_cnt\nfrom rpt.v_cs_invest\nwhere invest_time >= date_sub(substr(from_unixtime(unix_timestamp()),1,10),7)\nand invest_time < \'${V_END_DATE}\'\ngroup by user_id\n) tt ',NULL,'inv_cnt_range',NULL,NULL,NULL,1,'1','2017-01-22 17:15:40','2017-01-22 17:15:40','liuhailiang','liuhailiang','1','dt',NULL),
	(346,'概览_首投转化率','概览','财神_用户生命周期','DAILY','impala','select\n  \'${V_STAT_DATE}\' as dt,\n  t1.week_no_of_year,           \n  t1.user_id,                  \n  t2.d0,                       \n  t2.d3,                      \n  t2.d7,\n  t2.d30,\n  t2.dx\nfrom rpt.v_cs_user t1\nleft join (\n  select\n   user_id,\n   case\n     when register_interval = 0\n     then 1\n     else 0\n   end d0,\n   case\n     when register_interval <= 3\n     then 1\n     else 0\n   end d3,\n   case\n     when register_interval <= 7\n     then 1\n     else 0\n   end d7,\n   case\n     when register_interval <= 30\n     then 1\n     else 0\n   end d30,\n   1 as dx\nfrom rpt.v_cs_invest\nwhere is_fst_invest = 1\n) t2\non t1.user_id = t2.user_id\nwhere t1.register_date >= date_sub(current_timestamp(),77+(dayofweek(current_timestamp())-2))\nand t1.register_date < \'${V_END_DATE}\'\n',NULL,'week_no_of_year',NULL,NULL,NULL,1,'1','2017-01-22 17:33:33','2017-01-22 17:33:33','liuhailiang','liuhailiang','1','dt',NULL),
	(347,'概览_每周入金','概览','财神_用户生命周期','DAILY','impala','select \n  \'${V_STAT_DATE}\' as dt,\n  week_no_of_year,\n  invest_amt\nfrom rpt.v_cs_invest \nwhere invest_date >= date_sub(\'${V_END_DATE}\',77+(dayofweek(\'${V_END_DATE}\')-2)) \nand invest_date < \'${V_END_DATE}\'',NULL,'week_no_of_year',NULL,NULL,NULL,1,'1','2017-01-22 17:54:37','2017-01-23 13:05:52','liuhailiang','liuhailiang','1','dt',NULL),
	(348,'概览_每周结算','概览','财神_用户生命周期','DAILY','impala','select \n  \'${V_STAT_DATE}\' as dt,\n  actual_week_no_of_year,\n  cash_principal\nfrom rpt.v_cs_cash\nwhere actual_accept_time >= date_sub(\'${V_END_DATE}\',77+(dayofweek(\'${V_END_DATE}\')-2)) \nand actual_accept_time < \'${V_END_DATE}\'',NULL,'actual_week_no_of_year',NULL,NULL,NULL,1,'1','2017-01-22 17:59:51','2017-01-23 12:07:50','liuhailiang','liuhailiang','1','dt',NULL),
	(349,'概览_即将结算','概览','财神_用户生命周期','DAILY','impala','select \n  \'${V_STAT_DATE}\' as dt,\n  plan_week_no_of_year,\n  cash_principal\nfrom rpt.v_cs_cash\nwhere plan_accept_time >= date_sub(\'${V_END_DATE}\',dayofweek(\'${V_END_DATE}\')-2) \nand plan_accept_time < date_add(\'${V_END_DATE}\',161+( 7-(dayofweek(\'${V_END_DATE}\')-2) ))\nand accept_status = 0',NULL,'plan_week_no_of_year',NULL,NULL,NULL,1,'1','2017-01-22 18:05:23','2017-02-10 11:51:34','liuhailiang','bofei','1','dt',NULL),
	(350,'概览_复投转化率','概览','财神_用户生命周期','DAILY','impala','select\n  \'${V_STAT_DATE}\' as dt,\n  dd.week_of_year2,\n  t2.d0,\n  t2.d3,\n  t2.d7,\n  t2.d30,\n  t2.dx,\n  t1.user_id\nfrom rpt.v_cs_user t1\nleft join (\n  select\n   user_id,\n   case\n     when fst_invest_interval = 0\n     then 1\n     else 0\n   end d0,\n   case\n     when fst_invest_interval <= 3\n     then 1\n     else 0\n   end d3,\n   case\n     when fst_invest_interval <= 7\n     then 1\n     else 0\n   end d7,\n   case\n     when fst_invest_interval <= 30\n     then 1\n     else 0\n   end d30,\n   1 as dx\nfrom rpt.v_cs_invest\nwhere is_sec_invest = 1\n) t2\non t1.user_id = t2.user_id\nleft join rpt.v_dim_date dd\non regexp_replace(substr(t1.first_invest_time,1,10),\"\\\\-\",\"\") = dd.day_id\nwhere t1.first_invest_time is not null\nand t1.first_invest_time >= date_sub(\'${V_END_DATE}\',77+(dayofweek(\'${V_END_DATE}\')-2))\nand t1.first_invest_time < \'${V_END_DATE}\'',NULL,'week_of_year2',NULL,NULL,NULL,1,'1','2017-01-22 18:19:53','2017-01-23 13:03:01','liuhailiang','liuhailiang','1','dt',NULL),
	(351,'累计数据','活动','2017诺诺新年活动监控','10MIN','mkt','select  \nuser_id,\ncreate_time as dt\nfrom mkt_active.mkt_raffle_times_log \nwhere type = 1 \nand create_time>=\'2017-01-22\'',NULL,NULL,NULL,NULL,NULL,0,'0','2017-01-22 18:25:11','2017-02-14 10:45:53','zhangbingcan','zhangbingcan','3','dt',NULL),
	(356,'概览_漏斗模型','概览','财神_用户生命周期','DAILY','impala','\nselect\n   \'${V_STAT_DATE}\' as dt,\n   user_id,\n   action_type\nfrom (\nselect\n   user_id,\n  \'注册\' as action_type\nfrom rpt.v_cs_user\nwhere register_time >= date_sub(\'${V_END_DATE}\',7)\nunion all\nselect\n   ar.nono_user_id as user_id,\n  \'绑卡\' as action_type\nfrom odsopr.user_bind_card t1\nleft join odsopr.account_relation ar\nON t1.user_code = ar.merchant_user_id\nwhere ar.nono_user_id in (select user_id from rpt.v_cs_user where register_time >= date_sub(\'${V_END_DATE}\',7))\nunion all\nselect\n   user_id,\n  \'首投\' as action_type\nfrom rpt.v_cs_invest\nwhere invest_flag = 1\nand user_id in (select user_id from rpt.v_cs_user where register_time >= date_sub(\'${V_END_DATE}\',7))\nunion all\nselect\n   user_id,\n  \'复投\' as action_type\nfrom rpt.v_cs_invest\nwhere invest_flag = 2\nand user_id in (select user_id from rpt.v_cs_user where register_time >= date_sub(\'${V_END_DATE}\',7))\nunion all\nselect\n   user_id,\n  \'3投及以上\' as action_type\nfrom rpt.v_cs_invest\nwhere invest_flag = 3\nand user_id in (select user_id from rpt.v_cs_user where register_time >= date_sub(\'${V_END_DATE}\',7))\n) tt',NULL,'action_type',NULL,NULL,NULL,1,'1','2017-01-22 18:50:55','2017-01-23 14:17:32','liuhailiang','liuhailiang','1','dt',NULL),
	(357,'概览_每周净可用金','概览','财神_用户生命周期','DAILY','impala','  select\n    \'${V_STAT_DATE}\' as dt,\n    week_no_of_year,\n    net_amt\n  from rpt.v_cs_net\n  where fst_day_of_week >= date_sub(\'${V_END_DATE}\',161+(dayofweek(\'${V_END_DATE}\')-2))\n  and fst_day_of_week < \'${V_END_DATE}\'',NULL,'week_no_of_year',NULL,NULL,NULL,1,'1','2017-01-22 18:56:31','2017-01-23 13:03:51','liuhailiang','liuhailiang','1','dt',NULL),
	(358,'当日投资数据','投资','2017诺诺新年活动监控_投资','30MIN','nono','SELECT \n    service_time dt,\n    amount_payed amt,\n    user_id \n FROM\n (SELECT service_time,amount_payed,user_id \n    FROM db_nono.vip_form f\n    join db_nono.finance_plan fp\n    on f.fp_id = fp.id\n    WHERE service_status=1\n ) t1\n INNER JOIN db_nono.user_info t2 ON t1.user_id=t2.id\n WHERE t2.ID NOT IN(920272,1598,1600,1176674)\n AND t2.is_special<>1',NULL,NULL,NULL,NULL,NULL,0,'0','2017-01-22 19:35:38','2017-02-14 10:46:10','zhangbingcan','zhangbingcan','2','dt',NULL),
	(359,'概览_年度目标','概览','财神_用户生命周期','DAILY','impala','select\n  \'${V_STAT_DATE}\' as dt,\n  tt1.dt_1 as week_no,\n  tt1.total_usr_cnt, \n  tt2.total_net_amt\nfrom (\nselect\n  week_no_of_year                    as dt_1,\n  substr(week_no_of_year,6)          as dt,\n  total_usr_cnt\nfrom (\n    select\n      week_no_of_year,\n      trunc(invest_date,\'d\') as fst_day_of_week,\n      sum(count(user_id)) over(order by week_no_of_year) as total_usr_cnt\n    from rpt.v_cs_invest\n    where is_fst_invest = 1\n    and invest_date >= date_add(trunc(date_sub(\'${V_END_DATE}\',1),\'yy\'),1)\n    group by week_no_of_year,trunc(invest_date,\'d\')\n) tt\nwhere tt.fst_day_of_week >= date_sub(\'${V_END_DATE}\',77+(dayofweek(\'${V_END_DATE}\')-2))\nand tt.fst_day_of_week < \'${V_END_DATE}\'\n) tt1\nleft join (\n  select\n    tt.week_no_of_year as dt,\n    tt.total_net_amt\n  from (\n  select\n    week_no_of_year,\n    fst_day_of_week,\n    sum(net_amt) over(order by week_no_of_year) as total_net_amt\n  from rpt.v_cs_net\n  where fst_day_of_week >= trunc(\'${V_END_DATE}\',\'yy\')\n  ) tt\n  where tt.fst_day_of_week >= date_sub(\'${V_END_DATE}\',77+(dayofweek(\'${V_END_DATE}\')-2))\n  and tt.fst_day_of_week < \'${V_END_DATE}\'\n) tt2\non tt1.dt_1 = tt2.dt\n',NULL,'week_no',NULL,NULL,NULL,1,'1','2017-01-23 11:50:27','2017-01-23 13:05:18','liuhailiang','liuhailiang','0','dt',NULL),
	(360,'概览_登录用户','概览','财神_用户生命周期','DAILY','impala','SELECT \'${V_STAT_DATE}\' AS dt,\n        week_no_of_year,\n        user_code \nFROM rpt.v_cs_logon\nwhere logon_time >= DATE_SUB(\'${V_END_DATE}\',161+(DAYOFWEEK(\'${V_END_DATE}\')-2)) \nand  logon_time < \'${V_END_DATE}\'',NULL,'week_no_of_year',NULL,NULL,NULL,1,'1','2017-01-23 14:35:13','2017-01-23 14:42:57','liuhailiang','liuhailiang','1','dt',NULL),
	(361,'资金流动性_特殊帐户VIP_余额_净入金','投资','资金流动性_特殊帐户VIP_余额_净入金','HOURLY','nono','select curdate() as dt,hour(now()) as hh, invest_amt,d_invest_amt from (${V_SQL_PATTERN} \n) tx',126,'hh',NULL,NULL,NULL,1,'1','2017-02-15 16:07:19','2017-02-15 16:07:19','bofei','bofei','2','dt',NULL),
	(362,'资金流动性_诺诺待匹配_余额_净入金','投资','资金流动性_诺诺待匹配_余额_净入金','HOURLY','nono','select curdate() as dt,hour(now()) as hh, invest_amt,d_invest_amt from (${V_SQL_PATTERN} \n) tx',131,'hh',NULL,NULL,NULL,1,'1','2017-02-15 20:37:13','2017-02-15 20:37:13','bofei','bofei','2','dt',NULL),
	(363,'诺诺投资金额s','投资','技术中心大屏s','10MIN','nono','select \n	hour(dt) the_hour,floor(extract(minute from dt)/10)*10+10 as the_mins,\n	dt, inv_amt\nfrom \n	(${V_SQL_PATTERN}) as a',9,'the_hour','the_mins',NULL,NULL,2,'1','2017-02-17 15:38:01','2017-03-23 09:58:40','zhangbingcan','bofei','2','dt',NULL),
	(364,'诺诺提现金额s','投资','技术中心大屏s','10MIN','nono','select hour(dt) as the_hour,floor(extract(minute from dt)/10)*10+10 as the_mins,dt,with_amt from (${V_SQL_PATTERN}) as a',13,'the_hour','the_mins',NULL,NULL,2,'1','2017-02-17 15:38:01','2017-03-23 09:58:40','zhangbingcan','bofei','2','dt',NULL),
	(365,'诺诺充值金额s','投资','技术中心大屏s','10MIN','nono','select \n	hour(dt) the_hour,\n	floor(extract(minute from dt)/10)*10+10 as the_mins,\n	dt,\n	rech_amt\nfrom \n	(${V_SQL_PATTERN}) as a',67,'the_hour','the_mins',NULL,NULL,2,'1','2017-02-17 15:38:01','2017-03-13 20:33:23','zhangbingcan','bofei','2','dt',NULL),
	(366,'财神投资金额s','投资','技术中心大屏s','10MIN','caishen','select \n	hour(dt) the_hour,floor(extract(minute from dt)/10)*10+10 as the_mins,\n	dt,inv_amt\nfrom \n	(${V_SQL_PATTERN}) as a',19,'the_hour','the_mins',NULL,NULL,2,'1','2017-02-17 15:38:01','2017-03-23 09:58:40','zhangbingcan','bofei','2','dt',NULL),
	(367,'财神提现金额s','投资','技术中心大屏s','10MIN','caishen','select \n	hour(dt) the_hour,floor(extract(minute from dt)/10)*10+10 as the_mins,\n	dt,with_amt\nfrom \n	(${V_SQL_PATTERN}) as a',20,'the_hour','the_mins',NULL,NULL,2,'1','2017-02-17 15:38:01','2017-03-23 09:58:40','zhangbingcan','bofei','2','dt',NULL),
	(368,'财神充值金额s','投资','技术中心大屏s','10MIN','caishen','select \n	hour(dt) the_hour\n    ,floor(extract(minute from dt)/10)*10+10 as the_mins,\n	dt,\n     amount\nfrom \n	(${V_SQL_PATTERN}) as a',18,'the_hour','the_mins',NULL,NULL,2,'1','2017-02-17 15:38:01','2017-03-13 20:43:40','zhangbingcan','bofei','2','dt',NULL),
	(369,'还款金额s','资产端','技术中心大屏s','10MIN','nono','select \n	hour(br_repay_time) the_hour,floor(extract(minute from br_repay_time)/10)*10+10 as the_mins,\n	br_repay_time as dt,rep_principal_amt\nfrom \n	(${V_SQL_PATTERN}) as a',22,'the_hour','the_mins',NULL,NULL,2,'1','2017-02-17 15:38:01','2017-03-28 09:41:49','zhangbingcan','zhangbingcan','2','dt',NULL),
	(370,'诺诺注册人数s','注册','技术中心大屏s','10MIN','nono','select \n	hour(dt) the_hour,floor(extract(minute from dt)/10)*10+10 as the_mins,\n	dt\nfrom \n	(${V_SQL_PATTERN}) as a',116,'the_hour','the_mins',NULL,NULL,2,'0','2017-02-17 15:38:01','2017-02-17 15:39:24','zhangbingcan','zhangbingcan','2','dt',NULL),
	(371,'平台登录s','登录','技术中心大屏s','10MIN','archive','select \n	hour(logon_time) the_hour,floor(extract(minute from logon_time)/10)*10+10 as the_mins,\n	logon_time as dt,\n	logon_status\nfrom \n	(${V_SQL_PATTERN}) as a',132,'the_hour','the_mins',NULL,NULL,2,'1','2017-02-17 15:38:01','2017-03-23 09:58:40','zhangbingcan','bofei','2','dt',NULL),
	(372,'财神登录人数s','登录','技术中心大屏s','10MIN','caishen','select \n	hour(dt) the_hour,floor(extract(minute from dt)/10)*10+10 as the_mins,\n	dt,\n	user_code\nfrom \n	(${V_SQL_PATTERN}) as a',68,'the_hour','the_mins',NULL,NULL,2,'0','2017-02-17 15:38:01','2017-02-17 15:39:24','zhangbingcan','zhangbingcan','2','dt',NULL),
	(373,'放款金额s','资产端','技术中心大屏s','10MIN','nono','select \n	hour(dt) the_hour,floor(extract(minute from dt)/10)*10+10 as the_mins,\n	dt,bo_amt\nfrom \n	(${V_SQL_PATTERN}) as a',21,'the_hour','the_mins',NULL,NULL,2,'1','2017-02-17 15:38:01','2017-03-23 09:58:40','zhangbingcan','bofei','2','dt',NULL),
	(374,'诺诺PVs','PV','技术中心大屏s','30MIN','impala','select \nrun_time as dt,\nsubstr(run_time,12,2) as the_hour\nfrom ( ${V_SQL_PATTERN} ) ta\nwhere run_time <=now()',99,'the_hour',NULL,NULL,NULL,1,'0','2017-02-17 15:38:01','2017-02-17 15:39:24','zhangbingcan','zhangbingcan','2','dt',NULL),
	(378,'用户活跃度','活跃度','诺诺_用户活跃度','DAILY','impala','select \n  \'${V_STAT_DATE}\' as dt,\n  cast(user_category as string) as user_category,\n  case\n    when user_category = 1 \n    then \'新用户\'\n    when user_category = 2\n    then \'活跃用户\'\n    when user_category = 3 \n    then \'忠诚用户\'\n    when user_category = 4 \n    then \'沉默用户\'\n    when user_category = 5 \n    then \'僵尸用户\'\n    else \'<未知>\'\n  end user_category_cn, \n  user_id\nfrom dmt.fact_nono_user_activity_level\nwhere stat_date = \'${V_STAT_DATE}\'',NULL,'user_category','user_category_cn',NULL,NULL,2,'1','2017-02-28 15:27:15','2017-02-28 16:21:49','liuhailiang','liuhailiang','0','dt',NULL),
	(379,'平台交易1','交易','技术中心大屏s','10MIN','nono','select hour(create_time) as the_hour\n,floor(extract(minute from create_time)/10)*10+10 as the_mins\n,create_time as dt\n,TransStatus\n,OrderAmount \nfrom (${V_SQL_PATTERN}) as a',136,'the_hour','the_mins',NULL,NULL,2,'1','2017-02-28 15:51:04','2017-06-29 11:25:59','zhangbingcan','huangyuangang','2','dt',NULL),
	(384,'平台交易2','交易','技术中心大屏s','10MIN','nono','select hour(create_time) as the_hour\n,floor(extract(minute from create_time)/10)*10+10 as the_mins\n,create_time as dt\n,pay_amount\n,result_code \nfrom (${V_SQL_PATTERN}) as a',135,'the_hour','the_mins',NULL,NULL,2,'1','2017-02-28 16:04:45','2017-03-23 09:58:40','zhangbingcan','bofei','2','dt',NULL),
	(388,'待匹配指数s','交易','技术中心大屏s','10MIN','nono','select \n	hour(create_time) the_hour,floor(extract(minute from create_time)/10)*10+10 as the_mins,\n	create_time as dt,\n	unmatched\nfrom \n	(${V_SQL_PATTERN}) as a',138,'the_hour','the_mins',NULL,NULL,2,'0','2017-03-01 10:26:39','2017-03-01 13:46:59','zhangbingcan','zhangbingcan','2','dt',NULL),
	(389,'诺诺可售债券s','产品','技术中心大屏s','10MIN','nono','select \n	hour(dt) the_hour,floor(extract(minute from dt)/10)*10+10 as the_mins,\n	dt,\n	price_left\nfrom \n	(select \n	price,\n	price_finish,\n	price - price_finish as price_left,\n	now() as dt\nfrom db_nono.finance_plan\nwhere date(publish_date) = start_date \nand start_date = curdate()) as a',NULL,'the_hour','the_mins',NULL,NULL,2,'1','2017-03-02 10:00:39','2017-03-23 09:58:40','zhangbingcan','bofei','2','dt',NULL),
	(390,'概览_投资总数','概览','诺诺_用户生命周期','DAILY','hive',' select\n   \'${V_STAT_DATE}\' as dt,\n   user_id,\n   count(*) as inv_cnt\n from rpt.v_nono_invest\n where invest_time <= \'${V_END_DATE}\'\n group by user_id',NULL,NULL,NULL,NULL,NULL,0,'1','2017-03-06 19:29:55','2017-03-06 19:29:55','SYS','SYS','0','dt',NULL),
	(391,'概览_投资次数分布','概览','诺诺_用户生命周期','DAILY','hive','select \n  \'${V_STAT_DATE}\' as dt,\n  user_id,\n  case\n    when inv_cnt = 1\n    then \'首投用户\'\n    when inv_cnt = 2\n    then \'复投用户\'\n    else \'3次及以上\'\n  end inv_cnt_range\nfrom (\nselect\n  user_id,\n  count(*) as inv_cnt\nfrom rpt.v_nono_invest\nwhere invest_time >= date_sub(substr(from_unixtime(unix_timestamp()),1,10),7)\nand invest_time < \'${V_END_DATE}\'\ngroup by user_id\n) tt ',NULL,'inv_cnt_range',NULL,NULL,NULL,1,'1','2017-03-06 19:39:56','2017-03-06 19:39:56','SYS','SYS','0','dt',NULL),
	(392,'概览_首投转化率','概览','诺诺_用户生命周期','DAILY','impala','select\n  \'${V_STAT_DATE}\' as dt,\n  t1.week_no_of_year,           \n  t1.user_id,                  \n  t2.d0,                       \n  t2.d3,                      \n  t2.d7,\n  t2.d30,\n  t2.dx\nfrom rpt.v_nono_user t1\nleft join (\n  select\n   user_id,\n   case\n     when register_interval = 0\n     then 1\n     else 0\n   end d0,\n   case\n     when register_interval <= 3\n     then 1\n     else 0\n   end d3,\n   case\n     when register_interval <= 7\n     then 1\n     else 0\n   end d7,\n   case\n     when register_interval <= 30\n     then 1\n     else 0\n   end d30,\n   1 as dx\nfrom rpt.v_nono_invest\nwhere is_fst_invest = 1\n) t2\non t1.user_id = t2.user_id\nwhere t1.register_date >= date_sub(current_timestamp(),77+(dayofweek(current_timestamp())-2))\nand t1.register_date < \'${V_END_DATE}\'\n',NULL,'week_no_of_year',NULL,NULL,NULL,1,'1','2017-03-06 19:47:26','2017-03-06 19:47:26','SYS','SYS','0','dt',NULL),
	(393,'概览_年度目标','概览','诺诺_用户生命周期','DAILY','impala','select\n  \'${V_STAT_DATE}\' as dt,\n  tt1.dt_1 as week_no,\n  tt1.total_usr_cnt, \n  tt2.total_net_amt\nfrom (\nselect\n  week_no_of_year                    as dt_1,\n  substr(week_no_of_year,6)          as dt,\n  total_usr_cnt\nfrom (\n    select\n      week_no_of_year,\n      trunc(invest_date,\'d\') as fst_day_of_week,\n      sum(count(user_id)) over(order by week_no_of_year) as total_usr_cnt\n    from rpt.v_nono_invest\n    where is_fst_invest = 1\n    and invest_date >= date_add(trunc(date_sub(\'${V_END_DATE}\',1),\'yy\'),1)\n    group by week_no_of_year,trunc(invest_date,\'d\')\n) tt\nwhere tt.fst_day_of_week >= date_sub(\'${V_END_DATE}\',77+(dayofweek(\'${V_END_DATE}\')-2))\nand tt.fst_day_of_week < \'${V_END_DATE}\'\n) tt1\nleft join (\n  select\n    tt.week_no_of_year as dt,\n    tt.total_net_amt\n  from (\n  select\n    week_no_of_year,\n    fst_day_of_week,\n    sum(net_amt) over(order by week_no_of_year) as total_net_amt\n  from rpt.v_nono_net\n  where fst_day_of_week >= trunc(\'${V_END_DATE}\',\'yy\')\n  ) tt\n  where tt.fst_day_of_week >= date_sub(\'${V_END_DATE}\',77+(dayofweek(\'${V_END_DATE}\')-2))\n  and tt.fst_day_of_week < \'${V_END_DATE}\'\n) tt2\non tt1.dt_1 = tt2.dt\n',NULL,'week_no',NULL,NULL,NULL,1,'1','2017-03-06 19:51:50','2017-03-06 19:51:50','SYS','SYS','0','dt',NULL),
	(394,'概览_每周入金','概览','诺诺_用户生命周期','DAILY','impala','select \n  \'${V_STAT_DATE}\' as dt,\n  week_no_of_year,\n  invest_amt\nfrom rpt.v_nono_invest \nwhere invest_date >= date_sub(\'${V_END_DATE}\',77+(dayofweek(\'${V_END_DATE}\')-2)) \nand invest_date < \'${V_END_DATE}\'',NULL,'week_no_of_year',NULL,NULL,NULL,1,'1','2017-03-06 19:56:07','2017-03-06 19:56:07','SYS','SYS','0','dt',NULL),
	(395,'概览_每周净可用金','概览','诺诺_用户生命周期','DAILY','impala','  select\n    \'${V_STAT_DATE}\' as dt,\n    week_no_of_year,\n    net_amt_2\n  from rpt.v_nono_net\n  where fst_day_of_week >= date_sub(\'${V_END_DATE}\',161+(dayofweek(\'${V_END_DATE}\')-2))\n  and fst_day_of_week < \'${V_END_DATE}\'',NULL,'week_no_of_year',NULL,NULL,NULL,1,'1','2017-03-06 19:58:06','2017-03-08 14:50:33','SYS','liuhailiang','0','dt',NULL),
	(396,'概览_每周结算','概览','诺诺_用户生命周期','DAILY','impala','select \n  \'${V_STAT_DATE}\' as dt,\n  actual_week_no_of_year,\n  cash_principal\nfrom rpt.v_nono_cash\nwhere actual_accept_time >= date_sub(\'${V_END_DATE}\',77+(dayofweek(\'${V_END_DATE}\')-2)) \nand actual_accept_time < \'${V_END_DATE}\'',NULL,'actual_week_no_of_year',NULL,NULL,NULL,1,'1','2017-03-06 20:00:10','2017-03-06 20:00:10','SYS','SYS','0','dt',NULL),
	(397,'概览_漏斗模型','概览','诺诺_用户生命周期','DAILY','impala','select\n    \'${V_STAT_DATE}\' as dt,\n    action_type,\n    user_id\nfrom (\nselect\n   user_id,\n  \'注册\' as action_type\nfrom rpt.v_nono_user\nwhere register_time >= date_sub(\'${V_END_DATE}\',7)\nunion all\nselect\n  user_id,\n  \'绑卡\' as action_type\nfrom odsopr.user_bankcard_auth\nwhere user_id in (select user_id from rpt.v_nono_user where register_time >= date_sub(\'${V_END_DATE}\',7))\nunion all\nselect\n  user_id,\n  \'首投\' as action_type\nfrom rpt.v_nono_invest\nwhere invest_flag = 1\nand user_id in (select user_id from rpt.v_nono_user where register_time >= date_sub(\'${V_END_DATE}\',7))\nunion all\nselect\n  user_id,\n  \'复投\' as action_type\nfrom rpt.v_nono_invest\nwhere invest_flag = 2\nand user_id in (select user_id from rpt.v_nono_user where register_time >= date_sub(\'${V_END_DATE}\',7))\nunion all\nselect\n  user_id,\n  \'3投及以上\' as action_type\nfrom rpt.v_nono_invest\nwhere invest_flag = 3\nand user_id in (select user_id from rpt.v_nono_user where register_time >= date_sub(\'${V_END_DATE}\',7))\n) tt',NULL,'action_type',NULL,NULL,NULL,1,'1','2017-03-06 20:02:40','2017-03-14 10:23:53','SYS','liuhailiang','0','dt',NULL),
	(398,'概览_即将结算','概览','诺诺_用户生命周期','DAILY','impala','select \n  \'${V_STAT_DATE}\' as dt,\n  plan_week_no_of_year,\n  cash_principal\nfrom rpt.v_nono_cash\nwhere plan_accept_time >= date_sub(\'${V_END_DATE}\',dayofweek(\'${V_END_DATE}\')-2) \nand plan_accept_time < date_add(\'${V_END_DATE}\',77+( 7-(dayofweek(\'${V_END_DATE}\')-2) ))\nand accept_status = 0',NULL,'plan_week_no_of_year',NULL,NULL,NULL,1,'1','2017-03-06 20:05:28','2017-03-07 14:42:10','SYS','liuhailiang','0','dt',NULL),
	(399,'概览_复投转化率','概览','诺诺_用户生命周期','DAILY','impala','select\n  \'${V_STAT_DATE}\' as dt,\n  dd.week_of_year2,\n  t2.d0,\n  t2.d3,\n  t2.d7,\n  t2.d30,\n  t2.dx,\n  t1.user_id\nfrom rpt.v_nono_user t1\nleft join (\n  select\n   user_id,\n   case\n     when fst_invest_interval = 0\n     then 1\n     else 0\n   end d0,\n   case\n     when fst_invest_interval <= 3\n     then 1\n     else 0\n   end d3,\n   case\n     when fst_invest_interval <= 7\n     then 1\n     else 0\n   end d7,\n   case\n     when fst_invest_interval <= 30\n     then 1\n     else 0\n   end d30,\n   1 as dx\nfrom rpt.v_nono_invest\nwhere is_sec_invest = 1\n) t2\non t1.user_id = t2.user_id\nleft join rpt.v_dim_date dd\non regexp_replace(substr(t1.first_invest_time,1,10),\"\\\\-\",\"\") = dd.day_id\nwhere t1.first_invest_time is not null\nand t1.first_invest_time >= date_sub(\'${V_END_DATE}\',77+(dayofweek(\'${V_END_DATE}\')-2))\nand t1.first_invest_time < \'${V_END_DATE}\'',NULL,'week_of_year2',NULL,NULL,NULL,1,'1','2017-03-06 20:09:26','2017-03-06 20:09:26','SYS','SYS','0','dt',NULL),
	(400,'概览_APP版本分布','概览','诺诺_用户生命周期','DAILY','impala','select\n   \'${V_STAT_DATE}\' as dt,\n   dt.week_of_year2,\n   app_version,\n   user_id\nfrom  ods.log_app_text lat\njoin rpt.v_dim_date  dt\non dt.day_short_desc = trunc(lat.run_time,\'DD\')\nwhere run_time < \'${V_END_DATE}\'\nand run_time > date_sub(\'${V_END_DATE}\',77+(dayofweek(\'${V_END_DATE}\')-2)) \nand platform_name = \'诺诺镑客APP\'\nand user_id is not null',NULL,'week_of_year2','app_version',NULL,NULL,2,'1','2017-03-07 13:44:07','2017-03-07 15:53:11','liuhailiang','admin','0','dt',NULL),
	(401,'概览_登录用户','概览','诺诺_用户生命周期','DAILY','impala','select \n  \'${V_STAT_DATE}\' as dt,\n  week_of_year2,\n  user_id\nfrom ods.log_app_text lat\njoin rpt.v_dim_date dt\non dt.day_short_desc = trunc(lat.run_time,\'DD\')\nwhere run_time < \'${V_END_DATE}\' \nand  run_time > date_sub(\'${V_END_DATE}\',77+(dayofweek(\'${V_END_DATE}\')-2))\nand platform_name = \'诺诺镑客APP\'\n',NULL,'week_of_year2',NULL,NULL,NULL,1,'1','2017-03-07 13:53:41','2017-03-07 14:28:00','liuhailiang','liuhailiang','0','dt',NULL),
	(402,'概览_即将还款','概览','诺诺_用户生命周期','DAILY','impala','select\n  \'${V_STAT_DATE}\' as dt,\n  plan_week_no_of_year,\n  repay_principal\nfrom rpt.v_nono_repay\nwhere plan_repay_time >= date_sub(to_date(\'${V_END_DATE}\'),dayofweek(\'${V_END_DATE}\')-2) \nand plan_repay_time < date_add(to_date(\'${V_END_DATE}\'),77+( 7-(dayofweek(\'${V_END_DATE}\')-2) ))\nand repay_status = 0',NULL,'plan_week_no_of_year',NULL,NULL,NULL,1,'1','2017-03-07 13:59:34','2017-03-07 13:59:34','liuhailiang','liuhailiang','0','dt',NULL),
	(403,'概览_活跃终端','概览','诺诺_用户生命周期','DAILY','impala','select\n  \'${V_STAT_DATE}\' as dt,\n  dt.week_of_year2,\n  concat(imei,idfa) as device_id\nfrom ods.log_app_text lat\njoin rpt.v_dim_date dt\non dt.day_short_desc = trunc(lat.run_time,\'DD\')\nwhere run_time < \'${V_END_DATE}\' \nand  run_time > date_sub(\'${V_END_DATE}\',77+(dayofweek(\'${V_END_DATE}\')-2))\nand platform_name = \'诺诺镑客APP\'',NULL,'week_of_year2',NULL,NULL,NULL,1,'1','2017-03-07 14:05:27','2017-03-07 15:50:18','liuhailiang','admin','0','dt',NULL),
	(406,'平台账户余额（不含财神）','余额','技术中心大屏s','10MIN','nono','select \n	hour(now()) the_hour,floor(extract(minute from now())/10)*10+10 as the_mins,\n	now() as dt,\n	amount\nfrom \n	(${V_SQL_PATTERN}) as a ',147,'the_hour','the_mins',NULL,NULL,2,'1','2017-03-08 17:33:50','2017-03-23 09:58:40','zhangbingcan','bofei','2','dt',NULL),
	(409,'财神余额','余额','技术中心大屏s','10MIN','caishen','select \n	hour(now()) the_hour,floor(extract(minute from now())/10)*10+10 as the_mins,\n	now() as dt,\n	amount\nfrom \n	(${V_SQL_PATTERN}) as a ',101,'the_hour','the_mins',NULL,NULL,2,'1','2017-03-08 17:41:48','2017-03-23 09:58:40','zhangbingcan','bofei','2','dt',NULL),
	(410,'诺诺当日累计充值金额s','投资','技术中心大屏s','10MIN','nono','select \n\'${V_BEGIN_DATE}\' as dt,tt.hh as the_hour,tt.mi as the_mins,sum(td.rech_amt) as rech_amt\nfrom \n(select th.hh,tm.mi,th.hh*100+tm.mi as hhmi from \n(SELECT 0 AS hh UNION ALL SELECT 1 UNION ALL SELECT 2 UNION ALL SELECT 3 UNION ALL SELECT 4 UNION ALL SELECT 5 UNION ALL SELECT 6 UNION ALL SELECT 7 UNION ALL SELECT 8 UNION ALL SELECT 9\n				UNION ALL SELECT 10  UNION ALL SELECT 11  UNION ALL SELECT 12  UNION ALL SELECT 13  UNION ALL SELECT 14  UNION ALL SELECT 15  UNION ALL SELECT 16  UNION ALL SELECT 17  UNION ALL SELECT 18\n                 UNION ALL SELECT 19  UNION ALL SELECT 20  UNION ALL SELECT 21  UNION ALL SELECT 22  UNION ALL SELECT 23 ) th,\n (select 10 as mi union all select 20 union all select 30 union all select 40 union all select 50 union all select 60) tm) tt,\n(select \n    hour(dt) * 100 + floor(extract(minute from dt)/10)*10+10 as hhmi,\n	sum(rech_amt) as rech_amt\nfrom \n	(${V_SQL_PATTERN}) as a\n    group by hour(dt) * 100 + floor(extract(minute from dt)/10)*10+10\n    )  td\n    where td.hhmi<=tt.hhmi\n    and if(curdate()=\'${V_BEGIN_DATE}\',tt.hhmi<=(hour(now())*100+floor(extract(minute from now())/10)*10+10),1=1)\n    group by tt.hh,tt.mi,tt.hhmi\n    order by tt.hh,tt.mi',67,'the_hour','the_mins',NULL,NULL,2,'0','2017-03-13 20:33:23','2017-03-23 09:58:41','bofei','bofei','2','dt',NULL),
	(411,'财神当日累计充值金额s','投资','技术中心大屏s','10MIN','caishen','	select \n\'${V_BEGIN_DATE}\' as dt,tt.hh as the_hour,tt.mi as the_mins,sum(td.rech_amt) as rech_amt\nfrom \n(select th.hh,tm.mi,th.hh*100+tm.mi as hhmi from \n(SELECT 0 AS hh UNION ALL SELECT 1 UNION ALL SELECT 2 UNION ALL SELECT 3 UNION ALL SELECT 4 UNION ALL SELECT 5 UNION ALL SELECT 6 UNION ALL SELECT 7 UNION ALL SELECT 8 UNION ALL SELECT 9\n				UNION ALL SELECT 10  UNION ALL SELECT 11  UNION ALL SELECT 12  UNION ALL SELECT 13  UNION ALL SELECT 14  UNION ALL SELECT 15  UNION ALL SELECT 16  UNION ALL SELECT 17  UNION ALL SELECT 18\n                 UNION ALL SELECT 19  UNION ALL SELECT 20  UNION ALL SELECT 21  UNION ALL SELECT 22  UNION ALL SELECT 23 ) th,\n (select 10 as mi union all select 20 union all select 30 union all select 40 union all select 50 union all select 60) tm) tt,\n(select \n    hour(dt) * 100 + floor(extract(minute from dt)/10)*10+10 as hhmi,\n	sum(amount) as rech_amt\nfrom \n	(${V_SQL_PATTERN}) as a\n    group by hour(dt) * 100 + floor(extract(minute from dt)/10)*10+10\n    )  td\n    where td.hhmi<=tt.hhmi\n    and if(curdate()=\'${V_BEGIN_DATE}\',tt.hhmi<=(hour(now())*100+floor(extract(minute from now())/10)*10+10),1=1)\n    group by tt.hh,tt.mi,tt.hhmi\n    order by tt.hh,tt.mi',18,'the_hour','the_mins',NULL,NULL,2,'0','2017-03-13 20:43:40','2017-03-23 09:58:41','bofei','bofei','2','dt',NULL),
	(412,'账户余额','xcw','xcw_各账户余额','DAILY','impala','SELECT  \n\'${V_STAT_DATE}\' stat_date,\nCASE WHEN ba.is_vip=0 AND ba.user_id NOT IN(920272,1598,1600) THEN \"诺诺散标债转\" \nWHEN ba.is_vip=1 AND ba.user_id NOT IN(920272,1598,1600) AND fp.scope IN(11,15)  THEN CONCAT(\"诺诺\",fps.label)\nWHEN ba.is_vip=1 AND ba.user_id NOT IN(920272,1598,1600) AND va.id IS NOT NULL  THEN \"诺诺精选\"\nWHEN  ba.user_id  IN(1598,1600)  THEN \"诺诺丁虹丁建才\"\nWHEN  dpb.dp_type=3 THEN \"曾凤-财神爷爷\" WHEN  dpb.dp_type IS NOT NULL THEN \"曾凤-自身\" WHEN  ba.user_id=920272 THEN \"曾凤-自身\"\nELSE \"其他\" END kind,\nIF(ba.is_pay=0,price_principal,0) as remaining_price_b,\n-- ROUND(SUM(IF(ba.is_pay=0,price_principal,0))/1,2) remaining_price_b,\nIF(fp.scope IN(11,15) AND va.is_cash=0 AND ba.is_pay=1,price_interest*owner_rate,0) as remaining_price_l\n--ROUND(SUM(IF(fp.scope IN(11,15) AND va.is_cash=0 AND ba.is_pay=1,price_interest*owner_rate,0))/1,2) remaining_price_l\nFROM odsopr.borrows_accept ba \nJOIN odsopr.borrows bo ON bo.id=ba.bo_id AND bo.bo_is_success=1\nLEFT JOIN odsopr.vip_account va ON va.id=ba.va_id LEFT JOIN odsopr.finance_plan fp ON fp.id=va.fp_id \nLEFT JOIN odsopr.finance_plan_scope fps ON fps.id=fp.scope\nLEFT JOIN (SELECT dpb.bo_id,dp.dp_type,COUNT(1) n\nFROM odsopr.debt_package_borrows dpb\nJOIN odsopr.debt_package dp ON dp.id=dpb.dp_id\nGROUP BY dpb.bo_id,dp.dp_type\n)dpb ON dpb.bo_id=ba.bo_id\nWHERE ba.price>0 ',NULL,'kind',NULL,NULL,NULL,1,'1','2017-03-21 09:15:04','2017-03-21 09:15:04','admin','admin','0','stat_date',NULL),
	(413,'精选购买金额','投资','资金平台监控（资金交易技术组）','10MIN','nono','select hour(dt) as the_hour,\nfloor(extract(minute from dt)/10)*10+10 as the_mins,\ndt ,\namt\nfrom (\nselect amount as amt,service_time as dt from db_nono.vip_form \nwhere service_status=1\n) as a',NULL,'the_hour','the_mins',NULL,NULL,2,'1','2017-03-21 18:47:31','2017-03-22 09:28:05','zhangbingcan','zhangbingcan','2','dt',NULL),
	(416,'精选结算金额','兑付','资金平台监控（资金交易技术组）','10MIN','nono','select hour(dt) as the_hour,\nfloor(extract(minute from dt)/10)*10+10 as the_mins,\ndt,\namt\nfrom (\nselect amount as amt, cash_time as dt from db_nono.vip_account where is_cash=1\n) as a',NULL,'the_hour','the_mins',NULL,NULL,2,'1','2017-03-22 09:28:05','2017-03-22 09:28:05','zhangbingcan','zhangbingcan','2','dt',NULL),
	(417,'贷款放款金额','资产端','资金平台监控（资金交易技术组）','10MIN','nono','select hour(dt) as the_hour,\nfloor(extract(minute from dt)/10)*10+10 as the_mins,\ndt,\namt\nfrom (\nselect wc.price as amt, create_time as dt from db_nono.withdraw_cash wc where wc.bo_id is not null\n) as a',NULL,'the_hour','the_mins',NULL,NULL,2,'1','2017-03-22 09:33:16','2017-03-22 09:33:16','zhangbingcan','zhangbingcan','2','dt',NULL),
	(418,'贷款还款金额','资产端','资金平台监控（资金交易技术组）','10MIN','nono','select hour(dt) as the_hour,\nfloor(extract(minute from dt)/10)*10+10 as the_mins,\ndt,\namt\nfrom (\nselect br_price as amt, br_repay_time as dt from db_nono.borrows_repayment where br_is_repay=1 \n) as a',NULL,'the_hour','the_mins',NULL,NULL,2,'1','2017-03-22 09:38:34','2017-03-22 09:38:34','zhangbingcan','zhangbingcan','2','dt',NULL),
	(419,'快钱(new)支付成功次数','资产端','资金平台监控（资金交易技术组）','10MIN','nono','select hour(dt) as the_hour,\nfloor(extract(minute from dt)/10)*10+10 as the_mins,\ndt,\namt\nfrom (\nselect member_id as user_id,pay_amount as amt,create_time as dt from db_nono_pay.tb_pay_record where pay_amount>0 and provider=\'_99BILL_FASTPAY\' and `status`=\'PAID\'\n) as a',NULL,'the_hour','the_mins',NULL,NULL,2,'1','2017-03-22 10:04:39','2017-03-22 10:04:39','zhangbingcan','zhangbingcan','2','dt',NULL),
	(422,'快钱(new)支付失败次数','资产端','资金平台监控（资金交易技术组）','10MIN','nono','select hour(dt) as the_hour,\nfloor(extract(minute from dt)/10)*10+10 as the_mins,\ndt,\namt\nfrom (\nSELECT t.pay_amount as amt,\n	 t.member_id as user_id,\n	 tl.order_no,\n	 t.create_time dt\nFROM   db_nono_pay.tb_pay_record t\nJOIN db_nono_pay.tb_pay_record_log tl\n  ON t.order_no = tl.order_no\nWHERE  t.provider = \'_99BILL_FASTPAY\' AND\n	 product_type <> \'AUTO_AUTH\' AND\n	 `status` NOT IN ( \'PAID\', \'APPLY\', \'DRAFT\' ) AND\n	  tl.result_code not in ( \'51\', \'61\' ) \n) as a',NULL,'the_hour','the_mins',NULL,NULL,2,'1','2017-03-22 12:04:07','2017-03-22 12:04:07','zhangbingcan','zhangbingcan','2','dt',NULL),
	(423,'快钱(old)支付成功','资产端','资金平台监控（资金交易技术组）','10MIN','nono','select hour(dt) as the_hour,\nfloor(extract(minute from dt)/10)*10+10 as the_mins,\ndt,\namt\nfrom (\nselect user_id,amount amt,create_time dt from db_nono.kuaiq_orders where order_status=1 and product_type <> \'10\' \n) as a',NULL,'the_hour','the_mins',NULL,NULL,2,'1','2017-03-22 16:52:43','2017-03-22 17:27:07','zhangbingcan','zhangbingcan','2','dt',NULL),
	(424,'快钱(old)支付失败次数','资产端','资金平台监控（资金交易技术组）','10MIN','nono','select hour(dt) as the_hour,\nfloor(extract(minute from dt)/10)*10+10 as the_mins,\ndt,\namt\nfrom (\nselect ko.user_id,ko.amount as amt,ko.create_time dt\nfrom db_nono.kuaiq_orders ko\nleft join db_nono.kuaiq_recharge_logs krl on krl.orders_id=ko.orders_id\nwhere ko.product_type<>10 \nand ko.order_status not in (0,1)\nand (krl.receive_status not in (\'51\',\'61\') or krl.receive_status is null)\nand ko.create_time>=\'${V_BEGIN_DATE}\'\nand ko.create_time<\'${V_END_DATE}\'\n) as a',NULL,'the_hour','the_mins',NULL,NULL,2,'1','2017-03-22 17:09:43','2017-04-05 10:02:30','zhangbingcan','bofei','2','dt',NULL),
	(425,'连连支付成功','资产端','资金平台监控（资金交易技术组）','10MIN','nono','select hour(dt) as the_hour,\nfloor(extract(minute from dt)/10)*10+10 as the_mins,\ndt,\namt\nfrom (\nselect member_id as user_id,pay_amount as amt,create_time as dt from db_nono_pay.tb_pay_record where pay_amount>0 and provider=\'LL_FASTPAY\' and `status`=\'PAID\' \n) as a',NULL,'the_hour','the_mins',NULL,NULL,2,'1','2017-03-22 17:27:07','2017-03-22 17:27:07','zhangbingcan','zhangbingcan','2','dt',NULL),
	(426,'连连支付失败次数','资产端','资金平台监控（资金交易技术组）','10MIN','nono','select hour(dt) as the_hour,\nfloor(extract(minute from dt)/10)*10+10 as the_mins,\ndt,\namt\nfrom (\nselect pay_amount as amt, create_time as dt from db_nono_pay.tb_pay_record where pay_amount>0 and provider=\'LL_FASTPAY\' and `status`<>\'PAID\'\n) as a',NULL,'the_hour','the_mins',NULL,NULL,2,'1','2017-03-23 13:19:43','2017-03-23 13:19:43','zhangbingcan','zhangbingcan','2','dt',NULL),
	(427,'宝付支付','资产端','资金平台监控（资金交易技术组）','10MIN','nono','select hour(dt) as the_hour,\nfloor(extract(minute from dt)/10)*10+10 as the_mins,\ndt,\namt,\nst\nfrom (\nselect pay_amount as amt,create_time as dt,`status` as st from db_nono_pay.tb_pay_record where pay_amount>0 and (provider=\'BAOFOO_PAY_FOUR_ELEMENT\' or provider=\'BAOFOO_FASTPAY\')\n) as a',NULL,'the_hour','the_mins',NULL,NULL,2,'1','2017-03-23 13:30:57','2017-03-23 13:30:57','zhangbingcan','zhangbingcan','2','dt',NULL),
	(428,'微信支付','资产端','资金平台监控（资金交易技术组）','10MIN','nono','select hour(dt) as the_hour,\nfloor(extract(minute from dt)/10)*10+10 as the_mins,\ndt,\namt,\nst\nfrom (\nselect pay_amount as amt,create_time as dt,`status` as st from db_nono_pay.tb_pay_record where pay_amount>0 and provider=\'WECHATDIRECT_PAY\'\n) as a',NULL,'the_hour','the_mins',NULL,NULL,2,'1','2017-03-23 13:40:55','2017-03-23 13:40:55','zhangbingcan','zhangbingcan','2','dt',NULL),
	(429,'钱方支付','投资','资金平台监控（资金交易技术组）','10MIN','nono','select hour(dt) as the_hour,\nfloor(extract(minute from dt)/10)*10+10 as the_mins,\ndt,\namt,\nst\nfrom (\nselect pay_amount as amt,create_time as dt,`status` as st from db_nono_pay.tb_pay_record where pay_amount>0 and provider=\'QTB_PAY\'\n) as a',NULL,'the_hour','the_mins',NULL,NULL,2,'1','2017-03-23 13:47:59','2017-03-23 13:47:59','zhangbingcan','zhangbingcan','2','dt',NULL),
	(430,'宝付网银支付','投资','资金平台监控（资金交易技术组）','10MIN','nono','select hour(dt) as the_hour,\nfloor(extract(minute from dt)/10)*10+10 as the_mins,\ndt,\namt,\nst\nfrom (\nselect pay_amount as amt,create_time as dt,`status` as st from db_nono_pay.tb_pay_record where pay_amount>0 and provider=\'BAOFOO_ONLINE_PAY\'\n) as a',NULL,'the_hour','the_mins',NULL,NULL,2,'1','2017-03-23 13:52:45','2017-03-23 13:52:45','zhangbingcan','zhangbingcan','2','dt',NULL),
	(431,'盛付通网银支付','投资','资金平台监控（资金交易技术组）','10MIN','nono','select hour(dt) as the_hour,\nfloor(extract(minute from dt)/10)*10+10 as the_mins,\ndt,\namt,\nst\nfrom (\nselect OrderAmount as amt,create_time as dt,TransStatus as st from db_nono.sft_recharges \n) as a',NULL,'the_hour','the_mins',NULL,NULL,2,'1','2017-03-23 14:00:38','2017-03-23 14:00:38','zhangbingcan','zhangbingcan','2','dt',NULL),
	(432,'非名校贷提现','资产端','资金平台监控（资金交易技术组）','10MIN','nono','select hour(dt) as the_hour,\nfloor(extract(minute from dt)/10)*10+10 as the_mins,\ndt,\namt\nfrom (\nselect wc.price as amt,create_time as dt from db_nono.withdraw_cash wc where wc.bo_id is null\n) as a',NULL,'the_hour','the_mins',NULL,NULL,2,'1','2017-03-23 14:26:20','2017-03-23 14:26:20','zhangbingcan','zhangbingcan','2','dt',NULL),
	(433,'注册发券','注册','资金平台监控（产品交易技术组）','10MIN','nono','select hour(dt) as the_hour,\nfloor(extract(minute from dt)/10)*10+10 as the_mins,\ndt,\namt\nfrom (\nselect muc.user_id, muc.value as amt,muc.create_time as dt from db_nono.mkt_register_event_info rei   \njoin db_nono.mkt_user_coupon muc on rei.send_proof_id=muc.proof_id\n) as a',NULL,'the_hour','the_mins',NULL,NULL,2,'1','2017-03-24 13:28:02','2017-03-24 13:28:02','zhangbingcan','zhangbingcan','2','dt',NULL),
	(434,'诺诺盈投资','投资','资金平台监控（产品交易技术组）','10MIN','nono','select hour(dt) as the_hour,\nfloor(extract(minute from dt)/10)*10+10 as the_mins,\ndt,\namt\nfrom (\nSELECT user_id,price as amt,pay_time as dt FROM db_nono.borrows_bidding\nWHERE is_vip = 0 AND auto = 0 AND reason = \'诺诺盈\' AND status IN (1, 2)\n) as a',NULL,'the_hour','the_mins',NULL,NULL,2,'1','2017-03-24 13:37:56','2017-03-24 13:37:56','zhangbingcan','zhangbingcan','2','dt',NULL),
	(435,'月月升投资','投资','资金平台监控（产品交易技术组）','10MIN','nono','select hour(dt) as the_hour,\nfloor(extract(minute from dt)/10)*10+10 as the_mins,\ndt,\namt\nfrom (\nSELECT vf.user_id,vf.amount_payed as amt,vf.service_time as dt\nFROM  db_nono.vip_form vf JOIN  db_nono.finance_plan fp ON vf.fp_id = fp.id\nWHERE fp.scope = 15 AND vf.service_status = 1\n) as a',NULL,'the_hour','the_mins',NULL,NULL,2,'1','2017-03-24 13:44:20','2017-03-24 13:44:20','zhangbingcan','zhangbingcan','2','dt',NULL),
	(436,'贴心计划投资','投资','资金平台监控（产品交易技术组）','10MIN','nono','select hour(dt) as the_hour,\nfloor(extract(minute from dt)/10)*10+10 as the_mins,\ndt,\namt\nfrom (\nSELECT vf.user_id,vf.amount_payed as amt,vf.service_time as dt\nFROM  db_nono.vip_form vf JOIN  db_nono.finance_plan fp ON vf.fp_id = fp.id\nWHERE fp.scope = 11 AND vf.service_status = 1\n) as a',NULL,'the_hour','the_mins',NULL,NULL,2,'1','2017-03-24 13:48:28','2017-03-24 13:48:28','zhangbingcan','zhangbingcan','2','dt',NULL),
	(437,'新客计划投资','投资','资金平台监控（产品交易技术组）','10MIN','nono','select hour(dt) as the_hour,\nfloor(extract(minute from dt)/10)*10+10 as the_mins,\ndt,\namt\nfrom (\nSELECT vf.user_id,vf.amount_payed as amt,vf.service_time as dt\nFROM  db_nono.vip_form vf JOIN  db_nono.finance_plan fp ON vf.fp_id = fp.id\nWHERE fp.scope = 1 AND vf.service_status = 1\n) as a',NULL,'the_hour','the_mins',NULL,NULL,2,'1','2017-03-24 13:51:24','2017-03-24 13:51:24','zhangbingcan','zhangbingcan','2','dt',NULL),
	(438,'精选自动投标','投资','资金平台监控（产品交易技术组）','10MIN','nono','select hour(dt) as the_hour,\nfloor(extract(minute from dt)/10)*10+10 as the_mins,\ndt,\namt\nfrom (\nSELECT user_id,price as amt,pay_time as dt FROM db_nono.borrows_bidding\nWHERE va_id > 0 AND reason = \'[自动投标]\' AND status IN (1, 2)\n) as a',NULL,'the_hour','the_mins',NULL,NULL,2,'1','2017-03-24 13:55:32','2017-03-24 13:55:32','zhangbingcan','zhangbingcan','2','dt',NULL),
	(439,'名校贷以及白领包申请','资产端','资金平台监控（产品交易技术组）','10MIN','nono','select hour(dt) as the_hour,\nfloor(extract(minute from dt)/10)*10+10 as the_mins,\ndt,\namt\nfrom (\nselect user_id,bp_price as amt,bp_publish_time as dt from db_nono.borrows_prepare where p_id in (102,99,88,84,83,77,87)\n) as a',NULL,'the_hour','the_mins',NULL,NULL,2,'1','2017-03-24 14:00:42','2017-03-24 14:00:42','zhangbingcan','zhangbingcan','2','dt',NULL),
	(440,'麦芽分期申请','资产端','资金平台监控（产品交易技术组）','10MIN','nono','select hour(dt) as the_hour,\nfloor(extract(minute from dt)/10)*10+10 as the_mins,\ndt,\namt\nfrom (\nselect user_id,bp_price as amt,bp_publish_time as dt from db_nono.borrows_prepare where p_id in (96)\n) as a',NULL,'the_hour','the_mins',NULL,NULL,2,'1','2017-03-24 14:03:26','2017-03-24 14:03:26','zhangbingcan','zhangbingcan','2','dt',NULL),
	(441,'Unifi申请','资产端','资金平台监控（产品交易技术组）','10MIN','nono','select hour(dt) as the_hour,\nfloor(extract(minute from dt)/10)*10+10 as the_mins,\ndt,\namt\nfrom (\nselect user_id,bp_price as amt,bp_publish_time as dt from db_nono.borrows_prepare where p_id in (94,97)\n) as a',NULL,'the_hour','the_mins',NULL,NULL,2,'1','2017-03-24 14:07:06','2017-03-24 14:07:06','zhangbingcan','zhangbingcan','2','dt',NULL),
	(442,'名校贷以及白领包放款','资产端','资金平台监控（产品交易技术组）','10MIN','nono','select hour(dt) as the_hour,\nfloor(extract(minute from dt)/10)*10+10 as the_mins,\ndt,\namt\nfrom (\nselect  user_id,bo_finish_price as amt,bo_audit_time as dt from db_nono.borrows where p_id in (102,99,88,84,83,77,87)\n) as a',NULL,'the_hour','the_mins',NULL,NULL,2,'1','2017-03-24 14:14:01','2017-03-24 14:22:52','zhangbingcan','zhangbingcan','2','dt',NULL),
	(443,'麦芽分期放款','资产端','资金平台监控（产品交易技术组）','10MIN','nono','select hour(dt) as the_hour,\nfloor(extract(minute from dt)/10)*10+10 as the_mins,\ndt,\namt\nfrom (\nselect  user_id,bo_finish_price as amt,bo_audit_time as dt from db_nono.borrows where p_id in (96)\n) as a',NULL,'the_hour','the_mins',NULL,NULL,2,'1','2017-03-24 14:16:30','2017-03-24 14:22:52','zhangbingcan','zhangbingcan','2','dt',NULL),
	(444,'Unifi放款','资产端','资金平台监控（产品交易技术组）','10MIN','nono','select hour(dt) as the_hour,\nfloor(extract(minute from dt)/10)*10+10 as the_mins,\ndt,\namt\nfrom (\nselect  user_id,bo_finish_price as amt,bo_audit_time as dt from db_nono.borrows where p_id in (94,97)\n) as a',NULL,'the_hour','the_mins',NULL,NULL,2,'1','2017-03-24 14:18:37','2017-03-24 14:22:52','zhangbingcan','zhangbingcan','2','dt',NULL),
	(445,'名校贷以及白领包还款','资产端','资金平台监控（产品交易技术组）','10MIN','nono','select hour(dt) as the_hour,\nfloor(extract(minute from dt)/10)*10+10 as the_mins,\ndt,\namt\nfrom (\nselect br.user_id,br.br_price_b as amt,br.br_repay_time as dt from db_nono.borrows_repayment br  \njoin db_nono.borrows bo on br.bo_id = bo.id  \nwhere bo.p_id in (102,99,88,84,83,77,87) and  bo.bo_is_success = 1 and br.br_repay_time is not null\nand br.br_repay_time>=\'${V_BEGIN_DATE}\'\nand br.br_repay_time<\'${V_END_DATE}\'\n) as a',NULL,'the_hour','the_mins',NULL,NULL,2,'1','2017-03-24 14:32:50','2017-04-05 10:08:02','zhangbingcan','bofei','2','dt',NULL),
	(446,'麦芽分期还款','资产端','资金平台监控（产品交易技术组）','10MIN','nono','select hour(dt) as the_hour,\nfloor(extract(minute from dt)/10)*10+10 as the_mins,\ndt,\namt\nfrom (\nselect br.user_id,br.br_price_b as amt,br.br_repay_time as dt from db_nono.borrows_repayment br  \njoin db_nono.borrows bo on br.bo_id = bo.id  \nwhere bo.p_id in (96) and  bo.bo_is_success = 1 and br.br_repay_time is not null\n) as a',NULL,'the_hour','the_mins',NULL,NULL,2,'1','2017-03-24 14:35:25','2017-03-24 14:35:25','zhangbingcan','zhangbingcan','2','dt',NULL),
	(447,'Unifi还款','资产端','资金平台监控（产品交易技术组）','10MIN','nono','select hour(dt) as the_hour,\nfloor(extract(minute from dt)/10)*10+10 as the_mins,\ndt,\namt\nfrom (\nselect br.user_id,br.br_price_b as amt,br.br_repay_time as dt from db_nono.borrows_repayment br  \njoin db_nono.borrows bo on br.bo_id = bo.id  \nwhere bo.p_id in (94,97) and  bo.bo_is_success = 1 and br.br_repay_time is not null\n) as a',NULL,'the_hour','the_mins',NULL,NULL,2,'1','2017-03-24 14:37:24','2017-03-24 14:37:24','zhangbingcan','zhangbingcan','2','dt',NULL),
	(448,'平台舆情','舆情','舆情监控','10MIN','dw_slave','SELECT t1.CREATE_TIME dt,t1.flatform_name pl,update_index cnt FROM (\nSELECT a.CREATE_TIME,\'百度贴吧\' AS flatform_name ,1 update_index FROM OPINION_MONITOR.POST_CONTENTS_BDTB a\nUNION all\nSELECT a.REPLY_TIME as CREATE_TIME,\'网贷之家\',1 update_index FROM OPINION_MONITOR.BBS_REPLY_WDZJ a\n) t1',NULL,'pl',NULL,NULL,NULL,1,'1','2017-03-28 09:41:49','2017-04-06 09:56:49','zhangbingcan','zhangbingcan','2','dt',NULL),
	(449,'产品舆情','舆情','舆情监控','10MIN','dw_slave','SELECT t1.CREATE_TIME dt,t1.flatform_name as prd,1 as cnt FROM (\nSELECT a.CREATE_TIME,b.tb_name AS flatform_name FROM OPINION_MONITOR.POST_CONTENTS_BDTB a\nLEFT JOIN \n(SELECT * FROM OPINION_MONITOR.POSTS_BDTB) b\nON a.post_id=b.post_id\nUNION all \nSELECT a.REPLY_TIME as CREATE_TIME,b.article_keywords FROM OPINION_MONITOR.BBS_REPLY_WDZJ a\nLEFT JOIN \n(SELECT * FROM OPINION_MONITOR.BBS_ARTICLE_WDZJ) b\nON a.article_id=b.article_id) t1',NULL,'prd',NULL,NULL,NULL,1,'1','2017-03-28 09:54:01','2017-04-05 17:51:50','zhangbingcan','zhangbingcan','2','dt',NULL),
	(450,'关键词','舆情','舆情监控','10MIN','dw_slave','select CREATE_TIME as dt,RELATED_WORDS as word, keyword as product,platform_name as platform, FREQ as cnt \nfrom  OPINION_MONITOR.KEYWORD_FREQ_CRAWL',NULL,'platform','product','word',NULL,3,'1','2017-03-28 18:04:07','2017-04-05 17:54:22','zhangbingcan','zhangbingcan','2','dt',NULL),
	(451,'消费金融帐户余额','余额','技术中心大屏s','10MIN','nono','select \n	hour(now()) the_hour,floor(extract(minute from now())/10)*10+10 as the_mins,\n	now() as dt,\n	balance as amt\nfrom \n	db_nono.finance_account \nwhere id=11948739',NULL,'the_hour','the_mins',NULL,NULL,2,'1','2017-04-07 18:38:52','2017-04-07 18:38:52','bofei','bofei','2','dt',NULL),
	(452,'诺诺复投','投资','NONO_KPI','30MIN','nono','select \n  t.dt,\n  t.user_id,\n  t.inv_amt\nfrom ( ${V_SQL_PATTERN} ) t\nwhere rank=2',148,NULL,NULL,NULL,NULL,0,'1','2017-04-13 20:27:06','2017-04-13 20:27:06','bofei','bofei','2','dt',NULL),
	(453,'诺诺加息券情况','投资','NONO_KPI','30MIN','nono',' select \n  t.dt,\n  t.coupon_name,\n  t.user_id,\n  t.inv_amt,\n  t.cash_value,\n  t.coupon_id,\n  t.rate_value,t.product_name,t.id as inv_id,\n  t.expect_name\nfrom ( ${V_SQL_PATTERN} ) t where t.type=1',149,'coupon_name','product_name','expect_name',NULL,3,'1','2017-04-14 16:04:03','2017-04-18 10:04:24','bofei','bofei','2',' dt',NULL),
	(456,'名校贷放款','名校贷','名校贷监控大屏','10MIN','nono','select \n	hour(dt) the_hour,floor(extract(minute from dt)/10)*10+10 as the_mins,\n	dt,bo_amt,p_id,company,user_id\nfrom \n	(${V_SQL_PATTERN}) as a',21,'the_hour','the_mins',NULL,NULL,2,'1','2017-04-17 15:25:53','2017-04-17 17:52:29','zhangbingcan','zhangbingcan','2','dt',NULL),
	(457,'名校贷学籍认证','名校贷','名校贷监控大屏','10MIN','nono','select \n	hour(dt) the_hour,floor(extract(minute from dt)/10)*10+10 as the_mins,user_id,\n	dt\nfrom \n	(${V_SQL_PATTERN}) as a',151,'the_hour','the_mins',NULL,NULL,2,'0','2017-04-17 15:38:32','2017-08-09 14:15:27','zhangbingcan','bofei','2','dt',NULL),
	(458,'借款申请','名校贷','名校贷监控大屏','10MIN','nono','select \n	hour(dt) the_hour,floor(extract(minute from dt)/10)*10+10 as the_mins,user_id,p_id,\n	dt\nfrom \n	(${V_SQL_PATTERN}) as a',27,'the_hour','the_mins',NULL,NULL,2,'1','2017-04-17 15:55:15','2017-04-17 17:53:02','zhangbingcan','zhangbingcan','2','dt',NULL),
	(459,'进件','名校贷','名校贷监控大屏','10MIN','nono','select \n	hour(dt) the_hour,floor(extract(minute from dt)/10)*10+10 as the_mins,user_id,p_id,\n	dt\nfrom \n	(${V_SQL_PATTERN}) as a',150,'the_hour','the_mins',NULL,NULL,2,'1','2017-04-17 16:11:02','2017-04-17 17:53:15','zhangbingcan','zhangbingcan','2','dt',NULL),
	(460,'注册','名校贷','名校贷监控大屏','10MIN','nono','select \n	hour(dt) the_hour,floor(extract(minute from dt)/10)*10+10 as the_mins,user_id,\n	dt\nfrom \n	(${V_SQL_PATTERN}) as a',23,'the_hour','the_mins',NULL,NULL,2,'1','2017-04-17 17:19:41','2017-04-17 17:53:25','zhangbingcan','zhangbingcan','2','dt',NULL),
	(461,'诺诺注册人数','注册','NONO_KPI','30MIN','nono','select \n  t.dt,\n  t.user_id\nfrom ( ${V_SQL_PATTERN} ) t',8,NULL,NULL,NULL,NULL,0,'1','2017-04-17 18:03:48','2017-04-17 18:03:48','bofei','bofei','2','dt',NULL),
	(462,'c','c','c','1','1','1',1,'1','1','1',NULL,1,'1','2017-04-18 14:02:21','2017-04-18 14:02:21','admin','admin','c','1',NULL),
	(463,'1','1','1','1','1','1',1,'1','1','1',NULL,1,'1','2017-04-18 14:04:29','2017-04-18 14:04:29','admin','admin','1','1',NULL),
	(464,'进件人数','名校贷','存量战役监控-大屏','30MIN','nono','select hour(dt) the_hour\n,floor(extract(minute from dt)/10)*10+10 as the_mins\n,user_id\n,dt\n,p_id\nfrom (${V_SQL_PATTERN}) as a\n',152,'the_hour','the_mins',NULL,NULL,2,'1','2017-06-15 15:01:30','2017-06-15 18:45:38','hudie','niuzitong','2','dt',NULL),
	(468,'放款明细','名校贷','存量战役监控-大屏','30MIN','nono','select hour(dt) the_hour\n,floor(extract(minute from dt)/10)*10+10 as the_mins\n,user_id\n,bo_price\n,dt\n,p_id\nfrom (${V_SQL_PATTERN}) as a\n',157,'the_hour','the_mins',NULL,NULL,2,'1','2017-06-15 17:31:58','2017-06-16 11:53:44','hudie','hudie','2','dt',NULL),
	(469,'审核明细','名校贷','存量战役监控-大屏','30MIN','nono','select hour(dt) the_hour\n,floor(extract(minute from dt)/10)*10+10 as the_mins\n,user_id\n,is_confirm\n,dt\n,p_id\nfrom (${V_SQL_PATTERN}) as a',158,'the_hour','the_mins',NULL,NULL,2,'1','2017-06-15 17:42:01','2017-06-16 11:51:23','hudie','hudie','2','dt',NULL),
	(478,'黄苑钢_产品投资金额_分时数据N','产品','黄苑钢_诺诺大屏','HOURLY','nono','SELECT \'${V_BEGIN_DATE}\' AS dt,VF.amount_payed,FPS.label\n	 FROM db_nono.vip_form VF\n	 INNER JOIN db_nono.user_info UI ON VF.user_id=UI.id\n   INNER JOIN db_nono.finance_plan FP ON VF.fp_id=FP.id\n   INNER JOIN db_nono.finance_plan_scope FPS ON FP.scope=FPS.id\n	 WHERE UI.is_special=0\n	 AND VF.service_status=1\n	 AND VF.service_time>=\'${V_BEGIN_DATE}\'\n	AND VF.platform=1\n   AND VF.service_time<\'${V_END_DATE}\'\n	 AND UI.user_type IN(0,1)\n	 AND UI.id NOT IN(920272,1598,1600,1176674)\n	 AND NOT EXISTS(SELECT \'X\'\n										 FROM db_nono.system_config SC \n										 WHERE UI.user_name=SC.config_value\n										 AND SC.config_name LIKE \'%dfd%\')',NULL,'label',NULL,NULL,NULL,1,'1','2017-06-30 10:34:36','2017-09-18 18:00:43','huangyuangang','huangyuangang','2','dt',NULL),
	(479,'黄苑钢_提现金额_分时数据N','取现','黄苑钢_诺诺大屏','HOURLY','nono','SELECT HOUR(WC.create_time) as the_hour,\'${V_BEGIN_DATE}\' AS dt,WC.price\n   FROM db_nono.withdraw_cash WC\n   INNER JOIN db_nono.user_info UI ON WC.user_id=UI.id\n   WHERE UI.is_special=0\n   AND UI.user_type IN(0,1)\n	 AND UI.id NOT IN(920272,1598,1600,1176674)\n	 AND NOT EXISTS(SELECT \'X\'\n										 FROM db_nono.system_config SC \n										 WHERE UI.user_name=SC.config_value\n										 AND SC.config_name LIKE \'%dfd%\')\n   AND (WC.bo_id IS NULL OR WC.bo_id=0)\n   AND WC.`status`=4\n   AND WC.create_time>=\'${V_BEGIN_DATE}\'\n   AND WC.create_time<\'${V_END_DATE}\'',NULL,'the_hour',NULL,NULL,NULL,1,'1','2017-06-30 10:37:51','2017-06-30 10:37:51','huangyuangang','huangyuangang','2','dt',NULL),
	(480,'黄苑钢_投资金额_分时数据N','入金','黄苑钢_诺诺大屏','HOURLY','nono','SELECT HOUR(VF.service_time) as the_hour,\'${V_BEGIN_DATE}\' AS dt,VF.amount_payed\n	 FROM db_nono.vip_form VF\n	 INNER JOIN db_nono.user_info UI ON VF.user_id=UI.id\n	 WHERE UI.is_special=0\n	 AND VF.service_status=1\n	 AND VF.service_time>=\'${V_BEGIN_DATE}\'\n	AND VF.platform=1\n   AND VF.service_time<\'${V_END_DATE}\'\n	 AND UI.user_type IN(0,1)\n	 AND UI.id NOT IN(920272,1598,1600,1176674)\n	 AND NOT EXISTS(SELECT \'X\'\n										 FROM db_nono.system_config SC \n										 WHERE UI.user_name=SC.config_value\n										 AND SC.config_name LIKE \'%dfd%\')',NULL,'the_hour',NULL,NULL,NULL,1,'1','2017-06-30 10:42:17','2017-09-18 18:00:26','huangyuangang','huangyuangang','2','dt',NULL),
	(481,'黄苑钢_首投客户数_分时数据N','投资','黄苑钢_诺诺大屏','HOURLY','nono','SELECT dt,hour(service_time) as the_hour,user_id\n	 FROM \n		(SELECT service_time,user_id,\'${V_BEGIN_DATE}\' AS dt\n			 FROM db_nono.vip_form VF\n			 INNER JOIN db_nono.user_info UI ON VF.user_id=UI.id\n			 WHERE UI.is_special=0\n			 AND VF.service_status=1\n			AND VF.platform=1\n       AND VF.service_time>=\'${V_BEGIN_DATE}\'\n       AND VF.service_time<\'${V_END_DATE}\'\n			 AND UI.user_type IN(0,1)\n       AND UI.id NOT IN(920272,1598,1600,1176674)\n			 AND NOT EXISTS(SELECT \'X\'\n												 FROM db_nono.system_config SC \n												 WHERE UI.user_name=SC.config_value\n												 AND SC.config_name LIKE \'%dfd%\')\n    ) A\n	WHERE NOT EXISTS(SELECT \'X\'\n												 FROM db_nono.vip_form B\n												 WHERE service_status=1\n                         AND service_time<\'${V_BEGIN_DATE}\'\n			AND A.user_id=B.user_id\n			AND B.platform=1\n			)',NULL,'the_hour',NULL,NULL,NULL,1,'1','2017-06-30 10:46:03','2017-09-18 18:43:53','huangyuangang','huangyuangang','2','dt',NULL),
	(482,'产品投资金额','财神','麦乐迪的财神大屏','30MIN','caishen','\nselect \ndt,invest_amount,user_code,product_name\nfrom (\nselect  created_date as dt\n,invest_amount,user_code,product_code\nfrom nonobank_app.user_product\nwhere product_code NOT IN (\'NN0005\', \'NN00011\', \'NN0017\')\nAND trans_code = 1\n AND status = \'1\'\nand created_date>=DATE(NOW())\nunion all\nselect concat(substr(trans_date,1,4),\'-\',substr(trans_date,5,2),\'-\',substr(trans_date,7,2),\' \',substr(trans_time,1,2),\':\',substr(trans_time,3,2),\':\',substr(trans_time,5,2)) as dt\n,amount,user_code,product_code\nfrom nonobank_app.trans_detail\nwhere product_code IN (\'NN0005\', \'NN00011\', \'NN0017\')\nAND status = \'2\'\nAND trans_code IN (1, 8)\nand trans_date>=DATE_FORMAT(NOW(),\'%Y%m%d\')\n) al\nleft outer join nonobank_app.product_info t\non al.product_code=t.product_code\n',NULL,'product_name',NULL,NULL,NULL,1,'0','2017-08-17 17:44:22','2017-09-20 10:01:51','hudie','hudie','3','dt',NULL),
	(492,'新客用户累计','财神','麦乐迪的财神大屏','30MIN','caishen','-- 小时新客用户\nselect hours, dt, user_code\nfrom \n(select hour(created_date) as hours,created_date as dt\n,user_code\nfrom nonobank_app.user_product\nwhere product_code NOT IN (\'NN0005\', \'NN00011\', \'NN0017\')\nAND trans_code = 1\nand created_date>=DATE(NOW())\n AND status = \'1\'\nunion all\nselect hour(trans_time) as hours\n,concat(substr(trans_date,1,4),\'-\',substr(trans_date,5,2),\'-\',substr(trans_date,7,2),\' \',substr(trans_time,1,2),\':\',substr(trans_time,3,2),\':\',substr(trans_time,5,2)) as dt\n,user_code\nfrom nonobank_app.trans_detail\nwhere product_code IN (\'NN0005\', \'NN00011\', \'NN0017\')\nand trans_date>=DATE_FORMAT(NOW(),\'%Y%m%d\')\nAND status = \'2\'\nAND trans_code IN (1, 8)\n ) al\nwhere NOT EXISTS(\nselect \'x\'\nfrom nonobank_app.user_product\nwhere al.user_code=user_code\nand created_date < DATE(NOW())\nunion all\nselect \'x\'\nfrom nonobank_app.trans_detail\nwhere al.user_code=user_code\nand trans_date<DATE_FORMAT(NOW(),\'%Y%m%d\'))',NULL,'hours',NULL,NULL,NULL,1,'0','2017-08-18 10:40:18','2017-09-20 10:01:48','hudie','hudie','3','dt',NULL),
	(493,'投资金额','财神','麦乐迪的财神大屏','30MIN','caishen','select hours,dt,invest_amount\nfrom (\nselect hour(created_date) as hours\n	,created_date as dt\n	,invest_amount\nfrom nonobank_app.user_product\nwhere product_code NOT IN (\'NN0005\', \'NN00011\', \'NN0017\')\nAND trans_code = 1\n AND status = \'1\'\nand created_date>=DATE(NOW())\nunion all\nselect hour(trans_time) as hours\n,concat(substr(trans_date,1,4),\'-\',substr(trans_date,5,2),\'-\',substr(trans_date,7,2),\' \',substr(trans_time,1,2),\':\',substr(trans_time,3,2),\':\',substr(trans_time,5,2)) as dt\n,amount as invest_amount\nfrom nonobank_app.trans_detail\nwhere product_code IN (\'NN0005\', \'NN00011\', \'NN0017\')\nAND status = \'2\'\nAND trans_code IN (1, 8)\nand trans_date>=DATE_FORMAT(NOW(),\'%Y%m%d\')\n) al\n',NULL,'hours',NULL,NULL,NULL,1,'0','2017-08-18 11:36:25','2017-09-20 10:01:45','hudie','hudie','2','dt',NULL),
	(497,'投资金额累计','财神','麦乐迪的财神大屏','30MIN','caishen','select hours,dt,invest_amount\nfrom (\nselect hour(created_date) as hours\n	,created_date as dt\n	,invest_amount\nfrom nonobank_app.user_product\nwhere product_code NOT IN (\'NN0005\', \'NN00011\', \'NN0017\')\nAND trans_code = 1\nAND status = \'1\'\nand created_date>=DATE(NOW())\nunion all\nselect hour(trans_time) as hours\n,concat(substr(trans_date,1,4),\'-\',substr(trans_date,5,2),\'-\',substr(trans_date,7,2),\' \',substr(trans_time,1,2),\':\',substr(trans_time,3,2),\':\',substr(trans_time,5,2)) as dt\n,amount as invest_amount\nfrom nonobank_app.trans_detail\nwhere product_code IN (\'NN0005\', \'NN00011\', \'NN0017\')\nAND status = \'2\'\nAND trans_code IN (1, 8)\nand trans_date>=DATE_FORMAT(NOW(),\'%Y%m%d\')\n) al\n',NULL,'hours',NULL,NULL,NULL,1,'0','2017-08-18 11:37:52','2017-09-20 10:01:42','hudie','hudie','3','dt',NULL),
	(498,'提现金额','财神','麦乐迪的财神大屏','30MIN','caishen','\nselect hours,dt,amount\nfrom(\nSELECT hour(wr.create_date) as hours\n,wr.create_date as dt,wr.withdraw_amount as amount\nFROM nonobank_app.withdraw_reward wr\nWHERE wr.STATUS IN (2, 3))a',NULL,'hours',NULL,NULL,NULL,1,'1','2017-08-18 11:53:42','2017-08-21 17:44:31','hudie','hudie','2','dt',NULL),
	(499,'提现金额累计','财神','麦乐迪的财神大屏','30MIN','caishen','\nselect hours,dt,amount\nfrom(\nSELECT hour(wr.create_date) as hours\n,wr.create_date as dt,wr.withdraw_amount as amount\nFROM nonobank_app.withdraw_reward wr\nWHERE wr.STATUS IN (2, 3))a',NULL,'hours',NULL,NULL,NULL,1,'1','2017-08-18 11:53:42','2017-08-21 17:44:27','hudie','hudie','2','dt',NULL),
	(500,'新客用户111','财神','麦乐迪的财神大屏','30MIN','caishen','-- 小时新客用户\nselect  hours, dt, user_code\nfrom \n(select hour(created_date) as hours,created_date as dt\n,user_code\nfrom nonobank_app.user_product\nwhere product_code NOT IN (\'NN0005\', \'NN00011\', \'NN0017\')\nAND trans_code = 1\nand created_date>=DATE(NOW())\n AND status = \'1\'\nunion all\nselect hour(trans_time) as hours\n,concat(substr(trans_date,1,4),\'-\',substr(trans_date,5,2),\'-\',substr(trans_date,7,2),\' \',substr(trans_time,1,2),\':\',substr(trans_time,3,2),\':\',substr(trans_time,5,2)) as dt\n,user_code\nfrom nonobank_app.trans_detail\nwhere product_code IN (\'NN0005\', \'NN00011\', \'NN0017\') \nand trans_date>=DATE_FORMAT(NOW(),\'%Y%m%d\')\nAND status = \'2\'\nAND trans_code IN (1, 8)) al\nwhere NOT EXISTS(\nselect \'x\'\nfrom nonobank_app.user_product a\nwhere created_date<\'${V_STAT_DATE}\' \nand al.user_code=a.user_code\nAND trans_code = 1\n AND status = \'1\'\nunion all\nselect \'x\'\nfrom nonobank_app.trans_detail b\nwhere  trans_date<\'${V_STAT_DATE}\' \nAND status = \'2\'\nAND trans_code IN (1, 8)\nand al.user_code=b.user_code)',NULL,'hours',NULL,NULL,NULL,1,'0','2017-08-19 10:36:03','2017-09-20 10:01:37','hudie','hudie','2','dt',NULL),
	(501,'投资金额_分时_NN产品','财神','麦乐迪的财神大屏','30MIN','nono','SELECT HOUR(VF.service_time) as hours,\'${V_BEGIN_DATE}\' AS dt,VF.amount_payed\n	 FROM db_nono.vip_form VF\n	 INNER JOIN db_nono.user_info UI ON VF.user_id=UI.id\n	 WHERE UI.is_special=0\n	 AND VF.service_status=1\n	 AND VF.service_time>=\'${V_BEGIN_DATE}\'\n	AND VF.platform=2\n   AND VF.service_time<\'${V_END_DATE}\'\n	 AND UI.user_type IN(0,1)\n	 AND UI.id NOT IN(920272,1598,1600,1176674)\n	 AND NOT EXISTS(SELECT \'X\'\n										 FROM db_nono.system_config SC \n										 WHERE UI.user_name=SC.config_value\n										 AND SC.config_name LIKE \'%dfd%\')',NULL,'hours',NULL,NULL,NULL,1,'1','2017-06-30 10:42:17','2017-09-19 18:16:01','huangyuangang','zhaoyaoyuan','2','dt',NULL),
	(502,'投资金额_累计_NN产品','财神','麦乐迪的财神大屏','30MIN','nono','select hours,dt,invest_amount\nfrom (SELECT HOUR(VF.service_time) as hours,date_format(VF.service_time,\'%Y-%m-%d\') AS dt,VF.amount_payed as invest_amount\n	 FROM db_nono.vip_form VF\n	 INNER JOIN db_nono.user_info UI ON VF.user_id=UI.id\n	 WHERE UI.is_special=0\n	 AND VF.service_status=1\n	 AND VF.service_time>=DATE(NOW())\n	AND VF.platform=2\n	 AND UI.user_type IN(0,1)\n	 AND UI.id NOT IN(920272,1598,1600,1176674)\n	 AND NOT EXISTS(SELECT \'X\'\n										 FROM db_nono.system_config SC \n										 WHERE UI.user_name=SC.config_value\n										 AND SC.config_name LIKE \'%dfd%\')\n) t',NULL,'hours',NULL,NULL,NULL,1,'1','2017-06-30 10:42:17','2017-09-19 18:15:58','huangyuangang','zhaoyaoyuan','3','dt',NULL),
	(503,'投资人数_分时_NN产品','财神','麦乐迪的财神大屏','30MIN','nono','select  hours,dt,user_id\nfrom (SELECT dt,hour(service_time) as hours,user_id\n	 FROM \n		(SELECT service_time,user_id,\'${V_BEGIN_DATE}\' AS dt\n			 FROM db_nono.vip_form VF\n			 INNER JOIN db_nono.user_info UI ON VF.user_id=UI.id\n			 WHERE UI.is_special=0\n			 AND VF.service_status=1\n			AND VF.platform=2\n       AND VF.service_time>=\'${V_BEGIN_DATE}\'\n       AND VF.service_time<\'${V_END_DATE}\'\n			 AND UI.user_type IN(0,1)\n       AND UI.id NOT IN(920272,1598,1600,1176674)\n			 AND NOT EXISTS(SELECT \'X\'\n												 FROM db_nono.system_config SC \n												 WHERE UI.user_name=SC.config_value\n												 AND SC.config_name LIKE \'%dfd%\')\n    ) A\n\n)al',NULL,'hours',NULL,NULL,NULL,1,'1','2017-06-30 10:46:03','2017-09-20 09:34:09','huangyuangang','zhaoyaoyuan','2','dt',NULL),
	(504,'投资人数_累计_NN产品','财神','麦乐迪的财神大屏','30MIN','nono','select  hours,dt,user_id\nfrom (SELECT dt,hour(service_time) as hours,user_id\n	 FROM \n		(SELECT service_time,user_id, date_format(VF.service_time,\'%Y-%m-%d\')  AS dt\n			 FROM db_nono.vip_form VF\n			 INNER JOIN db_nono.user_info UI ON VF.user_id=UI.id\n			 WHERE UI.is_special=0\n			 AND VF.service_status=1\n			AND VF.platform=2\n       AND VF.service_time>=DATE(NOW())\n			 AND UI.user_type IN(0,1)\n       AND UI.id NOT IN(920272,1598,1600,1176674)\n			 AND NOT EXISTS(SELECT \'X\'\n												 FROM db_nono.system_config SC \n												 WHERE UI.user_name=SC.config_value\n												 AND SC.config_name LIKE \'%dfd%\')\n    ) A\n	WHERE NOT EXISTS(SELECT \'X\'\n												 FROM db_nono.vip_form B\n												 WHERE service_status=1\n                         AND service_time<\'${V_BEGIN_DATE}\'\n			AND A.user_id=B.user_id\n			AND B.platform=1\n			)\n)al',NULL,'hours',NULL,NULL,NULL,1,'1','2017-06-30 10:46:03','2017-09-20 09:22:55','huangyuangang','zhaoyaoyuan','3','dt',NULL),
	(505,'产品投资金额_NN产品','财神','麦乐迪的财神大屏','30MIN','nono','SELECT \'${V_BEGIN_DATE}\' AS dt,VF.amount_payed,FPS.label,FP.title\n	 FROM db_nono.vip_form VF\n	 INNER JOIN db_nono.user_info UI ON VF.user_id=UI.id\n   INNER JOIN db_nono.finance_plan FP ON VF.fp_id=FP.id\n   INNER JOIN db_nono.finance_plan_scope FPS ON FP.scope=FPS.id\n	 WHERE UI.is_special=0\n	 AND VF.service_status=1\n	 AND VF.service_time>=\'${V_BEGIN_DATE}\'\n	AND VF.platform=2\n   AND VF.service_time<\'${V_END_DATE}\'\n	 AND UI.user_type IN(0,1)\n	 AND UI.id NOT IN(920272,1598,1600,1176674)\n	 AND NOT EXISTS(SELECT \'X\'\n										 FROM db_nono.system_config SC \n										 WHERE UI.user_name=SC.config_value\n										 AND SC.config_name LIKE \'%dfd%\')',NULL,'label','title',NULL,NULL,2,'1','2017-06-30 10:34:36','2017-09-26 11:41:41','huangyuangang','zhaoyaoyuan','2','dt',NULL),
	(506,'产品结算_NN产品','财神','麦乐迪的财神大屏','30MIN','nono','SELECT date_format(cash_time,\'%Y-%m-%d\') as dt,hour(cash_time) as hours,b.title,amount\nfrom db_nono.vip_account a left join db_nono.finance_plan b on a.fp_id=b.id\nwhere is_cash=1 and platform=2\nand cash_time >= date(now())',NULL,'title',NULL,NULL,NULL,1,'1','2017-06-30 10:34:36','2017-09-22 11:38:17','zhaoyaoyuan','zhaoyaoyuan','2','dt',NULL),
	(507,'产品结算_CSYY','财神','麦乐迪的财神大屏','10MIN','caishen','SELECT date(now()) as dt,product_name,invest_amount\nfrom nonobank_app.user_product al left outer join nonobank_app.product_info t\non al.product_code=t.product_code\nwhere al.trans_code=1 \nand al.status=1\nand al.product_code in (\'NN0019\',\'NN0020\',\'NN0012\') \nand date(invest_end_date)=date(DATE_ADD(now(),INTERVAL -1 DAY))\nunion all\nSELECT date(create_date) as dt,\'开心财神主动转出\' as product_name,amount as invest_amount\nfrom nonobank_app.user_account_trans_log\nwhere operation_type =\'40\'\nand status=1\nand create_date >=date(now())\nunion all\nselect date(create_time) as dt,\'开心转招财卡\' as product_name,amount as invest_amount\nfrom nonobank_app.product_exchange_order_info\nwhere create_time>=date(now())\nunion all\nSELECT date(create_date) as dt,\'开心财神自然转出\' as product_name,amount as invest_amount\nfrom nonobank_app.user_account_trans_log \nwhere operation_type in (\'4\',\'5\')\nand status=1\nand role_key_word=\'NN0018\'\nand create_date>=date(now())',NULL,'product_name',NULL,NULL,NULL,1,'1','2017-08-19 10:36:03','2017-09-28 09:39:43','hudie','zhaoyaoyuan','2','dt',NULL);

/*!40000 ALTER TABLE `ETL_IS_INDEX_CONF` ENABLE KEYS */;
UNLOCK TABLES;



/*!40111 SET SQL_NOTES=@OLD_SQL_NOTES */;
/*!40101 SET SQL_MODE=@OLD_SQL_MODE */;
/*!40014 SET FOREIGN_KEY_CHECKS=@OLD_FOREIGN_KEY_CHECKS */;
/*!40101 SET CHARACTER_SET_CLIENT=@OLD_CHARACTER_SET_CLIENT */;
/*!40101 SET CHARACTER_SET_RESULTS=@OLD_CHARACTER_SET_RESULTS */;
/*!40101 SET COLLATION_CONNECTION=@OLD_COLLATION_CONNECTION */;
