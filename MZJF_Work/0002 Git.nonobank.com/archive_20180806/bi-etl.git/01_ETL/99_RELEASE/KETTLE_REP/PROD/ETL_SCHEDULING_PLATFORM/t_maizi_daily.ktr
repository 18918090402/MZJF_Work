<transformation>
  <info>
    <name>t_maizi_daily</name>
    <description/>
    <extended_description/>
    <trans_version/>
    <trans_type>Normal</trans_type>
    <trans_status>0</trans_status>
    <directory>&#x2f;ETL_SCHEDULING_PLATFORM</directory>
    <parameters>
    </parameters>
    <log>
<trans-log-table><connection/>
<schema/>
<table/>
<size_limit_lines/>
<interval/>
<timeout_days/>
<field><id>ID_BATCH</id><enabled>Y</enabled><name>ID_BATCH</name></field><field><id>CHANNEL_ID</id><enabled>Y</enabled><name>CHANNEL_ID</name></field><field><id>TRANSNAME</id><enabled>Y</enabled><name>TRANSNAME</name></field><field><id>STATUS</id><enabled>Y</enabled><name>STATUS</name></field><field><id>LINES_READ</id><enabled>Y</enabled><name>LINES_READ</name><subject/></field><field><id>LINES_WRITTEN</id><enabled>Y</enabled><name>LINES_WRITTEN</name><subject/></field><field><id>LINES_UPDATED</id><enabled>Y</enabled><name>LINES_UPDATED</name><subject/></field><field><id>LINES_INPUT</id><enabled>Y</enabled><name>LINES_INPUT</name><subject/></field><field><id>LINES_OUTPUT</id><enabled>Y</enabled><name>LINES_OUTPUT</name><subject/></field><field><id>LINES_REJECTED</id><enabled>Y</enabled><name>LINES_REJECTED</name><subject/></field><field><id>ERRORS</id><enabled>Y</enabled><name>ERRORS</name></field><field><id>STARTDATE</id><enabled>Y</enabled><name>STARTDATE</name></field><field><id>ENDDATE</id><enabled>Y</enabled><name>ENDDATE</name></field><field><id>LOGDATE</id><enabled>Y</enabled><name>LOGDATE</name></field><field><id>DEPDATE</id><enabled>Y</enabled><name>DEPDATE</name></field><field><id>REPLAYDATE</id><enabled>Y</enabled><name>REPLAYDATE</name></field><field><id>LOG_FIELD</id><enabled>Y</enabled><name>LOG_FIELD</name></field><field><id>EXECUTING_SERVER</id><enabled>N</enabled><name>EXECUTING_SERVER</name></field><field><id>EXECUTING_USER</id><enabled>N</enabled><name>EXECUTING_USER</name></field><field><id>CLIENT</id><enabled>N</enabled><name>CLIENT</name></field></trans-log-table>
<perf-log-table><connection/>
<schema/>
<table/>
<interval/>
<timeout_days/>
<field><id>ID_BATCH</id><enabled>Y</enabled><name>ID_BATCH</name></field><field><id>SEQ_NR</id><enabled>Y</enabled><name>SEQ_NR</name></field><field><id>LOGDATE</id><enabled>Y</enabled><name>LOGDATE</name></field><field><id>TRANSNAME</id><enabled>Y</enabled><name>TRANSNAME</name></field><field><id>STEPNAME</id><enabled>Y</enabled><name>STEPNAME</name></field><field><id>STEP_COPY</id><enabled>Y</enabled><name>STEP_COPY</name></field><field><id>LINES_READ</id><enabled>Y</enabled><name>LINES_READ</name></field><field><id>LINES_WRITTEN</id><enabled>Y</enabled><name>LINES_WRITTEN</name></field><field><id>LINES_UPDATED</id><enabled>Y</enabled><name>LINES_UPDATED</name></field><field><id>LINES_INPUT</id><enabled>Y</enabled><name>LINES_INPUT</name></field><field><id>LINES_OUTPUT</id><enabled>Y</enabled><name>LINES_OUTPUT</name></field><field><id>LINES_REJECTED</id><enabled>Y</enabled><name>LINES_REJECTED</name></field><field><id>ERRORS</id><enabled>Y</enabled><name>ERRORS</name></field><field><id>INPUT_BUFFER_ROWS</id><enabled>Y</enabled><name>INPUT_BUFFER_ROWS</name></field><field><id>OUTPUT_BUFFER_ROWS</id><enabled>Y</enabled><name>OUTPUT_BUFFER_ROWS</name></field></perf-log-table>
<channel-log-table><connection/>
<schema/>
<table/>
<timeout_days/>
<field><id>ID_BATCH</id><enabled>Y</enabled><name>ID_BATCH</name></field><field><id>CHANNEL_ID</id><enabled>Y</enabled><name>CHANNEL_ID</name></field><field><id>LOG_DATE</id><enabled>Y</enabled><name>LOG_DATE</name></field><field><id>LOGGING_OBJECT_TYPE</id><enabled>Y</enabled><name>LOGGING_OBJECT_TYPE</name></field><field><id>OBJECT_NAME</id><enabled>Y</enabled><name>OBJECT_NAME</name></field><field><id>OBJECT_COPY</id><enabled>Y</enabled><name>OBJECT_COPY</name></field><field><id>REPOSITORY_DIRECTORY</id><enabled>Y</enabled><name>REPOSITORY_DIRECTORY</name></field><field><id>FILENAME</id><enabled>Y</enabled><name>FILENAME</name></field><field><id>OBJECT_ID</id><enabled>Y</enabled><name>OBJECT_ID</name></field><field><id>OBJECT_REVISION</id><enabled>Y</enabled><name>OBJECT_REVISION</name></field><field><id>PARENT_CHANNEL_ID</id><enabled>Y</enabled><name>PARENT_CHANNEL_ID</name></field><field><id>ROOT_CHANNEL_ID</id><enabled>Y</enabled><name>ROOT_CHANNEL_ID</name></field></channel-log-table>
<step-log-table><connection/>
<schema/>
<table/>
<timeout_days/>
<field><id>ID_BATCH</id><enabled>Y</enabled><name>ID_BATCH</name></field><field><id>CHANNEL_ID</id><enabled>Y</enabled><name>CHANNEL_ID</name></field><field><id>LOG_DATE</id><enabled>Y</enabled><name>LOG_DATE</name></field><field><id>TRANSNAME</id><enabled>Y</enabled><name>TRANSNAME</name></field><field><id>STEPNAME</id><enabled>Y</enabled><name>STEPNAME</name></field><field><id>STEP_COPY</id><enabled>Y</enabled><name>STEP_COPY</name></field><field><id>LINES_READ</id><enabled>Y</enabled><name>LINES_READ</name></field><field><id>LINES_WRITTEN</id><enabled>Y</enabled><name>LINES_WRITTEN</name></field><field><id>LINES_UPDATED</id><enabled>Y</enabled><name>LINES_UPDATED</name></field><field><id>LINES_INPUT</id><enabled>Y</enabled><name>LINES_INPUT</name></field><field><id>LINES_OUTPUT</id><enabled>Y</enabled><name>LINES_OUTPUT</name></field><field><id>LINES_REJECTED</id><enabled>Y</enabled><name>LINES_REJECTED</name></field><field><id>ERRORS</id><enabled>Y</enabled><name>ERRORS</name></field><field><id>LOG_FIELD</id><enabled>N</enabled><name>LOG_FIELD</name></field></step-log-table>
<metrics-log-table><connection/>
<schema/>
<table/>
<timeout_days/>
<field><id>ID_BATCH</id><enabled>Y</enabled><name>ID_BATCH</name></field><field><id>CHANNEL_ID</id><enabled>Y</enabled><name>CHANNEL_ID</name></field><field><id>LOG_DATE</id><enabled>Y</enabled><name>LOG_DATE</name></field><field><id>METRICS_DATE</id><enabled>Y</enabled><name>METRICS_DATE</name></field><field><id>METRICS_CODE</id><enabled>Y</enabled><name>METRICS_CODE</name></field><field><id>METRICS_DESCRIPTION</id><enabled>Y</enabled><name>METRICS_DESCRIPTION</name></field><field><id>METRICS_SUBJECT</id><enabled>Y</enabled><name>METRICS_SUBJECT</name></field><field><id>METRICS_TYPE</id><enabled>Y</enabled><name>METRICS_TYPE</name></field><field><id>METRICS_VALUE</id><enabled>Y</enabled><name>METRICS_VALUE</name></field></metrics-log-table>
    </log>
    <maxdate>
      <connection/>
      <table/>
      <field/>
      <offset>0.0</offset>
      <maxdiff>0.0</maxdiff>
    </maxdate>
    <size_rowset>10000</size_rowset>
    <sleep_time_empty>50</sleep_time_empty>
    <sleep_time_full>50</sleep_time_full>
    <unique_connections>N</unique_connections>
    <feedback_shown>Y</feedback_shown>
    <feedback_size>50000</feedback_size>
    <using_thread_priorities>Y</using_thread_priorities>
    <shared_objects_file/>
    <capture_step_performance>N</capture_step_performance>
    <step_performance_capturing_delay>1000</step_performance_capturing_delay>
    <step_performance_capturing_size_limit>100</step_performance_capturing_size_limit>
    <dependencies>
    </dependencies>
    <partitionschemas>
    </partitionschemas>
    <slaveservers>
         <slaveserver><name>master</name><hostname>172.16.2.146</hostname><port>9080</port><webAppName/><username>cluster</username><password>Encrypted 2be98afc86aa7f2e4cb1aa265cd86aac8</password><proxy_hostname/><proxy_port/><non_proxy_hosts/><master>Y</master><sslMode>N</sslMode></slaveserver>
    </slaveservers>
    <clusterschemas>
    </clusterschemas>
  <created_user>-</created_user>
  <created_date>2018&#x2f;03&#x2f;15 10&#x3a;16&#x3a;47.002</created_date>
  <modified_user>-</modified_user>
  <modified_date>2018&#x2f;07&#x2f;23 10&#x3a;46&#x3a;16.795</modified_date>
    <key_for_session_key>H4sIAAAAAAAAAAMAAAAAAAAAAAA&#x3d;</key_for_session_key>
    <is_key_private>N</is_key_private>
  </info>
  <notepads>
  </notepads>
  <connection>
    <name>LOCAL_IMPALA</name>
    <server>172.16.2.149</server>
    <type>IMPALA</type>
    <access>Native</access>
    <database>IDW</database>
    <port>21051</port>
    <username>impala</username>
    <password>Encrypted 2be98afc86aa7f2e4cb79a77dce93a3db</password>
    <servername/>
    <data_tablespace/>
    <index_tablespace/>
    <attributes>
      <attribute><code>FORCE_IDENTIFIERS_TO_LOWERCASE</code><attribute>N</attribute></attribute>
      <attribute><code>FORCE_IDENTIFIERS_TO_UPPERCASE</code><attribute>N</attribute></attribute>
      <attribute><code>IS_CLUSTERED</code><attribute>N</attribute></attribute>
      <attribute><code>PORT_NUMBER</code><attribute>21051</attribute></attribute>
      <attribute><code>PRESERVE_RESERVED_WORD_CASE</code><attribute>Y</attribute></attribute>
      <attribute><code>QUOTE_ALL_FIELDS</code><attribute>N</attribute></attribute>
      <attribute><code>SUPPORTS_BOOLEAN_DATA_TYPE</code><attribute>Y</attribute></attribute>
      <attribute><code>SUPPORTS_TIMESTAMP_DATA_TYPE</code><attribute>Y</attribute></attribute>
      <attribute><code>USE_POOLING</code><attribute>N</attribute></attribute>
    </attributes>
  </connection>
  <order>
  </order>
  <step>
    <name>Execute SQL script</name>
    <type>ExecSQL</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
         <partitioning>
           <method>none</method>
           <schema_name/>
           </partitioning>
    <connection>LOCAL_IMPALA</connection>
    <execute_each_row>N</execute_each_row>
    <single_statement>N</single_statement>
    <replace_variables>N</replace_variables>
    <quoteString>N</quoteString>
    <sql>&#x2f;&#x2a;&#x6bcf;&#x65e5;&#x8c03;&#x5ea6; &#x57fa;&#x7840;&#x8868;&#x2a;&#x2f;&#xd;&#xa;-- &#x8d44;&#x4ea7;&#x7aef;&#x57fa;&#x7840;&#x65e5;&#x62a5;&#x8868;&#xd;&#xa;&#xd;&#xa;INSERT overwrite msc.bia_fact_borrows  &#xd;&#xa;SELECT &#x2a; FROM msc.bia_fact_borrows WHERE v_date&#x3c;DATE_SUB&#x28;to_date&#x28;NOW&#x28;&#x29;&#x29;,7&#x29;&#xd;&#xa;UNION ALL&#xd;&#xa;SELECT v_date,busi_line,product,expect&#xd;&#xa;,SUM&#x28;IF&#x28;kind&#x3d;1,finish_price,0&#x29;&#x29; finish_price&#xd;&#xa;,SUM&#x28;IF&#x28;kind&#x3d;1,y_finish_price,0&#x29;&#x29; y_finish_price&#xd;&#xa;,SUM&#x28;IF&#x28;kind&#x3d;2,finish_price,0&#x29;&#x29; unrepay_price_b&#xd;&#xa;,SUM&#x28;IF&#x28;kind&#x3d;2,y_finish_price,0&#x29;&#x29; unrepay_price_l&#xd;&#xa;,SUM&#x28;IF&#x28;kind&#x3d;1,borrows_cnt,0&#x29;&#x29; borrows_cnt&#xd;&#xa;,SUM&#x28;IF&#x28;kind&#x3d;1,borrows_user,0&#x29;&#x29; borrows_user&#xd;&#xa;,SUM&#x28;IF&#x28;kind&#x3d;1,fst_borrows_user_all,0&#x29;&#x29; fst_borrows_user_all&#xd;&#xa;,SUM&#x28;IF&#x28;kind&#x3d;1,fst_borrows_user_month,0&#x29;&#x29; fst_borrows_user_month&#xd;&#xa;,SUM&#x28;IF&#x28;kind&#x3d;1,fst_finish_price,0&#x29;&#x29;  fst_finish_price&#xd;&#xa;,SUM&#x28;IF&#x28;kind&#x3d;1,fst_y_finish_price,0&#x29;&#x29; fst_y_finish_price&#xd;&#xa;,SUM&#x28;IF&#x28;kind&#x3d;2,borrows_cnt,0&#x29;&#x29; unrepay_borrows_cnt&#xd;&#xa;,SUM&#x28;IF&#x28;kind&#x3d;2,borrows_user,0&#x29;&#x29; unrepay_borrows_user&#xd;&#xa;,SUM&#x28;IF&#x28;kind&#x3d;2,fst_y_finish_price,0&#x29;&#x29; overdue_unrepay_price_b&#xd;&#xa;,SUM&#x28;IF&#x28;kind&#x3d;3,finish_price,0&#x29;&#x29; audit_finish_price&#xd;&#xa;,SUM&#x28;IF&#x28;kind&#x3d;3,y_finish_price,0&#x29;&#x29; y_audit_finish_price&#xd;&#xa;,SUM&#x28;IF&#x28;kind&#x3d;3,borrows_cnt,0&#x29;&#x29; audit_borrows_cnt&#xd;&#xa;,SUM&#x28;IF&#x28;kind&#x3d;3,borrows_user,0&#x29;&#x29; audit_borrows_user&#xd;&#xa;,SUM&#x28;IF&#x28;kind&#x3d;3,fst_borrows_user_all,0&#x29;&#x29; fst_audit_borrows_user_all&#xd;&#xa;,SUM&#x28;IF&#x28;kind&#x3d;3,fst_finish_price,0&#x29;&#x29;  fst_audit_finish_price&#xd;&#xa;,SUM&#x28;IF&#x28;kind&#x3d;3,fst_y_finish_price,0&#x29;&#x29; fst_y_audit_finish_price&#xd;&#xa;,NOW&#x28;&#x29; create_time&#xd;&#xa;FROM&#x28;&#xd;&#xa;SELECT to_date&#x28;bo.bo_agree_time&#x29; v_date&#xd;&#xa;,vbo.busi_line,vbo.product,vbo.expect,MAX&#x28;1&#x29; kind&#xd;&#xa;,ROUND&#x28;SUM&#x28;bo.bo_finish_price&#x29;,2&#x29; finish_price&#xd;&#xa;,ROUND&#x28;SUM&#x28;IF&#x28;bo.bo_expect_cat&#x3d;2,bo.bo_finish_price&#x2a;bo.bo_expect&#x2f;12,bo.bo_finish_price&#x2a;bo.bo_expect&#x2f;365&#x29;&#x29;,2&#x29; y_finish_price&#xd;&#xa;,COUNT&#x28;1&#x29; borrows_cnt&#xd;&#xa;,COUNT&#x28;DISTINCT bo.user_id&#x29; borrows_user&#xd;&#xa;,ROUND&#x28;SUM&#x28;IF&#x28;vbo.rank_all&#x3d;1,1,0&#x29;&#x29;,2&#x29; fst_borrows_user_all&#xd;&#xa;,ROUND&#x28;SUM&#x28;IF&#x28;vbo.rank_month&#x3d;1,1,0&#x29;&#x29;,2&#x29; fst_borrows_user_month&#xd;&#xa;,ROUND&#x28;SUM&#x28;IF&#x28;vbo.rank_all&#x3d;1,bo.bo_finish_price,0&#x29;&#x29;,2&#x29; fst_finish_price&#xd;&#xa;,ROUND&#x28;SUM&#x28;IF&#x28;vbo.rank_all&#x3d;1,IF&#x28;bo.bo_expect_cat&#x3d;2,bo.bo_finish_price&#x2a;bo.bo_expect&#x2f;12,bo.bo_finish_price&#x2a;bo.bo_expect&#x2f;365&#x29;,0&#x29;&#x29;,2&#x29; fst_y_finish_price&#xd;&#xa;&#xd;&#xa;FROM idw.fact_borrows bo &#xd;&#xa;JOIN dmt_im.v_borrows_busiline_product_bibi2 vbo ON vbo.bo_id&#x3d;bo.bo_id&#xd;&#xa;WHERE 1&#x3d;1 &#xd;&#xa;AND bo.bo_is_success&#x3d;1&#xd;&#xa;AND bo.bo_agree_time&#x3e;&#x3d;DATE_SUB&#x28;to_date&#x28;NOW&#x28;&#x29;&#x29;,7&#x29;&#xd;&#xa;AND bo.bo_agree_time&#x3c;to_date&#x28;NOW&#x28;&#x29;&#x29;&#xd;&#xa;GROUP BY 1,2,3,4&#xd;&#xa;UNION ALL&#xd;&#xa;SELECT to_date&#x28;bo.stat_date&#x29; v_date&#xd;&#xa;,vbo.busi_line,vbo.product,vbo.expect,MAX&#x28;2&#x29; kind&#xd;&#xa;,ROUND&#x28;SUM&#x28;unrepay_price_b&#x29;,2&#x29; unrepay_price_b0&#xd;&#xa;,ROUND&#x28;SUM&#x28;unrepay_price-unrepay_price_b&#x29;,2&#x29; unrepay_price_l0&#xd;&#xa;,COUNT&#x28;1&#x29;,COUNT&#x28;DISTINCT bo.user_id&#x29;,0,0,0,ROUND&#x28;SUM&#x28;bo.overdue_unrepay_price_b&#x29;,2&#x29; &#xd;&#xa;FROM idw.fact_in_repay_borrows_snapshot bo&#xd;&#xa;JOIN dmt_im.v_borrows_busiline_product_bibi2 vbo ON vbo.bo_id&#x3d;bo.bo_id&#xd;&#xa;WHERE 1&#x3d;1 &#xd;&#xa;AND bo.stat_date&#x3e;&#x3d;DATE_SUB&#x28;to_date&#x28;NOW&#x28;&#x29;&#x29;,7&#x29;&#xd;&#xa;AND bo.stat_date&#x3c;to_date&#x28;NOW&#x28;&#x29;&#x29;&#xd;&#xa;GROUP BY 1,2,3,4&#xd;&#xa;UNION ALL&#xd;&#xa;SELECT v_date&#xd;&#xa;,busi_line,product,expect,MAX&#x28;3&#x29; kind&#xd;&#xa;,SUM&#x28;bo_finish_price&#x29;&#xd;&#xa;,SUM&#x28;y_finish_price&#x29;&#xd;&#xa;,COUNT&#x28;1&#x29; borrows_cnt&#xd;&#xa;,COUNT&#x28;DISTINCT bo.user_id&#x29; borrows_user&#xd;&#xa;,ROUND&#x28;SUM&#x28;IF&#x28;rank_all&#x3d;1,1,0&#x29;&#x29;,2&#x29; fst_borrows_user_all&#xd;&#xa;,NULL fst_borrows_user_month&#xd;&#xa;,ROUND&#x28;SUM&#x28;IF&#x28;rank_all&#x3d;1,bo.bo_finish_price,0&#x29;&#x29;,2&#x29; fst_finish_price&#xd;&#xa;,ROUND&#x28;SUM&#x28;IF&#x28;rank_all&#x3d;1,y_finish_price,0&#x29;&#x29;,2&#x29; fst_y_finish_price&#xd;&#xa;&#xd;&#xa;FROM&#x28;&#xd;&#xa;SELECT to_date&#x28;bo.bo_audit_time&#x29; v_date&#xd;&#xa;,vbo.busi_line,vbo.product,vbo.expect&#xd;&#xa;,bo.bo_price bo_finish_price&#xd;&#xa;,IF&#x28;bo.bo_expect_cat&#x3d;2,bo.bo_price&#x2a;bo.bo_expect&#x2f;12,bo.bo_price&#x2a;bo.bo_expect&#x2f;365&#x29; y_finish_price&#xd;&#xa;,bo.user_id,vbo.audit_rank_all rank_all&#xd;&#xa;FROM idw.fact_borrows bo &#xd;&#xa;JOIN dmt_im.v_borrows_busiline_product_bibi2 vbo ON vbo.bo_id&#x3d;bo.bo_id&#xd;&#xa;LEFT JOIN &#x28;select bo_id,max&#x28;is_confirm&#x29; is_confirm from  odsopr.borrows_archive group by 1&#x29; ba ON ba.bo_id&#x3d;bo.bo_id &#xd;&#xa;WHERE 1&#x3d;1 &#xd;&#xa;AND bo.bo_audit_time&#x3e;&#x3d;DATE_SUB&#x28;to_date&#x28;NOW&#x28;&#x29;&#x29;,7&#x29;&#xd;&#xa;AND &#x28;bo.bo_is_success&#x3d;1 OR bo.confirm_status&#x3d;&#x27;&#x7ec8;&#x5ba1;&#x901a;&#x8fc7;&#x27; OR ba.is_confirm &#x3d; 1&#x29;&#xd;&#xa;&#x29;bo&#xd;&#xa;GROUP BY 1,2,3,4&#xd;&#xa;&#xd;&#xa;&#x29;a&#xd;&#xa;GROUP BY 1,2,3,4&#xd;&#xa;&#x3b;&#xd;&#xa;&#xd;&#xa;&#xd;&#xa;-- &#x8d44;&#x91d1;&#x7aef;&#x65e5;&#x62a5;&#x8868;&#xd;&#xa;&#xd;&#xa;INSERT overwrite msc.bia_fact_invest_nono  &#xd;&#xa;SELECT &#x2a; FROM msc.bia_fact_invest_nono WHERE v_date&#x3c;DATE_SUB&#x28;to_date&#x28;NOW&#x28;&#x29;&#x29;,7&#x29;&#xd;&#xa;UNION ALL&#xd;&#xa;SELECT v_date,busi_line,product,invest_expect&#xd;&#xa;,SUM&#x28;IF&#x28;kind&#x3d;1,invest_amt,0&#x29;&#x29; invest_amt&#xd;&#xa;,SUM&#x28;IF&#x28;kind&#x3d;1,invest_amt_yearly,0&#x29;&#x29; y_invest_amt&#xd;&#xa;,SUM&#x28;IF&#x28;kind&#x3d;2,invest_amt,0&#x29;&#x29; aum&#xd;&#xa;,SUM&#x28;IF&#x28;kind&#x3d;2,invest_amt_yearly,0&#x29;&#x29; lx&#xd;&#xa;,SUM&#x28;IF&#x28;kind&#x3d;1,invest_cnt,0&#x29;&#x29; invest_cnt&#xd;&#xa;,SUM&#x28;IF&#x28;kind&#x3d;1,invest_user_cnt,0&#x29;&#x29; invest_user_cnt&#xd;&#xa;,SUM&#x28;IF&#x28;kind&#x3d;1,fst_invest_user_cnt,0&#x29;&#x29; fst_invest_user_cnt&#xd;&#xa;,SUM&#x28;IF&#x28;kind&#x3d;1,fst_invest_amt,0&#x29;&#x29; fst_invest_amt&#xd;&#xa;,SUM&#x28;IF&#x28;kind&#x3d;1,fst_invest_dq_user_cnt,0&#x29;&#x29; fst_invest_dq_user_cnt&#xd;&#xa;,SUM&#x28;IF&#x28;kind&#x3d;1,fst_invest_dq_amt,0&#x29;&#x29; fst_invest_dq_amt&#xd;&#xa;,SUM&#x28;IF&#x28;kind&#x3d;2,invest_cnt,0&#x29;&#x29; aum_cnt&#xd;&#xa;,SUM&#x28;IF&#x28;kind&#x3d;2,invest_user_cnt,0&#x29;&#x29; aum_user_cnt&#xd;&#xa;,NOW&#x28;&#x29; create_time&#xd;&#xa;FROM&#x28;&#xd;&#xa;SELECT to_date&#x28;io.invest_time&#x29; v_date&#xd;&#xa;,&#x27;&#x8bfa;&#x8bfa;&#x27; busi_line&#xd;&#xa;,io2.product&#xd;&#xa;,io2.invest_expect&#xd;&#xa;,SUM&#x28;io.invest_amt&#x29; invest_amt&#xd;&#xa;,SUM&#x28;io.invest_amt_yearly&#x29; invest_amt_yearly&#xd;&#xa;,MAX&#x28;1&#x29; kind&#xd;&#xa;,COUNT&#x28;1&#x29; invest_cnt&#xd;&#xa;,COUNT&#x28;DISTINCT io.user_id&#x29; invest_user_cnt&#xd;&#xa;,SUM&#x28;IF&#x28;rank_all&#x3d;1,1,0&#x29;&#x29; fst_invest_user_cnt&#xd;&#xa;,SUM&#x28;IF&#x28;rank_all&#x3d;1,io.invest_amt,0&#x29;&#x29; fst_invest_amt&#xd;&#xa;,SUM&#x28;IF&#x28;rank_dq&#x3d;1,1,0&#x29;&#x29; fst_invest_dq_user_cnt&#xd;&#xa;,SUM&#x28;IF&#x28;rank_dq&#x3d;1,io.invest_amt,0&#x29;&#x29; fst_invest_dq_amt&#xd;&#xa;&#xd;&#xa;FROM msc.v_fact_nono_invest_order io &#xd;&#xa;LEFT JOIN odsopr.user_info ui ON ui.id&#x3d;io.user_id&#xd;&#xa;LEFT JOIN msc.v_nono_order_expect io2 ON io2.invest_relation_no&#x3d;io.invest_relation_no&#xd;&#xa;WHERE 1&#x3d;1 AND io.status IN &#x28;1,2&#x29;&#xd;&#xa;AND ui.is_special&#x3d;0&#xd;&#xa;AND io.user_id NOT IN&#x28;1598,1600,920272&#x29;&#xd;&#xa;AND io.user_id NOT IN &#x28;SELECT ui.id FROM odsopr.db_nono_system_config sc&#xd;&#xa;JOIN odsopr.user_info ui ON ui.user_name&#x3d;sc.config_value&#xd;&#xa; WHERE config_name LIKE &#x22;&#x25;DfdAdminMembers&#x25;&#x22;&#x29;&#xd;&#xa;  AND io.invest_time&#x3e;&#x3d;DATE_SUB&#x28;to_date&#x28;NOW&#x28;&#x29;&#x29;,7&#x29;&#xd;&#xa; AND io.invest_time&#x3c;to_date&#x28;NOW&#x28;&#x29;&#x29;&#xd;&#xa;GROUP BY 1,2,3,4&#xd;&#xa;&#xd;&#xa;UNION ALL&#xd;&#xa;&#xd;&#xa;SELECT to_date&#x28;fnads.stat_date&#x29; v_date&#xd;&#xa;,&#x27;&#x8bfa;&#x8bfa;&#x27; busi_line&#xd;&#xa;,fnads.product_category as  product&#xd;&#xa;,IF&#x28;fnads.product_category LIKE &#x22;&#x25;&#x6708;&#x6708;&#x5347;&#x25;&#x22;,fnads.product_category,IF&#x28;p.expect_unit_code&#x3d;1,CONCAT&#x28;CAST&#x28;p.expect AS STRING&#x29;,&#x27;&#x5929;&#x27;&#x29;,CONCAT&#x28;CAST&#x28;p.expect AS STRING&#x29;,&#x27;&#x6708;&#x27;&#x29;&#x29;&#x29; expect&#xd;&#xa;,ROUND&#x28;SUM&#x28;aum&#x29;,2&#x29; aum,SUM&#x28;0&#x29; lx&#xd;&#xa;,MAX&#x28;2&#x29; kind&#xd;&#xa;,COUNT&#x28;1&#x29;,COUNT&#x28;DISTINCT fnads.user_id&#x29;,0,0,0,0&#xd;&#xa;FROM IDW.FACT_BIZ_NONO_AUM fnads&#xd;&#xa;left join idw.dim_nono_product p on p.fp_id&#x3d;fnads.fp_id&#xd;&#xa;WHERE 1&#x3d;1&#xd;&#xa;AND fnads.stat_date&#x3e;&#x3d;DATE_SUB&#x28;to_date&#x28;NOW&#x28;&#x29;&#x29;,7&#x29;&#xd;&#xa;AND fnads.stat_date&#x3c;to_date&#x28;NOW&#x28;&#x29;&#x29;&#xd;&#xa;GROUP BY 1,2,3,4&#xd;&#xa;&#x29;a&#xd;&#xa;GROUP BY 1,2,3,4&#xd;&#xa;&#xd;&#xa;&#x3b;&#xd;&#xa;&#xd;&#xa;&#xd;&#xa;&#xd;&#xa;&#xd;&#xa;&#xd;&#xa;&#xd;&#xa;INSERT overwrite msc.bia_fact_invest_csyy &#xd;&#xa;SELECT &#x2a; FROM msc.bia_fact_invest_csyy WHERE v_date&#x3c;DATE_SUB&#x28;to_date&#x28;NOW&#x28;&#x29;&#x29;,7&#x29;&#xd;&#xa;UNION ALL&#xd;&#xa;SELECT v_date,busi_line,product,invest_expect&#xd;&#xa;,SUM&#x28;IF&#x28;kind&#x3d;1,invest_amt,0&#x29;&#x29; invest_amt&#xd;&#xa;,SUM&#x28;IF&#x28;kind&#x3d;1,invest_amt_yearly,0&#x29;&#x29; y_invest_amt&#xd;&#xa;,SUM&#x28;IF&#x28;kind&#x3d;2,invest_amt,0&#x29;&#x29; aum&#xd;&#xa;,SUM&#x28;IF&#x28;kind&#x3d;2,invest_amt_yearly,0&#x29;&#x29; lx&#xd;&#xa;,SUM&#x28;IF&#x28;kind&#x3d;1,invest_cnt,0&#x29;&#x29; invest_cnt&#xd;&#xa;,SUM&#x28;IF&#x28;kind&#x3d;1,invest_user_cnt,0&#x29;&#x29; invest_user_cnt&#xd;&#xa;,SUM&#x28;IF&#x28;kind&#x3d;1,fst_invest_user_cnt,0&#x29;&#x29; fst_invest_user_cnt&#xd;&#xa;,SUM&#x28;IF&#x28;kind&#x3d;1,fst_invest_amt,0&#x29;&#x29; fst_invest_amt&#xd;&#xa;,SUM&#x28;IF&#x28;kind&#x3d;1,fst_invest_dq_user_cnt,0&#x29;&#x29; fst_invest_dq_user_cnt&#xd;&#xa;,SUM&#x28;IF&#x28;kind&#x3d;1,fst_invest_dq_amt,0&#x29;&#x29; fst_invest_dq_amt&#xd;&#xa;,SUM&#x28;IF&#x28;kind&#x3d;2,invest_cnt,0&#x29;&#x29; aum_cnt&#xd;&#xa;,SUM&#x28;IF&#x28;kind&#x3d;2,invest_user_cnt,0&#x29;&#x29; aum_user_cnt&#xd;&#xa;,NOW&#x28;&#x29; create_time&#xd;&#xa;FROM&#x28;&#xd;&#xa;SELECT to_date&#x28;io.invest_time&#x29; v_date&#xd;&#xa;,&#x27;&#x8d22;&#x795e;&#x27; busi_line&#xd;&#xa;,io2.product&#xd;&#xa;,io2.invest_expect&#xd;&#xa;,SUM&#x28;io.invest_amt&#x29; invest_amt&#xd;&#xa;,ROUND&#x28;SUM&#x28;invest_amt_yearly&#x29;,2&#x29; invest_amt_yearly&#xd;&#xa;,MAX&#x28;1&#x29; kind&#xd;&#xa;,COUNT&#x28;1&#x29; invest_cnt&#xd;&#xa;,COUNT&#x28;DISTINCT io.user_code&#x29; invest_user_cnt&#xd;&#xa;,SUM&#x28;IF&#x28;rank_all&#x3d;1,1,0&#x29;&#x29; fst_invest_user_cnt&#xd;&#xa;,SUM&#x28;IF&#x28;rank_all&#x3d;1,io.invest_amt,0&#x29;&#x29; fst_invest_amt&#xd;&#xa;,SUM&#x28;IF&#x28;rank_dq&#x3d;1,1,0&#x29;&#x29; fst_invest_dq_user_cnt&#xd;&#xa;,SUM&#x28;IF&#x28;rank_dq&#x3d;1,io.invest_amt,0&#x29;&#x29; fst_invest_dq_amt&#xd;&#xa;&#xd;&#xa;FROM msc.v_fact_csyy_invest_order io &#xd;&#xa;JOIN msc.v_csyy_order_expect io2 ON io2.product_code&#x3d;io.product_code&#xd;&#xa;WHERE 1&#x3d;1 AND io.user_code&#x3c;&#x3e;999999999&#xd;&#xa;  AND io.invest_time&#x3e;&#x3d;DATE_SUB&#x28;to_date&#x28;NOW&#x28;&#x29;&#x29;,7&#x29;&#xd;&#xa; AND io.invest_time&#x3c;to_date&#x28;NOW&#x28;&#x29;&#x29;&#xd;&#xa;GROUP BY 1,2,3,4&#xd;&#xa;UNION ALL&#xd;&#xa;SELECT to_date&#x28;stat_date&#x29; v_date&#xd;&#xa;,&#x27;&#x8d22;&#x795e;&#x27; busi_line&#xd;&#xa;,io2.product&#xd;&#xa;,io2.invest_expect&#xd;&#xa;,SUM&#x28;aum&#x29; aum&#xd;&#xa;,SUM&#x28;0&#x29; lx&#xd;&#xa;,MAX&#x28;2&#x29; kind&#xd;&#xa;,COUNT&#x28;1&#x29;,COUNT&#x28;DISTINCT fads.user_code&#x29;,0,0,0,0&#xd;&#xa;FROM IDW.FACT_BIZ_CSYY_AUM fads&#xd;&#xa;JOIN msc.v_csyy_order_expect io2 ON io2.product_code&#x3d;fads.product_code&#xd;&#xa;WHERE 1&#x3d;1 AND fads.user_code&#x3c;&#x3e;999999999&#xd;&#xa;  AND stat_date&#x3e;&#x3d;DATE_SUB&#x28;to_date&#x28;NOW&#x28;&#x29;&#x29;,7&#x29;&#xd;&#xa; AND stat_date&#x3c;to_date&#x28;NOW&#x28;&#x29;&#x29;&#xd;&#xa;GROUP BY 1,2,3,4&#xd;&#xa;&#x29;a&#xd;&#xa;GROUP BY 1,2,3,4&#xd;&#xa;&#x3b;&#xd;&#xa;&#xd;&#xa;&#xd;&#xa;--  &#x65e5;&#x5165;&#x91d1; &#x5151;&#x4ed8; &#x56de;&#x6b3e;&#x8868;&#xd;&#xa;INSERT overwrite msc.fact_invest_balance_daily &#xd;&#xa;SELECT &#x2a; FROM msc.fact_invest_balance_daily WHERE v_date&#x3c;DATE_SUB&#x28;to_date&#x28;NOW&#x28;&#x29;&#x29;,3&#x29;&#xd;&#xa;UNION ALL&#xd;&#xa;SELECT d.v_date&#xd;&#xa;,nnrj.invest_cnt,nnrj.invest_amt,nnrj.invest_amt_yearly,nnrj.invest_user_cnt&#xd;&#xa;,nnrj.fst_invest_user_cnt,nnrj.fst_invest_amt,nnrj.fst_invest_dq_user_cnt,nnrj.fst_invest_dq_amt&#xd;&#xa;,csrj.invest_cnt  cs_invest_cnt&#xd;&#xa;,csrj.invest_amt  cs_invest_amt&#xd;&#xa;,csrj.invest_amt_yearly  cs_invest_amt_yearly&#xd;&#xa;,csrj.invest_user_cnt  cs_invest_user_cnt&#xd;&#xa;,csrj.fst_invest_user_cnt  cs_fst_invest_user_cnt&#xd;&#xa;,csrj.fst_invest_amt  cs_fst_invest_amt&#xd;&#xa;,csrj.fst_invest_dq_user_cnt  cs_fst_invest_dq_user_cnt&#xd;&#xa;,csrj.fst_invest_dq_amt  cs_fst_invest_dq_amt&#xd;&#xa;,nnzt.aum,nnzt.aum_user_cnt&#xd;&#xa;,cszt.aum cs_aum,cszt.aum_user_cnt cs_aum_user_cnt&#xd;&#xa;,fa.risk_balance_amount,fa.vip_balance_amount,fa.user_balance_amount&#xd;&#xa;,fa.user_balance_cnt,csfa.user_balance_amount cs_user_balance_amount&#xd;&#xa;,csfa.user_balance_cnt cs_user_balance_cnt&#xd;&#xa;,zixun_balance_amount&#xd;&#xa;,debt_price,debt_price_in,debt_order_cnt&#xd;&#xa;,NOW&#x28;&#x29; create_time&#xd;&#xa;FROM msc.v_dim_date d&#xd;&#xa;LEFT JOIN &#x28;&#xd;&#xa;SELECT to_date&#x28;io.invest_time&#x29; dd&#xd;&#xa;,COUNT&#x28;1&#x29; invest_cnt&#xd;&#xa;,SUM&#x28;io.invest_amt&#x29; invest_amt&#xd;&#xa;,SUM&#x28;io.invest_amt_yearly&#x29; invest_amt_yearly&#xd;&#xa;,COUNT&#x28;DISTINCT io.user_id&#x29; invest_user_cnt&#xd;&#xa;,SUM&#x28;IF&#x28;rank_all&#x3d;1,1,0&#x29;&#x29; fst_invest_user_cnt&#xd;&#xa;,SUM&#x28;IF&#x28;rank_all&#x3d;1,io.invest_amt,0&#x29;&#x29; fst_invest_amt&#xd;&#xa;,SUM&#x28;IF&#x28;rank_dq&#x3d;1,1,0&#x29;&#x29; fst_invest_dq_user_cnt&#xd;&#xa;,SUM&#x28;IF&#x28;rank_dq&#x3d;1,io.invest_amt,0&#x29;&#x29; fst_invest_dq_amt&#xd;&#xa;FROM msc.v_fact_nono_invest_order io &#xd;&#xa;LEFT JOIN odsopr.user_info ui ON ui.id&#x3d;io.user_id&#xd;&#xa;JOIN msc.v_nono_order_expect io2 ON io2.invest_relation_no&#x3d;io.invest_relation_no&#xd;&#xa;LEFT JOIN msc.v_nono_invest_special_user u ON u.user_id&#x3d;io.user_id&#xd;&#xa;WHERE 1&#x3d;1 AND io.status IN &#x28;1,2&#x29;&#xd;&#xa;AND u.user_id IS NULL&#xd;&#xa;AND io.invest_time&#x3e;&#x3d;DATE_SUB&#x28;to_date&#x28;NOW&#x28;&#x29;&#x29;,3&#x29;&#xd;&#xa;AND io.invest_time&#x3c;to_date&#x28;NOW&#x28;&#x29;&#x29;&#xd;&#xa;GROUP BY 1&#xd;&#xa;&#x29;nnrj ON nnrj.dd&#x3d;d.v_date&#xd;&#xa;&#xd;&#xa;LEFT JOIN&#xd;&#xa;&#x28;SELECT to_date&#x28;io.invest_time&#x29; dd&#xd;&#xa;,SUM&#x28;io.invest_amt&#x29; invest_amt&#xd;&#xa;,ROUND&#x28;SUM&#x28;IF&#x28;io.product_code&#x3d;&#x22;NN0018&#x22;,30,io2.eff_days&#x29;&#x2a;io.invest_amt&#x2f;360&#x29;,2&#x29; invest_amt_yearly&#xd;&#xa;,COUNT&#x28;1&#x29; invest_cnt&#xd;&#xa;,COUNT&#x28;DISTINCT io.user_code&#x29; invest_user_cnt&#xd;&#xa;,SUM&#x28;IF&#x28;rank_all&#x3d;1,1,0&#x29;&#x29; fst_invest_user_cnt&#xd;&#xa;,SUM&#x28;IF&#x28;rank_all&#x3d;1,io.invest_amt,0&#x29;&#x29; fst_invest_amt&#xd;&#xa;,SUM&#x28;IF&#x28;rank_dq&#x3d;1,1,0&#x29;&#x29; fst_invest_dq_user_cnt&#xd;&#xa;,SUM&#x28;IF&#x28;rank_dq&#x3d;1,io.invest_amt,0&#x29;&#x29; fst_invest_dq_amt&#xd;&#xa;FROM msc.v_fact_csyy_invest_order io &#xd;&#xa;JOIN msc.v_csyy_order_expect io2 ON io2.product_code&#x3d;io.product_code&#xd;&#xa;WHERE 1&#x3d;1 AND io.user_code&#x3c;&#x3e;999999999&#xd;&#xa;  AND io.invest_time&#x3e;&#x3d;DATE_SUB&#x28;to_date&#x28;NOW&#x28;&#x29;&#x29;,3&#x29;&#xd;&#xa; AND io.invest_time&#x3c;to_date&#x28;NOW&#x28;&#x29;&#x29;&#xd;&#xa;GROUP BY 1&#x29; csrj ON csrj.dd&#x3d;d.v_date&#xd;&#xa;&#xd;&#xa;LEFT JOIN &#xd;&#xa;&#x28;&#xd;&#xa;SELECT to_date&#x28;fnads.stat_date&#x29; dd&#xd;&#xa;,ROUND&#x28;SUM&#x28;aum&#x29;,2&#x29; aum&#xd;&#xa;,COUNT&#x28;DISTINCT fnads.user_id&#x29; aum_user_cnt&#xd;&#xa;FROM IDW.FACT_BIZ_NONO_AUM fnads&#xd;&#xa;WHERE 1&#x3d;1&#xd;&#xa;AND fnads.stat_date&#x3e;&#x3d;DATE_SUB&#x28;to_date&#x28;NOW&#x28;&#x29;&#x29;,3&#x29;&#xd;&#xa;AND fnads.stat_date&#x3c;to_date&#x28;NOW&#x28;&#x29;&#x29;&#xd;&#xa;GROUP BY 1&#xd;&#xa;&#x29;nnzt ON nnzt.dd&#x3d;d.v_date&#xd;&#xa;&#xd;&#xa;LEFT JOIN &#x28;&#xd;&#xa;SELECT to_date&#x28;stat_date&#x29; dd&#xd;&#xa;,SUM&#x28;aum&#x29; aum&#xd;&#xa;,COUNT&#x28;DISTINCT fads.user_code&#x29; aum_user_cnt&#xd;&#xa;FROM IDW.FACT_BIZ_CSYY_AUM fads&#xd;&#xa;WHERE 1&#x3d;1 AND fads.user_code&#x3c;&#x3e;999999999&#xd;&#xa;  AND stat_date&#x3e;&#x3d;DATE_SUB&#x28;to_date&#x28;NOW&#x28;&#x29;&#x29;,3&#x29;&#xd;&#xa; AND stat_date&#x3c;to_date&#x28;NOW&#x28;&#x29;&#x29;&#xd;&#xa;GROUP BY 1&#xd;&#xa;&#x29;cszt ON cszt.dd&#x3d;d.v_date&#xd;&#xa;&#xd;&#xa;LEFT JOIN &#x28;&#xd;&#xa;SELECT stat_date dd,SUM&#x28;IF&#x28;role_id IN&#x28;6,24&#x29; AND id IN&#x28;5,27&#x29;,balance,0&#x29;&#x29; risk_balance_amount&#xd;&#xa;,SUM&#x28;IF&#x28;role_id IN&#x28;13&#x29; AND user_id&#x3c;&#x3e;920272 ,balance,0&#x29;&#x29; vip_balance_amount&#xd;&#xa;,SUM&#x28;IF&#x28;role_id IN&#x28;7&#x29; AND id&#x3c;&#x3e;14567 ,balance,0&#x29;&#x29; user_balance_amount&#xd;&#xa;,SUM&#x28;IF&#x28;id IN&#x28;4,26,24&#x29;,balance,0&#x29;&#x29; zixun_balance_amount&#xd;&#xa;,SUM&#x28;IF&#x28;role_id IN&#x28;7&#x29; AND id&#x3c;&#x3e;14567 AND balance&#x3e;0 ,1,0&#x29;&#x29; user_balance_cnt&#xd;&#xa;FROM dmt.fact_finance_account_snapshot&#xd;&#xa;WHERE 1&#x3d;1 &#xd;&#xa;AND stat_date&#x3e;&#x3d;DATE_SUB&#x28;to_date&#x28;NOW&#x28;&#x29;&#x29;,3&#x29;&#xd;&#xa;AND stat_date&#x3c;to_date&#x28;NOW&#x28;&#x29;&#x29;&#xd;&#xa;GROUP BY 1&#xd;&#xa;&#x29;fa ON fa.dd&#x3d;d.v_date&#xd;&#xa;&#xd;&#xa;&#xd;&#xa;LEFT JOIN &#x28;&#xd;&#xa;SELECT stat_date dd,SUM&#x28;amount&#x29; user_balance_amount&#xd;&#xa;,SUM&#x28;IF&#x28;amount&#x3e;0,1,0&#x29;&#x29;user_balance_cnt&#xd;&#xa;FROM dmt.fact_csyy_finance_account_snapshot &#xd;&#xa;WHERE 1&#x3d;1 &#xd;&#xa;AND stat_date&#x3e;&#x3d;DATE_SUB&#x28;to_date&#x28;NOW&#x28;&#x29;&#x29;,3&#x29;&#xd;&#xa;AND stat_date&#x3c;to_date&#x28;NOW&#x28;&#x29;&#x29;&#xd;&#xa;GROUP BY 1&#xd;&#xa;&#x29;csfa ON csfa.dd&#x3d;d.v_date&#xd;&#xa;LEFT JOIN &#xd;&#xa;&#x28;SELECT to_date&#x28;pay_time&#x29; dd,SUM&#x28;price&#x29; debt_price&#xd;&#xa;,SUM&#x28;price_in&#x29; debt_price_in&#xd;&#xa;,COUNT&#x28;1&#x29; debt_order_cnt&#xd;&#xa;FROM odsopr.debt_buy_log dbl&#xd;&#xa;WHERE dbl.status&#x3d;1&#xd;&#xa;AND pay_time&#x3e;&#x3d;DATE_SUB&#x28;to_date&#x28;NOW&#x28;&#x29;&#x29;,3&#x29;&#xd;&#xa;AND pay_time&#x3c;to_date&#x28;NOW&#x28;&#x29;&#x29;&#xd;&#xa;GROUP BY 1&#x29;dbl ON dbl.dd&#x3d;d.v_date&#xd;&#xa;&#xd;&#xa;WHERE 1&#x3d;1 AND v_date&#x3e;&#x3d;DATE_SUB&#x28;to_date&#x28;NOW&#x28;&#x29;&#x29;,3&#x29;&#xd;&#xa;AND v_date&#x3c;to_date&#x28;NOW&#x28;&#x29;&#x29;&#xd;&#xa;&#x3b;&#xd;&#xa;&#xd;&#xa;-- &#x65e5;&#x5145;&#x503c;&#x8868;&#xd;&#xa;INSERT overwrite  msc.fact_daily_recharge&#xd;&#xa;SELECT &#x2a; FROM msc.fact_daily_recharge WHERE v_date&#x3c;DATE_SUB&#x28;to_date&#x28;NOW&#x28;&#x29;&#x29;,7&#x29;&#xd;&#xa;UNION ALL&#xd;&#xa;SELECT d.v_date&#xd;&#xa;,cz.recharge_order_cnt&#xd;&#xa;,cz.recharge_user_cnt&#xd;&#xa;,cz.recharge_amount&#xd;&#xa;,cz2.recharge_order_cnt lc_recharge_order_cnt&#xd;&#xa;,cz2.recharge_user_cnt lc_recharge_user_cnt&#xd;&#xa;,cz2.recharge_amount lc_recharge_amount&#xd;&#xa;,tx.withdraw_order_cnt&#xd;&#xa;,tx.withdraw_user_cnt&#xd;&#xa;,tx.withdraw_user_amt&#xd;&#xa;,tx2.withdraw_order_cnt lc_withdraw_order_cnt&#xd;&#xa;,tx2.withdraw_user_cnt lc_withdraw_user_cnt&#xd;&#xa;,tx2.withdraw_user_amt lc_withdraw_user_amt&#xd;&#xa;,cscz.recharge_order_cnt cs_recharge_order_cnt&#xd;&#xa;,cscz.recharge_user_cnt cs_recharge_user_cnt&#xd;&#xa;,cscz.recharge_amount cs_recharge_amount&#xd;&#xa;,cscz.privilege_amount cs_privilege_amount&#xd;&#xa;,cstx.withdraw_order_cnt cs_withdraw_order_cnt&#xd;&#xa;,cstx.withdraw_user_cnt cs_withdraw_user_cnt&#xd;&#xa;,cstx.withdraw_user_amt cs_withdraw_user_amt&#xd;&#xa;,cstx.less_amount cs_less_amount&#xd;&#xa;,NOW&#x28;&#x29; create_time&#xd;&#xa;FROM msc.v_dim_date d&#xd;&#xa;&#xd;&#xa;LEFT JOIN &#x28;SELECT to_date&#x28;rf.recharge_time&#x29; dd&#xd;&#xa;,COUNT&#x28;1&#x29; recharge_order_cnt&#xd;&#xa;,COUNT&#x28;DISTINCT rf.user_id&#x29; recharge_user_cnt&#xd;&#xa;,SUM&#x28;rf.recharge_amt&#x29; recharge_amount&#xd;&#xa;FROM  idw.fact_biz_nono_recharge  rf&#xd;&#xa;LEFT JOIN msc.v_nono_invest_special_user u ON u.user_id&#x3d;rf.user_id&#xd;&#xa;WHERE 1&#x3d;1 &#xd;&#xa;AND rf.recharge_time&#x3e;&#x3d;DATE_SUB&#x28;to_date&#x28;NOW&#x28;&#x29;&#x29;,7&#x29;&#xd;&#xa;AND rf.recharge_time&#x3c;to_date&#x28;NOW&#x28;&#x29;&#x29;&#xd;&#xa;GROUP BY 1 &#x29; cz ON cz.dd&#x3d;d.v_date&#xd;&#xa;&#xd;&#xa;LEFT JOIN &#x28;SELECT to_date&#x28;rf.recharge_time&#x29; dd&#xd;&#xa;,COUNT&#x28;1&#x29; recharge_order_cnt&#xd;&#xa;,COUNT&#x28;DISTINCT rf.user_id&#x29; recharge_user_cnt&#xd;&#xa;,SUM&#x28;rf.recharge_amt&#x29; recharge_amount&#xd;&#xa;FROM  idw.fact_biz_nono_recharge rf&#xd;&#xa;LEFT JOIN msc.v_nono_invest_special_user u ON u.user_id&#x3d;rf.user_id&#xd;&#xa;LEFT JOIN idw.dim_user ui ON ui.user_id&#x3d;rf.user_id&#xd;&#xa;WHERE 1&#x3d;1 &#xd;&#xa;AND u.user_id IS NULL&#xd;&#xa;AND ui.user_type IN&#x28;0,1&#x29;&#xd;&#xa;AND rf.recharge_time&#x3e;&#x3d;DATE_SUB&#x28;to_date&#x28;NOW&#x28;&#x29;&#x29;,7&#x29;&#xd;&#xa;AND rf.recharge_time&#x3c;to_date&#x28;NOW&#x28;&#x29;&#x29;&#xd;&#xa;GROUP BY 1 &#x29; cz2 ON cz2.dd&#x3d;d.v_date&#xd;&#xa;&#xd;&#xa;LEFT JOIN&#xd;&#xa;&#x28;SELECT to_date&#x28;withdraw_time&#x29; dd&#xd;&#xa;,COUNT&#x28;1&#x29; withdraw_order_cnt&#xd;&#xa;,COUNT&#x28;DISTINCT w.user_id&#x29; withdraw_user_cnt&#xd;&#xa;,ROUND&#x28;SUM&#x28;withdraw_amt&#x29;,2&#x29; withdraw_user_amt&#xd;&#xa;FROM idw.FACT_BIZ_NONO_WITHDRAW w&#xd;&#xa;LEFT JOIN msc.v_nono_invest_special_user u ON u.user_id&#x3d;w.user_id&#xd;&#xa;WHERE 1&#x3d;1 &#xd;&#xa;AND w.withdraw_time&#x3e;&#x3d;DATE_SUB&#x28;to_date&#x28;NOW&#x28;&#x29;&#x29;,7&#x29;&#xd;&#xa;AND w.withdraw_time&#x3c;to_date&#x28;NOW&#x28;&#x29;&#x29;&#xd;&#xa;and u.user_id is null&#xd;&#xa;GROUP BY 1 &#x29;tx ON tx.dd&#x3d;d.v_date&#xd;&#xa;&#xd;&#xa;&#xd;&#xa;LEFT JOIN&#xd;&#xa;&#x28;SELECT to_date&#x28;withdraw_time&#x29; dd&#xd;&#xa;,COUNT&#x28;1&#x29; withdraw_order_cnt&#xd;&#xa;,COUNT&#x28;DISTINCT w.user_id&#x29; withdraw_user_cnt&#xd;&#xa;,ROUND&#x28;SUM&#x28;withdraw_amt&#x29;,2&#x29; withdraw_user_amt&#xd;&#xa;FROM idw.FACT_BIZ_NONO_WITHDRAW w&#xd;&#xa;LEFT JOIN msc.v_nono_invest_special_user u ON u.user_id&#x3d;w.user_id&#xd;&#xa;LEFT JOIN idw.dim_user ui ON ui.user_id&#x3d;w.user_id&#xd;&#xa;WHERE 1&#x3d;1 &#xd;&#xa;AND u.user_id IS NULL&#xd;&#xa;AND ui.user_type IN&#x28;0,1&#x29;&#xd;&#xa;AND w.withdraw_time&#x3e;&#x3d;DATE_SUB&#x28;to_date&#x28;NOW&#x28;&#x29;&#x29;,7&#x29;&#xd;&#xa;AND w.withdraw_time&#x3c;to_date&#x28;NOW&#x28;&#x29;&#x29;&#xd;&#xa;GROUP BY 1 &#xd;&#xa; &#x29;tx2 ON tx2.dd&#x3d;d.v_date&#xd;&#xa; &#xd;&#xa;LEFT JOIN &#xd;&#xa;&#x28;SELECT to_date&#x28;r.recharge_time&#x29; as dd &#xd;&#xa;,COUNT&#x28;1&#x29; recharge_order_cnt&#xd;&#xa;,COUNT&#x28;DISTINCT r.user_code&#x29; recharge_user_cnt&#xd;&#xa;,SUM&#x28;r.recharge_amt&#x29; recharge_amount&#xd;&#xa;,0 as privilege_amount&#xd;&#xa;FROM idw.fact_biz_csyy_recharge r&#xd;&#xa;WHERE 1&#x3d;1&#xd;&#xa;AND r.recharge_time&#x3e;&#x3d;DATE_SUB&#x28;to_date&#x28;NOW&#x28;&#x29;&#x29;,7&#x29;&#xd;&#xa;AND r.recharge_time&#x3c;to_date&#x28;NOW&#x28;&#x29;&#x29;&#xd;&#xa;GROUP BY 1&#xd;&#xa;&#x29;cscz ON cscz.dd&#x3d;d.v_date&#xd;&#xa;&#xd;&#xa;LEFT JOIN &#xd;&#xa;&#x28;&#xd;&#xa;SELECT to_date&#x28;withdraw_time&#x29; dd&#xd;&#xa;,COUNT&#x28;1&#x29; withdraw_order_cnt&#xd;&#xa;,COUNT&#x28;DISTINCT w.user_code&#x29; withdraw_user_cnt&#xd;&#xa;,ROUND&#x28;SUM&#x28;withdraw_amt&#x29;,2&#x29; withdraw_user_amt&#xd;&#xa;,SUM&#x28;w.fee&#x29; less_amount&#xd;&#xa;FROM idw.FACT_BIZ_CSYY_WITHDRAW w&#xd;&#xa;WHERE 1&#x3d;1 &#xd;&#xa;AND w.withdraw_time&#x3e;&#x3d;DATE_SUB&#x28;to_date&#x28;NOW&#x28;&#x29;&#x29;,7&#x29;&#xd;&#xa;AND w.withdraw_time&#x3c;to_date&#x28;NOW&#x28;&#x29;&#x29;&#xd;&#xa;GROUP BY 1&#xd;&#xa;&#xd;&#xa;&#x29;cstx ON cstx.dd&#x3d;d.v_date&#xd;&#xa;&#xd;&#xa;WHERE 1&#x3d;1 AND v_date&#x3e;&#x3d;DATE_SUB&#x28;to_date&#x28;NOW&#x28;&#x29;&#x29;,7&#x29; &#xd;&#xa;AND v_date&#x3c;to_date&#x28;NOW&#x28;&#x29;&#x29;&#xd;&#xa;&#x3b;&#xd;&#xa;&#xd;&#xa;-- &#x65e5;&#x6ce8;&#x518c;&#x8868;&#xd;&#xa;INSERT overwrite  msc.fact_daily_register&#xd;&#xa;SELECT &#x2a; FROM msc.fact_daily_register WHERE v_date&#x3c;DATE_SUB&#x28;to_date&#x28;NOW&#x28;&#x29;&#x29;,7&#x29;&#xd;&#xa;UNION ALL&#xd;&#xa;SELECT v_date,busi_line,SUM&#x28;IF&#x28;kind&#x3d;1,register_cnt,0&#x29;&#x29; register_cnt&#xd;&#xa;,SUM&#x28;IF&#x28;kind&#x3d;2,register_cnt,0&#x29;&#x29; bk_cnt&#xd;&#xa;,SUM&#x28;IF&#x28;kind&#x3d;3,register_cnt,0&#x29;&#x29; login_cnt&#xd;&#xa;,SUM&#x28;IF&#x28;kind&#x3d;4,register_cnt,0&#x29;&#x29; nn_device_cnt&#xd;&#xa;,SUM&#x28;IF&#x28;kind&#x3d;5,register_cnt,0&#x29;&#x29; cs_idum_cnt&#xd;&#xa;,SUM&#x28;IF&#x28;kind&#x3d;6,register_cnt,0&#x29;&#x29; cs_bk_cnt&#xd;&#xa;,NOW&#x28;&#x29; new_create_time&#xd;&#xa;FROM&#x28;&#xd;&#xa;SELECT to_date&#x28;register_time&#x29; v_date,register_biz busi_line,MIN&#x28;1&#x29; kind,COUNT&#x28;1&#x29;  register_cnt&#xd;&#xa;FROM idw.dim_user a&#xd;&#xa;WHERE 1&#x3d;1 &#xd;&#xa;AND register_time&#x3e;&#x3d;DATE_SUB&#x28;to_date&#x28;NOW&#x28;&#x29;&#x29;,7&#x29;&#xd;&#xa;GROUP BY 1,2&#xd;&#xa;UNION ALL &#xd;&#xa;SELECT to_date&#x28;first_bind_card_time&#x29; v_date,register_biz,MIN&#x28;2&#x29; kind,COUNT&#x28;1&#x29; bk_cnt&#xd;&#xa;FROM idw.dim_user&#xd;&#xa;WHERE 1&#x3d;1&#xd;&#xa;AND first_bind_card_time&#x3e;&#x3d;DATE_SUB&#x28;to_date&#x28;NOW&#x28;&#x29;&#x29;,7&#x29;&#xd;&#xa;GROUP BY 1,2&#xd;&#xa;UNION ALL &#xd;&#xa;SELECT to_date&#x28;a.logon_time&#x29; v_date,login_biz,MIN&#x28;3&#x29; kind,COUNT&#x28;DISTINCT a.user_id&#x29; login_cnt&#xd;&#xa;FROM odsopr.user_login_detail_log_new a&#xd;&#xa;WHERE 1&#x3d;1 &#xd;&#xa;AND a.logon_time&#x3e;&#x3d;DATE_SUB&#x28;to_date&#x28;NOW&#x28;&#x29;&#x29;,7&#x29;&#xd;&#xa;GROUP BY 1,2&#xd;&#xa;UNION ALL &#xd;&#xa; SELECT a.day v_date,&#x22;nono&#x22; busi_line,MIN&#x28;4&#x29; kind,COUNT&#x28;DISTINCT CONCAT&#x28;imei,idfa&#x29;&#x29; login_cnt&#xd;&#xa; FROM  ods.log_app_text a&#xd;&#xa; WHERE 1&#x3d;1 AND platform_id IN&#x28;1,4,5&#x29;&#xd;&#xa;AND a.day&#x3e;&#x3d;DATE_SUB&#x28;to_date&#x28;NOW&#x28;&#x29;&#x29;,7&#x29; &#xd;&#xa;GROUP BY 1,2&#xd;&#xa;UNION ALL &#xd;&#xa;SELECT to_date&#x28;ud.certificate_authen_time&#x29; v_date,&#x22;csyy&#x22;busi_line,MIN&#x28;5&#x29;,COUNT&#x28;1&#x29; cnt&#xd;&#xa;FROM odsopr.user_detail ud&#xd;&#xa;WHERE 1&#x3d;1 AND  ud.certificate_authen_time IS NOT NULL&#xd;&#xa;AND ud.certificate_authen_time &#x3c;&#x3e;&#x22;&#x22;&#xd;&#xa;AND is_certificate_authen&#x3d;&#x22;1&#x22;&#xd;&#xa;AND  ud.certificate_authen_time &#x3e;&#x3d;DATE_SUB&#x28;to_date&#x28;NOW&#x28;&#x29;&#x29;,7&#x29;&#xd;&#xa;GROUP BY 1,2&#xd;&#xa;UNION ALL &#xd;&#xa;SELECT to_date&#x28;fst&#x29; v_date,&#x22;csyy&#x22;busi_line,MIN&#x28;6&#x29;,COUNT&#x28;1&#x29; cnt&#xd;&#xa;FROM&#x28;&#xd;&#xa;SELECT ud.user_code,MIN&#x28;ubc.create_date&#x29; fst&#xd;&#xa;FROM odsopr.user_bind_card ubc&#xd;&#xa;JOIN odsopr.user_detail ud ON ud.user_code&#x3d;ubc.user_code AND ud.is_bind_bankcard&#x3d;&#x22;1&#x22;&#xd;&#xa;GROUP BY 1&#xd;&#xa;&#x29;a &#xd;&#xa;WHERE 1&#x3d;1 AND fst&#x3e;&#x3d;DATE_SUB&#x28;to_date&#x28;NOW&#x28;&#x29;&#x29;,7&#x29;&#xd;&#xa;GROUP BY 1,2&#xd;&#xa;&#x29;a&#xd;&#xa;GROUP BY 1,2&#xd;&#xa;&#x3b;&#xd;&#xa;&#xd;&#xa;-- &#x65e5;&#x5151;&#x4ed8;&#x8fd8;&#x6b3e;&#x8868;&#xd;&#xa;INSERT overwrite  msc.fact_daily_cash &#xd;&#xa;SELECT &#x2a; FROM msc.fact_daily_cash WHERE v_date&#x3c;DATE_SUB&#x28;to_date&#x28;NOW&#x28;&#x29;&#x29;,7&#x29;&#xd;&#xa;UNION ALL&#xd;&#xa;SELECT d.v_date,cash.cash_order_cnt,cash.cash_user_cnt,cash.cash_user_amt&#xd;&#xa;,cscash.cash_order_cnt cs_cash_order_cnt&#xd;&#xa;,cscash.cash_user_cnt cs_cash_user_cnt&#xd;&#xa;,cscash.cash_user_amt cs_cash_user_amt&#xd;&#xa;,ba.huikuan_user_cnt,ba.huikuan_user_amt,ba.huikuan_user_lx&#xd;&#xa;,br.repay_user_cnt,br.repay_b,br.repay_l,br.repay_all&#xd;&#xa;,br2.repay_user_cnt all_repay_user_cnt&#xd;&#xa;,br2.repay_b  all_repay_b&#xd;&#xa;,br2.repay_l all_repay_l&#xd;&#xa;,br2.repay_all all_repay_all&#xd;&#xa;,NOW&#x28;&#x29; create_time&#xd;&#xa;FROM msc.v_dim_date d&#xd;&#xa;LEFT JOIN &#x28;&#xd;&#xa;SELECT to_date&#x28;actual_cash_time&#x29; dd&#xd;&#xa;,COUNT&#x28;1&#x29; cash_order_cnt&#xd;&#xa;,COUNT&#x28;DISTINCT ic.user_id&#x29; cash_user_cnt&#xd;&#xa;,ROUND&#x28;SUM&#x28;ic.price_principal&#x29;,2&#x29; cash_user_amt&#xd;&#xa;FROM idw.fact_nono_invest_cash ic &#xd;&#xa;LEFT JOIN msc.v_nono_invest_special_user u ON u.user_id&#x3d;ic.user_id&#xd;&#xa;WHERE 1&#x3d;1 &#xd;&#xa;AND u.user_id IS NULL&#xd;&#xa;AND actual_cash_time&#x3e;&#x3d;DATE_SUB&#x28;to_date&#x28;NOW&#x28;&#x29;&#x29;,7&#x29;&#xd;&#xa;and platform&#x3d;1&#xd;&#xa;AND actual_cash_time&#x3c;to_date&#x28;NOW&#x28;&#x29;&#x29;&#xd;&#xa;GROUP BY 1 &#xd;&#xa;&#x29;cash ON cash.dd&#x3d;d.v_date&#xd;&#xa;&#xd;&#xa;LEFT JOIN &#xd;&#xa;&#x28;&#xd;&#xa;&#xd;&#xa;SELECT to_date&#x28;ACTUAL_CASH_TIME&#x29; AS dd&#xd;&#xa;,COUNT&#x28;1&#x29; cash_order_cnt&#xd;&#xa;,COUNT&#x28;DISTINCT user_code&#x29; cash_user_cnt&#xd;&#xa;,ROUND&#x28;SUM&#x28;IFNULL&#x28;PRICE_PRINCIPAL,PRICE_AMT&#x29;&#x29;,2&#x29; cash_user_amt&#xd;&#xa;FROM IDW.FACT_BIZ_CSYY_INVEST_CASH&#xd;&#xa;WHERE CASH_STATUS&#x3d;1&#xd;&#xa;AND ACTUAL_CASH_TIME&#x3e;&#x3d;DATE_SUB&#x28;to_date&#x28;NOW&#x28;&#x29;&#x29;,7&#x29;&#xd;&#xa;AND ACTUAL_CASH_TIME&#x3c;to_date&#x28;NOW&#x28;&#x29;&#x29;&#xd;&#xa;and user_code&#x3c;&#x3e;999999999&#xd;&#xa;GROUP BY 1&#xd;&#xa;&#xd;&#xa;&#x29;cscash ON cscash.dd&#x3d;d.v_date&#xd;&#xa;LEFT JOIN&#xd;&#xa;&#x28;&#xd;&#xa;SELECT to_date&#x28;ba.success_time&#x29; dd&#xd;&#xa;,COUNT&#x28;DISTINCT ba.user_id&#x29; huikuan_user_cnt&#xd;&#xa;,ROUND&#x28;SUM&#x28;ba.price_principal&#x29;,2&#x29; huikuan_user_amt&#xd;&#xa;,ROUND&#x28;SUM&#x28;&#x28;ba.price_interest&#x2b;ba.price_punish&#x29;&#x2a;ba.owner_rate&#x29;,2&#x29; huikuan_user_lx&#xd;&#xa;FROM odsopr.borrows_accept ba&#xd;&#xa;LEFT JOIN msc.v_nono_invest_special_user u ON u.user_id&#x3d;ba.user_id&#xd;&#xa;WHERE 1&#x3d;1 &#xd;&#xa;AND u.user_id IS NULL&#xd;&#xa;AND ba.is_vip&#x3d;1&#xd;&#xa;AND ba.price&#x3c;&#x3e;0&#xd;&#xa;AND ba.success_time&#x3e;&#x3d;DATE_SUB&#x28;to_date&#x28;NOW&#x28;&#x29;&#x29;,7&#x29;&#xd;&#xa;AND ba.success_time&#x3c;to_date&#x28;NOW&#x28;&#x29;&#x29;&#xd;&#xa;GROUP BY 1 &#xd;&#xa;&#x29;ba ON ba.dd&#x3d;d.v_date&#xd;&#xa;&#xd;&#xa;LEFT JOIN &#xd;&#xa;&#x28;&#xd;&#xa;SELECT to_date&#x28;br.br_repay_time&#x29; dd&#xd;&#xa;,COUNT&#x28;DISTINCT br.user_id&#x29; repay_user_cnt&#xd;&#xa;,ROUND&#x28;SUM&#x28;br.br_price_b&#x29;,2&#x29; repay_b&#xd;&#xa;,ROUND&#x28;SUM&#x28;br.br_price_l&#x29;,2&#x29; repay_l&#xd;&#xa;,ROUND&#x28;SUM&#x28;br.br_price&#x2b;br.br_price_punish&#x2b;br.price_return&#x29;,2&#x29; repay_all&#xd;&#xa;FROM odsopr.borrows_repayment br&#xd;&#xa;WHERE 1&#x3d;1 &#xd;&#xa;AND br.br_repay_time&#x3e;&#x3d;DATE_SUB&#x28;to_date&#x28;NOW&#x28;&#x29;&#x29;,7&#x29;&#xd;&#xa;AND br.br_repay_time&#x3c;to_date&#x28;NOW&#x28;&#x29;&#x29;&#xd;&#xa;GROUP BY 1 &#xd;&#xa;&#x29;br ON br.dd&#x3d;d.v_date&#xd;&#xa;&#xd;&#xa;LEFT JOIN &#x28;&#xd;&#xa;SELECT to_date&#x28;IFNULL&#x28;bg.bg_time,br.br_repay_time&#x29;&#x29; dd&#xd;&#xa;,COUNT&#x28;DISTINCT br.user_id&#x29; repay_user_cnt&#xd;&#xa;,ROUND&#x28;SUM&#x28;br.br_price_b&#x29;,2&#x29; repay_b&#xd;&#xa;,ROUND&#x28;SUM&#x28;br.br_price_l&#x29;,2&#x29; repay_l&#xd;&#xa;,ROUND&#x28;SUM&#x28;br.br_price&#x2b;br.br_price_punish&#x2b;br.price_return&#x29;,2&#x29; repay_all&#xd;&#xa;FROM odsopr.borrows_repayment br&#xd;&#xa;LEFT JOIN odsopr.borrows_guarantee bg ON bg.br_id&#x3d;br.id&#xd;&#xa;WHERE 1&#x3d;1 &#xd;&#xa;AND IFNULL&#x28;bg.bg_time,br.br_repay_time&#x29;&#x3e;&#x3d;DATE_SUB&#x28;to_date&#x28;NOW&#x28;&#x29;&#x29;,7&#x29;&#xd;&#xa;AND IFNULL&#x28;bg.bg_time,br.br_repay_time&#x29;&#x3c;to_date&#x28;NOW&#x28;&#x29;&#x29;&#xd;&#xa;GROUP BY 1 &#x29;br2 ON br2.dd&#x3d;d.v_date&#xd;&#xa;WHERE 1&#x3d;1 AND v_date&#x3e;&#x3d;DATE_SUB&#x28;to_date&#x28;NOW&#x28;&#x29;&#x29;,7&#x29; &#xd;&#xa;AND v_date&#x3c;to_date&#x28;NOW&#x28;&#x29;&#x29;&#xd;&#xa;&#x3b;&#xd;&#xa;&#xd;&#xa;&#x2f;&#x2a; &#x6bcf;&#x65e5;&#x8c03;&#x5ea6; &#x7ed3;&#x679c;&#x8868;&#x2a;&#x2f;&#xd;&#xa;-- &#x540d;&#x6821;&#x8d37;&#x65e5;&#x62a5; &#x6570;&#x636e;&#xd;&#xa;INSERT overwrite  msc.coo_mxd_daily&#xd;&#xa;SELECT &#x2a; FROM msc.coo_mxd_daily WHERE v_date&#x3c;DATE_SUB&#x28;to_date&#x28;NOW&#x28;&#x29;&#x29;,7&#x29;&#xd;&#xa;UNION ALL&#xd;&#xa;SELECT a.&#x2a;,c.register_cnt,c.bld_register_cnt,c.login_cnt,stu.stu_cnt&#xd;&#xa;,d.apply_user_cnt,e.video_cnt,f.finish_price audit_finish_price &#xd;&#xa;FROM&#x28;&#xd;&#xa;SELECT v_date&#xd;&#xa;,SUM&#x28;audit_borrows_cnt&#x29; borrows_cnt&#xd;&#xa;,SUM&#x28;audit_finish_price&#x29; finish_price&#xd;&#xa;,SUM&#x28;y_audit_finish_price&#x29; y_finish_price&#xd;&#xa;,SUM&#x28;IF&#x28;product LIKE &#x27;&#x25;&#x767d;&#x9886;&#x25;&#x27; ,audit_finish_price,0&#x29;&#x29; blb_finish_price&#xd;&#xa;,SUM&#x28;audit_borrows_user&#x29; borrows_user&#xd;&#xa;,SUM&#x28;fst_audit_borrows_user_all&#x29; fst_borrows_user&#xd;&#xa;&#xd;&#xa;,SUM&#x28;unrepay_price_b&#x29; unrepay_price_b&#xd;&#xa;,SUM&#x28;overdue_unrepay_price_b&#x29; overdue_unrepay_price_b&#xd;&#xa;,SUM&#x28;unrepay_borrows_user&#x29; unrepay_borrows_user&#xd;&#xa;FROM msc.bia_fact_borrows  bo&#xd;&#xa;WHERE 1&#x3d;1 AND v_date&#x3e;&#x3d;DATE_SUB&#x28;to_date&#x28;NOW&#x28;&#x29;&#x29;,7&#x29;&#xd;&#xa;AND bo.busi_line in &#x28;&#x22;&#x767d;&#x9886;&#x8d37;&#x22;,&#x22;&#x767d;&#x9886;&#x4fe1;&#x7528;&#x8d37;&#x22;,&#x22;&#x5b66;&#x751f;&#x8d37;&#x22;&#x29;&#xd;&#xa;GROUP BY 1&#xd;&#xa;&#x29;a&#xd;&#xa;LEFT JOIN&#xd;&#xa;&#x28;SELECT a.v_date,SUM&#x28;register_cnt&#x29; register_cnt&#xd;&#xa;,SUM&#x28;IF&#x28; busi_line&#x3d;&#x27;bld&#x27;,register_cnt,0&#x29;&#x29; bld_register_cnt&#xd;&#xa;,SUM&#x28;login_cnt&#x29; login_cnt&#xd;&#xa;FROM msc.fact_daily_register a &#xd;&#xa;WHERE  busi_line IN&#x28;&#x27;mxd&#x27;,&#x27;bld&#x27;&#x29;&#xd;&#xa;AND a.v_date&#x3e;&#x3d;DATE_SUB&#x28;to_date&#x28;NOW&#x28;&#x29;&#x29;,7&#x29;&#xd;&#xa;GROUP BY 1&#x29;c ON a.v_date&#x3d;c.v_date&#xd;&#xa;LEFT JOIN &#xd;&#xa;&#x28;&#xd;&#xa;SELECT to_date&#x28;stu_auth_time&#x29; v_date,COUNT&#x28;1&#x29; stu_cnt&#xd;&#xa;FROM idw.dim_user d&#xd;&#xa;WHERE 1&#x3d;1 AND stu_auth_time&#x3e;&#x3d;DATE_SUB&#x28;to_date&#x28;NOW&#x28;&#x29;&#x29;,7&#x29;&#xd;&#xa;AND is_student_auth&#x3d;1&#xd;&#xa;AND d.register_biz IN&#x28;&#x27;mxd&#x27;,&#x27;bld&#x27;&#x29;&#xd;&#xa;GROUP BY 1&#xd;&#xa;&#x29;stu ON stu.v_date&#x3d;a.v_date&#xd;&#xa;LEFT JOIN &#x28;&#xd;&#xa;SELECT to_date&#x28;bo.publish_time&#x29; v_date,COUNT&#x28;DISTINCT bo.user_id&#x29; apply_user_cnt&#xd;&#xa;FROM idw.fact_borrows bo &#xd;&#xa;JOIN dmt_im.v_borrows_busiline_product_bibi2 vbo ON vbo.bo_id&#x3d;bo.bo_id&#xd;&#xa;WHERE 1&#x3d;1 &#xd;&#xa;AND vbo.busi_line in &#x28;&#x22;&#x767d;&#x9886;&#x8d37;&#x22;,&#x22;&#x767d;&#x9886;&#x4fe1;&#x7528;&#x8d37;&#x22;,&#x22;&#x5b66;&#x751f;&#x22;&#x29;&#xd;&#xa;AND bo.publish_time&#x3e;&#x3d;DATE_SUB&#x28;to_date&#x28;NOW&#x28;&#x29;&#x29;,7&#x29;&#xd;&#xa;GROUP BY 1&#x29; d ON d.v_date&#x3d;a.v_date&#xd;&#xa;LEFT JOIN &#x28;&#xd;&#xa;SELECT to_date&#x28;bo.video_audit_time &#x29; v_date,COUNT&#x28;1&#x29; video_cnt&#xd;&#xa;FROM idw.fact_borrows bo &#xd;&#xa;JOIN dmt_im.v_borrows_busiline_product_bibi2 vbo ON vbo.bo_id&#x3d;bo.bo_id&#xd;&#xa;WHERE 1&#x3d;1 &#xd;&#xa;AND vbo.busi_line in &#x28;&#x22;&#x767d;&#x9886;&#x8d37;&#x22;,&#x22;&#x767d;&#x9886;&#x4fe1;&#x7528;&#x8d37;&#x22;,&#x22;&#x5b66;&#x751f;&#x8d37;&#x22;&#x29;&#xd;&#xa;AND bo.video_audit_time &#x3e;&#x3d;DATE_SUB&#x28;to_date&#x28;NOW&#x28;&#x29;&#x29;,7&#x29;&#xd;&#xa;GROUP BY 1&#xd;&#xa;&#x29;e ON e.v_date&#x3d;a.v_date&#xd;&#xa;LEFT JOIN &#x28;&#xd;&#xa;SELECT to_date&#x28;bo.bo_audit_time&#x29; v_date,SUM&#x28;bo.bo_price&#x29; finish_price&#xd;&#xa;FROM idw.fact_borrows bo &#xd;&#xa;JOIN dmt_im.v_borrows_busiline_product_bibi2 vbo ON vbo.bo_id&#x3d;bo.bo_id&#xd;&#xa;WHERE 1&#x3d;1 &#xd;&#xa;AND vbo.busi_line in &#x28;&#x22;&#x767d;&#x9886;&#x8d37;&#x22;,&#x22;&#x767d;&#x9886;&#x4fe1;&#x7528;&#x8d37;&#x22;,&#x22;&#x5b66;&#x751f;&#x8d37;&#x22;&#x29;&#xd;&#xa;AND bo.bo_audit_time&#x3e;&#x3d;DATE_SUB&#x28;to_date&#x28;NOW&#x28;&#x29;&#x29;,7&#x29;&#xd;&#xa;AND &#x28;bo.bo_is_success&#x3d;1 OR bo.confirm_status&#x3d;&#x27;&#x7ec8;&#x5ba1;&#x901a;&#x8fc7;&#x27;&#x29;&#xd;&#xa;GROUP BY 1&#xd;&#xa;UNION ALL &#xd;&#xa;SELECT to_date&#x28;bo.bo_audit_time&#x29; v_date,SUM&#x28;bo.bo_finish_price&#x29; finish_price&#xd;&#xa;FROM idw.fact_borrows bo &#xd;&#xa;JOIN dmt_im.v_borrows_busiline_product_bibi2 vbo ON vbo.bo_id&#x3d;bo.bo_id&#xd;&#xa;WHERE 1&#x3d;1 &#xd;&#xa;AND vbo.busi_line in &#x28;&#x22;&#x767d;&#x9886;&#x8d37;&#x22;,&#x22;&#x767d;&#x9886;&#x4fe1;&#x7528;&#x8d37;&#x22;,&#x22;&#x5b66;&#x751f;&#x8d37;&#x22;&#x29;&#xd;&#xa;AND bo.bo_audit_time&#x3e;&#x3d;DATE_SUB&#x28;to_date&#x28;NOW&#x28;&#x29;&#x29;,7&#x29;&#xd;&#xa;AND bo.bo_audit_time&#x3c;DATE_SUB&#x28;to_date&#x28;NOW&#x28;&#x29;&#x29;,7&#x29;&#xd;&#xa;AND bo.bo_is_success&#x3d;1 &#xd;&#xa;GROUP BY 1&#xd;&#xa;&#x29;f ON f.v_date&#x3d;a.v_date&#xd;&#xa;&#x3b;&#xd;&#xa;&#xd;&#xa;-- &#x9ea6;&#x5b50;&#x65e5;&#x62a5; &#x6570;&#x636e;&#xd;&#xa;INSERT overwrite msc.coo_mz_daily&#xd;&#xa;SELECT &#x2a; FROM msc.coo_mz_daily WHERE v_date&#x3c;DATE_SUB&#x28;to_date&#x28;NOW&#x28;&#x29;&#x29;,7&#x29;&#xd;&#xa;UNION ALL&#xd;&#xa;SELECT a.v_date&#xd;&#xa;,IFNULL&#x28;invest_amt,0&#x29; invest_amt&#xd;&#xa;,IFNULL&#x28;cs_invest_amt,0&#x29; cs_invest_amt&#xd;&#xa;,IFNULL&#x28;b.cash_user_amt,0&#x29; cash_user_amt&#xd;&#xa;,IFNULL&#x28;b.cs_cash_user_amt,0&#x29; cs_cash_user_amt&#xd;&#xa;,IFNULL&#x28;huikuan_user_amt,0&#x29;  huikuan_user_amt&#xd;&#xa;,IFNULL&#x28;c.recharge_amount,0&#x29;&#x2b;IFNULL&#x28;c.cs_recharge_amount,0&#x29; recharge_amt&#xd;&#xa;,IFNULL&#x28;c.withdraw_user_amt,0&#x29;&#x2b;IFNULL&#x28;c.cs_withdraw_user_amt,0&#x29; withdraw_amt&#xd;&#xa;,IFNULL&#x28;c.recharge_amount,0&#x29;&#x2b;IFNULL&#x28;c.cs_recharge_amount,0&#x29;&#xd;&#xa;-IFNULL&#x28;c.withdraw_user_amt,0&#x29;-IFNULL&#x28;c.cs_withdraw_user_amt,0&#x29; cztx_amt&#xd;&#xa;,IFNULL&#x28;invest_amt,0&#x29;-IFNULL&#x28;cash_user_amt,0&#x29; nn_jr&#xd;&#xa;,IFNULL&#x28;cs_invest_amt,0&#x29;-IFNULL&#x28;cs_cash_user_amt,0&#x29; cs_jr&#xd;&#xa;,IFNULL&#x28;invest_amt,0&#x29;-IFNULL&#x28;cash_user_amt,0&#x29;&#x2b;IFNULL&#x28;huikuan_user_amt,0&#x29; nn_ky&#xd;&#xa;,IFNULL&#x28;invest_amt,0&#x29;-IFNULL&#x28;cash_user_amt,0&#x29;&#x2b;IFNULL&#x28;cs_invest_amt,0&#x29;-IFNULL&#x28;cs_cash_user_amt,0&#x29; &#xd;&#xa;total_jr&#xd;&#xa;,mxd_finish_price&#xd;&#xa;,dfd_finish_price&#xd;&#xa;,unifi_finish_price&#xd;&#xa;,maiya_finish_price&#xd;&#xa;,mld_finish_price&#xd;&#xa;,kld_finish_price&#xd;&#xa;,other_finish_price&#xd;&#xa;,total_finish_price&#xd;&#xa;,b.all_repay_b debt_end&#xd;&#xa;,IFNULL&#x28;total_finish_price,0&#x29;-IFNULL&#x28;b.all_repay_b,0&#x29; debt_new&#xd;&#xa;,bo.unrepay_price_b &#xd;&#xa;,IFNULL&#x28;a.aum,0&#x29;&#x2b;IFNULL&#x28;a.cs_aum,0&#x29; aum&#xd;&#xa;,IFNULL&#x28;a.vip_balance_amount,0&#x29; vip_balance_amount&#xd;&#xa;,IFNULL&#x28;invest_amt,0&#x29;-IFNULL&#x28;cash_user_amt,0&#x29;&#x2b;IFNULL&#x28;cs_invest_amt,0&#x29;-IFNULL&#x28;cs_cash_user_amt,0&#x29; &#xd;&#xa;-IFNULL&#x28;total_finish_price,0&#x29;&#x2b;IFNULL&#x28;b.all_repay_b,0&#x29; diff_amt&#xd;&#xa;FROM msc.fact_invest_balance_daily a&#xd;&#xa;LEFT JOIN msc.fact_daily_cash b ON a.v_date&#x3d;b.v_date&#xd;&#xa;LEFT JOIN msc.fact_daily_recharge c ON a.v_date&#x3d;c.v_date&#xd;&#xa;LEFT JOIN &#x28;SELECT v_date&#xd;&#xa;,ROUND&#x28;SUM&#x28;audit_finish_price&#x29;,2&#x29; total_finish_price&#xd;&#xa;,ROUND&#x28;SUM&#x28;IF&#x28;bo.busi_line&#x3d;&#x22;&#x767d;&#x9886;&#x4fe1;&#x7528;&#x8d37;&#x22;,audit_finish_price,0&#x29;&#x29;,2&#x29;  mxd_finish_price&#xd;&#xa;,ROUND&#x28;SUM&#x28;IF&#x28;bo.busi_line&#x3d;&#x22;&#x767d;&#x9886;&#x8d37;&#x22;,audit_finish_price,0&#x29;&#x29;,2&#x29;  dfd_finish_price&#xd;&#xa;,ROUND&#x28;SUM&#x28;IF&#x28;bo.busi_line&#x3d;&#x22;&#x9ea6;&#x5b50;&#x501f;&#x6b3e;&#x22;,audit_finish_price,0&#x29;&#x29;,2&#x29;  unifi_finish_price&#xd;&#xa;,ROUND&#x28;SUM&#x28;IF&#x28;bo.busi_line&#x3d;&#x22;&#x9ea6;&#x82bd;&#x5206;&#x671f;&#x22;,audit_finish_price,0&#x29;&#x29;,2&#x29;  maiya_finish_price&#xd;&#xa;,ROUND&#x28;SUM&#x28;IF&#x28;bo.busi_line&#x3d;&#x22;&#x5927;&#x529b;&#x8d37;&#x22;,audit_finish_price,0&#x29;&#x29;,2&#x29;  mld_finish_price&#xd;&#xa;,ROUND&#x28;SUM&#x28;IF&#x28;bo.busi_line&#x3d;&#x22;&#x5927;&#x8f66;&#x8d37;&#x22;,audit_finish_price,0&#x29;&#x29;,2&#x29;  kld_finish_price&#xd;&#xa;,ROUND&#x28;SUM&#x28;IF&#x28;bo.busi_line NOT IN&#x28;&#x22;&#x767d;&#x9886;&#x4fe1;&#x7528;&#x8d37;&#x22;,&#x22;&#x767d;&#x9886;&#x8d37;&#x22;,&#x22;&#x9ea6;&#x5b50;&#x501f;&#x6b3e;&#x22;,&#x22;&#x9ea6;&#x82bd;&#x5206;&#x671f;&#x22;,&#x22;&#x5927;&#x8f66;&#x8d37;&#x22;,&#x22;&#x5927;&#x529b;&#x8d37;&#x22;&#x29;&#xd;&#xa;,audit_finish_price,0&#x29;&#x29;,2&#x29;  other_finish_price&#xd;&#xa;,ROUND&#x28;SUM&#x28;unrepay_price_b&#x29;,2&#x29; unrepay_price_b&#xd;&#xa;FROM msc.bia_fact_borrows  bo&#xd;&#xa;WHERE 1&#x3d;1 AND v_date&#x3e;&#x3d;DATE_SUB&#x28;to_date&#x28;NOW&#x28;&#x29;&#x29;,7&#x29;&#xd;&#xa;GROUP BY 1 &#x29;bo  ON bo.v_date&#x3d;a.v_date&#xd;&#xa;WHERE a.v_date&#x3e;&#x3d;DATE_SUB&#x28;to_date&#x28;NOW&#x28;&#x29;&#x29;,7&#x29;&#xd;&#xa;ORDER BY 1 &#xd;&#xa;&#x3b;&#xd;&#xa;&#xd;&#xa;&#xd;&#xa;-- &#x8bfa;&#x8bfa;&#x65e5;&#x62a5;&#x6570;&#x636e;&#xd;&#xa;INSERT overwrite msc.coo_nono_daily&#xd;&#xa;SELECT &#x2a; FROM msc.coo_nono_daily WHERE v_date&#x3c;DATE_SUB&#x28;to_date&#x28;NOW&#x28;&#x29;&#x29;,7&#x29;&#xd;&#xa;UNION ALL&#xd;&#xa;SELECT  a.v_date,a.invest_amt,a.cash_user_amt,a.huikuan_user_amt&#xd;&#xa;,a.nn_jr,a.nn_ky&#xd;&#xa;,c.register_cnt,c.bk_cnt&#xd;&#xa;,b.fst_invest_user_cnt&#xd;&#xa;,ROUND&#x28;b.fst_invest_user_cnt&#x2f;b.invest_user_cnt,4&#x29; fst_invest_user_rate&#xd;&#xa;,ROUND&#x28;b.fst_invest_amt&#x2f;b.invest_amt,4&#x29; fst_invest_amt_rate&#xd;&#xa;,c.nn_device_cnt&#xd;&#xa;,b.invest_user_cnt&#xd;&#xa;,c.login_cnt&#xd;&#xa;,b.aum_user_cnt&#xd;&#xa;,b.aum&#xd;&#xa;,NOW&#x28;&#x29; new_create_time&#xd;&#xa;FROM msc.coo_mz_daily a&#xd;&#xa;LEFT JOIN msc.fact_invest_balance_daily b ON a.v_date&#x3d;b.v_date&#xd;&#xa;LEFT JOIN&#xd;&#xa;&#x28;SELECT a.v_date,SUM&#x28;register_cnt&#x29; register_cnt,SUM&#x28;bk_cnt&#x29; bk_cnt,SUM&#x28;login_cnt&#x29; login_cnt&#xd;&#xa;,SUM&#x28;nn_device_cnt&#x29; nn_device_cnt&#xd;&#xa;FROM msc.fact_daily_register a &#xd;&#xa;WHERE  busi_line IN&#x28;&#x22;nono&#x22;&#x29;&#xd;&#xa;AND a.v_date&#x3e;&#x3d;DATE_SUB&#x28;to_date&#x28;NOW&#x28;&#x29;&#x29;,7&#x29;&#xd;&#xa;GROUP BY 1&#x29;c ON a.v_date&#x3d;c.v_date&#xd;&#xa;WHERE 1&#x3d;1 AND a.v_date&#x3e;&#x3d;DATE_SUB&#x28;to_date&#x28;NOW&#x28;&#x29;&#x29;,7&#x29;&#xd;&#xa;&#xd;&#xa;&#x3b;&#xd;&#xa;&#xd;&#xa;-- &#x8d22;&#x795e;&#x65e5;&#x62a5;&#x6570;&#x636e;&#xd;&#xa;INSERT overwrite  msc.coo_csyy_daily&#xd;&#xa;SELECT &#x2a; FROM msc.coo_csyy_daily WHERE v_date&#x3c;DATE_SUB&#x28;to_date&#x28;NOW&#x28;&#x29;&#x29;,7&#x29;&#xd;&#xa;UNION ALL&#xd;&#xa;SELECT  a.v_date&#xd;&#xa;,IFNULL&#x28;a.cs_invest_amt,0&#x29;&#x2b;IFNULL&#x28;a.cs_cash_user_amt,0&#x29; trade_amt&#xd;&#xa;,a.cs_invest_amt&#xd;&#xa;,a.cs_cash_user_amt&#xd;&#xa;,a.cs_jr&#xd;&#xa;,c.register_cnt&#xd;&#xa;,c.idnum_cnt&#xd;&#xa;,c.bk_cnt&#xd;&#xa;,b.cs_fst_invest_user_cnt&#xd;&#xa;,ROUND&#x28;b.cs_fst_invest_user_cnt&#x2f;b.cs_invest_user_cnt,4&#x29; fst_invest_user_rate&#xd;&#xa;,ROUND&#x28;b.cs_fst_invest_amt&#x2f;b.cs_invest_amt,4&#x29; fst_invest_amt_rate&#xd;&#xa;,b.cs_invest_user_cnt&#xd;&#xa;,c.login_cnt&#xd;&#xa;,b.cs_aum_user_cnt&#xd;&#xa;,b.cs_aum&#xd;&#xa;,NOW&#x28;&#x29; new_create_time&#xd;&#xa;FROM msc.coo_mz_daily a&#xd;&#xa;LEFT JOIN msc.fact_invest_balance_daily b ON a.v_date&#x3d;b.v_date&#xd;&#xa;LEFT JOIN&#xd;&#xa;&#x28;SELECT a.v_date,SUM&#x28;register_cnt&#x29; register_cnt&#xd;&#xa;,SUM&#x28;cs_bk_cnt&#x29; bk_cnt&#xd;&#xa;,SUM&#x28;login_cnt&#x29; login_cnt&#xd;&#xa;,SUM&#x28;cs_idum_cnt&#x29; idnum_cnt&#xd;&#xa;FROM msc.fact_daily_register a &#xd;&#xa;WHERE  busi_line IN&#x28;&#x22;csyy&#x22;&#x29;&#xd;&#xa;AND a.v_date&#x3e;&#x3d;DATE_SUB&#x28;to_date&#x28;NOW&#x28;&#x29;&#x29;,7&#x29;&#xd;&#xa;GROUP BY 1&#x29;c ON a.v_date&#x3d;c.v_date&#xd;&#xa;WHERE 1&#x3d;1 AND a.v_date&#x3e;&#x3d;DATE_SUB&#x28;to_date&#x28;NOW&#x28;&#x29;&#x29;,7&#x29;&#xd;&#xa;&#x3b;&#xd;&#xa;&#xd;&#xa;&#xd;&#xa;&#xd;&#xa;-- &#x65e5;&#x62a5;&#x4ee3;&#x7801;&#x6267;&#x884c;&#x6210;&#x529f;&#x540e; &#x63d2;&#x5165;&#x6570;&#x636e;&#xff0c;&#x524d;&#x7aef;&#x68c0;&#x6d4b;&#x6210;&#x529f;&#x540e;&#x53d1;&#x9001;&#xff1b;&#xd;&#xa;&#xd;&#xa;&#xd;&#xa;INSERT INTO dmt_im.monitor_project_result &#xd;&#xa;SELECT &#x22;coo_daily&#x22; project,to_date&#x28;NOW&#x28;&#x29;&#x29; v_date&#xa;-- , IF&#x28;a.a&#x2b;b.a&#x2b;c.a&#x3d;3,1,0&#x29; STATUS&#xa;,1 STATUS&#xa;,NOW&#x28;&#x29; create_time&#xd;&#xa;FROM&#x28;SELECT COUNT&#x28;1&#x29; a&#xd;&#xa;FROM msc.v_coo_mz_daily &#xd;&#xa;WHERE v_date&#x3e;&#x3d;DATE_SUB&#x28;to_date&#x28;NOW&#x28;&#x29;&#x29;,1&#x29;&#xd;&#xa;AND CAST&#x28;invest_amt AS INT&#x29;&#x2a;CAST&#x28; cs_invest_amt AS INT&#x29;&#x2a;CAST&#x28; cash_user_amt AS INT&#x29;&#x2a;CAST&#x28; cs_cash_user_amt AS INT&#x29;&#x2a;CAST&#x28; huikuan_user_amt AS INT&#x29;&#x2a;CAST&#x28; recharge_amt AS INT&#x29;&#x2a;CAST&#x28; withdraw_amt AS INT&#x29;&#x2a;CAST&#x28; nn_ky&#xd;&#xa; AS INT&#x29;&#x2a;CAST&#x28; total_finish_price AS INT&#x29;&#x2a;CAST&#x28; debt_end AS INT&#x29;&#x2a;CAST&#x28; unrepay_price_b AS INT&#x29;&#x2a;CAST&#x28; aum AS INT&#x29; &#x3c;&#x3e;0&#xd;&#xa; &#x29;a,&#x28;&#xd;&#xa;SELECT COUNT&#x28;1&#x29; a&#xd;&#xa;FROM msc.v_coo_csyy_daily&#xd;&#xa;WHERE v_date&#x3e;&#x3d;DATE_SUB&#x28;to_date&#x28;NOW&#x28;&#x29;&#x29;,1&#x29;&#xd;&#xa;AND &#xd;&#xa;CAST&#x28;trade_amt AS INT&#x29;&#x2a;CAST&#x28; cs_invest_amt AS INT&#x29;&#x2a;CAST&#x28; cs_cash_user_amt AS INT&#x29;&#x2a;CAST&#x28; register_cnt AS INT&#x29;&#x2a;CAST&#x28; cs_aum AS INT&#x29; &#x3c;&#x3e;0&#xd;&#xa;&#x29;b,&#x28;&#xd;&#xa;SELECT COUNT&#x28;1&#x29; a&#xd;&#xa;FROM msc.v_coo_nono_daily&#xd;&#xa;WHERE v_date&#x3e;&#x3d;DATE_SUB&#x28;to_date&#x28;NOW&#x28;&#x29;&#x29;,1&#x29;&#xd;&#xa;AND &#xd;&#xa;CAST&#x28;huikuan_user_amt AS INT&#x29;&#x2a;CAST&#x28; invest_amt AS INT&#x29;&#x2a;CAST&#x28; cash_user_amt AS INT&#x29;&#x2a;CAST&#x28; register_cnt AS INT&#x29;&#x2a;CAST&#x28; aum AS INT&#x29; &#x3c;&#x3e;0&#xd;&#xa;&#x29;c&#xd;&#xa; &#xd;&#xa;&#x3b;</sql>
    <set_params>N</set_params>
    <insert_field/>
    <update_field/>
    <delete_field/>
    <read_field/>
    <arguments>
    </arguments>
     <cluster_schema/>
 <remotesteps>   <input>   </input>   <output>   </output> </remotesteps>    <GUI>
      <xloc>339</xloc>
      <yloc>275</yloc>
      <draw>Y</draw>
      </GUI>
    </step>

  <step_error_handling>
  </step_error_handling>
   <slave-step-copy-partition-distribution>
</slave-step-copy-partition-distribution>
   <slave_transformation>N</slave_transformation>

</transformation>
